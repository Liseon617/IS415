{
  "hash": "42b5b4ac7cdea09a01119d298b44bab4",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Take-home Exercise 1: Geospatial Analytics for Social Good: Application of Spatial and Spatio-temporal Point Patterns Analysis to discover the geographical distribution of Armed Conflict in Myanmar\"\nauthor: \"Brian Lim\"\ndate: \"September 8, 2024\"\ndate-modified: \"last-modified\"\ncategories:\n  - Analysis\n  - R\n  - sf\n  - tidyverse\n  - raster\n  - spatstat\n  - tmap\n  - tidyverse\nformat: html\neditor: visual\nexecute: \n  eval: true\n  echo: true\n  warning: false\n  freeze: true\n  cache: true\n---\n\n\n## **1.1 Exercise Overview**\n\nMillions of people have their lives shattered by armed conflict – wars – every year.\n\nArmed conflict has been on the rise since about 2012, after a decline in the 1990s and early 2000s. First came conflicts in Libya, Syria and Yemen, triggered by the 2011 Arab uprisings. Libya’s instability spilled south, helping set off a protracted crisis in the Sahel region. A fresh wave of major combat followed: the 2020 Azerbaijani-Armenian war over the Nagorno-Karabakh enclave, horrific fighting in Ethiopia’s northern Tigray region that began weeks later, the conflict prompted by the Myanmar army’s 2021 power grab and Russia’s 2022 assault on Ukraine. Add to those 2023’s devastation in Sudan and Gaza. Around the globe, more people are dying in fighting, being forced from their homes or in need of life-saving aid than in decades.\n\nIn this study, I will apply spatial point patterns analysis methods to discover the spatial and spatio-temporal distribution of armed conflict in Myanmar.\n\n## **1.2 Data Acquisition**\n\nThe data sets that we will be using are the following: - Armed conflict data of Myanmar between 2021-2024. This data can be downloaded from Armed Conflict Location & Event Data [ACLED](https://acleddata.com/analysis/), an independent, impartial, international non-profit organization collecting data on violent conflict and protest in all countries and territories in the world, should be used. - The shapefile of the Myanmar State and Region Boundaries with Sub-regions. This data can be downloaded from [Myanmar Information Management Unit, MIMU](https://geonode.themimu.info/layers/geonode%3Ammr_polbnda2_adm1_250k_mimu_1).\n\n## **1.3 Getting Started**\n\nFor this exercise, the following R packages will be used:\n\n-   [**sf**](https://cran.r-project.org/web/packages/sf/) for handling geospatial data.\n\n-   [**spatstat**](https://spatstat.org/), a comprehensive package for point pattern analysis. We'll use it to perform first- and second-order spatial point pattern analyses and to derive kernel density estimation (KDE) layers.\n\n-   [**raster**](https://cran.r-project.org/web/packages/raster/), a package for reading, writing, manipulating, and modeling gridded spatial data (rasters). We will use it to convert image outputs generated by spatstat into raster format.\n\n-   [**tmap**](https://cran.r-project.org/web/packages/tmap/index.html), a package for creating high-quality static and interactive maps, leveraging the Leaflet API for interactive visualizations.\n\n-   [**tidyverse**](https://www.tidyverse.org/) for performing data science tasks such as importing, wrangling and visualising data.\n\n-   [**RColorBrewer**](https://cran.r-project.org/web/packages/RColorBrewer/RColorBrewer.pdf) for creating nice looking color palettes especially for thematic maps.\n\nAs readr, tidyr and dplyr are part of tidyverse package. The code chunk below will suffice to install and load the required packages in RStudio.\n\nTo install and load these packages into the R environment, we use the `p_load` function from the `pacman` package:\n\n\n::: {.cell}\n\n```{.r .cell-code}\npacman::p_load(sf, raster, spatstat, tmap, tidyverse, RColorBrewer, lubridate, ggplot2, parallel, sparr, magick)\n```\n:::\n\n\n## **1.4 Importing Data into R**\n\nNext, we will import the `ACLED-Southeast_Asia-Myanmar(1).csv` file into the R environment and save it into an R dataframe called `acled_sf`. The task can be performed using the `read_csv()` function from the readr package, as shown below:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nacled_sf <- read_csv(\"data/ACLED-Southeast_Asia-Myanmar(1).csv\") %>% \n  st_as_sf(coords = c(\n    \"longitude\", \"latitude\"), crs = 4326) %>% \n  st_transform(crs= 32647)%>%\n  mutate(event_date = dmy(event_date)) %>%\n  mutate(quarter = paste0(year, \" Q\", quarter(event_date)))\n```\n:::\n\n\n::: {.callout-tip title=\"Notes\"}\nWe used the `mutate()` function to ensure that the **event_data** column is in the right format of `dmy()`, while also creating a **quarter** column to represent the current <year and quarter> that the row belongs to\n:::\n\nWe can check the validity of the imported dataset, ensuring that it is in the right format with the `st_crs()` and `summary()` function:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nst_crs(acled_sf)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nCoordinate Reference System:\n  User input: EPSG:32647 \n  wkt:\nPROJCRS[\"WGS 84 / UTM zone 47N\",\n    BASEGEOGCRS[\"WGS 84\",\n        ENSEMBLE[\"World Geodetic System 1984 ensemble\",\n            MEMBER[\"World Geodetic System 1984 (Transit)\"],\n            MEMBER[\"World Geodetic System 1984 (G730)\"],\n            MEMBER[\"World Geodetic System 1984 (G873)\"],\n            MEMBER[\"World Geodetic System 1984 (G1150)\"],\n            MEMBER[\"World Geodetic System 1984 (G1674)\"],\n            MEMBER[\"World Geodetic System 1984 (G1762)\"],\n            MEMBER[\"World Geodetic System 1984 (G2139)\"],\n            ELLIPSOID[\"WGS 84\",6378137,298.257223563,\n                LENGTHUNIT[\"metre\",1]],\n            ENSEMBLEACCURACY[2.0]],\n        PRIMEM[\"Greenwich\",0,\n            ANGLEUNIT[\"degree\",0.0174532925199433]],\n        ID[\"EPSG\",4326]],\n    CONVERSION[\"UTM zone 47N\",\n        METHOD[\"Transverse Mercator\",\n            ID[\"EPSG\",9807]],\n        PARAMETER[\"Latitude of natural origin\",0,\n            ANGLEUNIT[\"degree\",0.0174532925199433],\n            ID[\"EPSG\",8801]],\n        PARAMETER[\"Longitude of natural origin\",99,\n            ANGLEUNIT[\"degree\",0.0174532925199433],\n            ID[\"EPSG\",8802]],\n        PARAMETER[\"Scale factor at natural origin\",0.9996,\n            SCALEUNIT[\"unity\",1],\n            ID[\"EPSG\",8805]],\n        PARAMETER[\"False easting\",500000,\n            LENGTHUNIT[\"metre\",1],\n            ID[\"EPSG\",8806]],\n        PARAMETER[\"False northing\",0,\n            LENGTHUNIT[\"metre\",1],\n            ID[\"EPSG\",8807]]],\n    CS[Cartesian,2],\n        AXIS[\"(E)\",east,\n            ORDER[1],\n            LENGTHUNIT[\"metre\",1]],\n        AXIS[\"(N)\",north,\n            ORDER[2],\n            LENGTHUNIT[\"metre\",1]],\n    USAGE[\n        SCOPE[\"Navigation and medium accuracy spatial referencing.\"],\n        AREA[\"Between 96°E and 102°E, northern hemisphere between equator and 84°N, onshore and offshore. China. Indonesia. Laos. Malaysia - West Malaysia. Mongolia. Myanmar (Burma). Russian Federation. Thailand.\"],\n        BBOX[0,96,84,102]],\n    ID[\"EPSG\",32647]]\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(acled_sf)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n event_id_cnty        event_date              year      time_precision \n Length:42608       Min.   :2021-01-01   Min.   :2021   Min.   :1.000  \n Class :character   1st Qu.:2022-01-10   1st Qu.:2022   1st Qu.:1.000  \n Mode  :character   Median :2022-10-13   Median :2022   Median :1.000  \n                    Mean   :2022-10-29   Mean   :2022   Mean   :1.053  \n                    3rd Qu.:2023-08-29   3rd Qu.:2023   3rd Qu.:1.000  \n                    Max.   :2024-06-30   Max.   :2024   Max.   :3.000  \n disorder_type       event_type        sub_event_type        actor1         \n Length:42608       Length:42608       Length:42608       Length:42608      \n Class :character   Class :character   Class :character   Class :character  \n Mode  :character   Mode  :character   Mode  :character   Mode  :character  \n                                                                            \n                                                                            \n                                                                            \n assoc_actor_1          inter1         actor2          assoc_actor_2     \n Length:42608       Min.   :1.000   Length:42608       Length:42608      \n Class :character   1st Qu.:1.000   Class :character   Class :character  \n Mode  :character   Median :1.000   Mode  :character   Mode  :character  \n                    Mean   :1.947                                        \n                    3rd Qu.:3.000                                        \n                    Max.   :8.000                                        \n     inter2       interaction    civilian_targeting      iso     \n Min.   :0.000   Min.   :10.00   Length:42608       Min.   :104  \n 1st Qu.:1.000   1st Qu.:13.00   Class :character   1st Qu.:104  \n Median :3.000   Median :17.00   Mode  :character   Median :104  \n Mean   :3.597   Mean   :18.86                      Mean   :104  \n 3rd Qu.:7.000   3rd Qu.:17.00                      3rd Qu.:104  \n Max.   :8.000   Max.   :80.00                      Max.   :104  \n    region            country             admin1             admin2         \n Length:42608       Length:42608       Length:42608       Length:42608      \n Class :character   Class :character   Class :character   Class :character  \n Mode  :character   Mode  :character   Mode  :character   Mode  :character  \n                                                                            \n                                                                            \n                                                                            \n    admin3            location         geo_precision      source         \n Length:42608       Length:42608       Min.   :1.000   Length:42608      \n Class :character   Class :character   1st Qu.:1.000   Class :character  \n Mode  :character   Mode  :character   Median :1.000   Mode  :character  \n                                       Mean   :1.495                     \n                                       3rd Qu.:2.000                     \n                                       Max.   :3.000                     \n source_scale          notes             fatalities         tags          \n Length:42608       Length:42608       Min.   :  0.00   Length:42608      \n Class :character   Class :character   1st Qu.:  0.00   Class :character  \n Mode  :character   Mode  :character   Median :  0.00   Mode  :character  \n                                       Mean   :  1.27                     \n                                       3rd Qu.:  1.00                     \n                                       Max.   :201.00                     \n   timestamp                  geometry       quarter         \n Min.   :1.611e+09   POINT        :42608   Length:42608      \n 1st Qu.:1.702e+09   epsg:32647   :    0   Class :character  \n Median :1.714e+09   +proj=utm ...:    0   Mode  :character  \n Mean   :1.702e+09                                           \n 3rd Qu.:1.719e+09                                           \n Max.   :1.726e+09                                           \n```\n\n\n:::\n:::\n\n\nWe then import the boundaries and regions of Myanmar using the `st_read()` function to import the *mmr_polbnda2_adm1_250k_mimu_1* shapefile into R as a simple feature data frame named `regions_sf`:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nregions_sf <- st_read(dsn = \"data/myanmar\", \n                layer = \"mmr_polbnda2_adm1_250k_mimu_1\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nReading layer `mmr_polbnda2_adm1_250k_mimu_1' from data source \n  `C:\\Users\\blzll\\OneDrive\\Desktop\\Y3S1\\IS415\\Quarto\\IS415\\Take-home_ex\\data\\myanmar' \n  using driver `ESRI Shapefile'\nSimple feature collection with 18 features and 6 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 92.1721 ymin: 9.696844 xmax: 101.17 ymax: 28.54554\nGeodetic CRS:  WGS 84\n```\n\n\n:::\n\n```{.r .cell-code}\nregions_sf <- st_transform(regions_sf, crs = 32647)\n```\n:::\n\n\n::: {.callout-tip title=\"Notes\"}\nThe `acled_sf` and `regions_sf data` are being transformed to **EPSG 32647**, which corresponds to **UTM Zone 47N**. This CSR is fine for Myanmar. This consistency also ensures that the UTM zone transformation makes sense for the study area, and prevents any distortion in KDE results.\n:::\n\nAfter importing the boundary and region data, we can check that what was imported is correct by checking the summary and plotting the views:\n\n::: panel-tabset\n## Summary\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(regions_sf)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n    OBJECTID          ST              ST_PCODE            ST_RG          \n Min.   : 1.00   Length:18          Length:18          Length:18         \n 1st Qu.: 5.25   Class :character   Class :character   Class :character  \n Median : 9.50   Mode  :character   Mode  :character   Mode  :character  \n Mean   : 9.50                                                           \n 3rd Qu.:13.75                                                           \n Max.   :18.00                                                           \n    ST_MMR             PCode_V             geometry \n Length:18          Min.   :9.4   MULTIPOLYGON :18  \n Class :character   1st Qu.:9.4   epsg:32647   : 0  \n Mode  :character   Median :9.4   +proj=utm ...: 0  \n                    Mean   :9.4                     \n                    3rd Qu.:9.4                     \n                    Max.   :9.4                     \n```\n\n\n:::\n:::\n\n\n## Detailed Regional View\n\n\n::: {.cell}\n\n```{.r .cell-code}\nnum_colors <- length(unique(regions_sf$ST))\ncolors <- brewer.pal(n = num_colors, name = \"Set1\")\n\ntm_shape(regions_sf) +\n  tm_polygons(col = \"ST\", palette = colors) +\n  tm_text(\"ST\", size = 0.9, col = \"black\", bg.color = \"white\", \n          just = c(\"center\", \"center\"), xmod = 0, ymod = 0) +\n  tm_layout(main.title = \"Region and Boundaries in Myanmar\",\n            main.title.position = \"center\",\n            main.title.size = 1.6,\n            legend.outside = TRUE,\n            frame = TRUE) +\n  tm_legend(title = \"Sub-regions\")\n```\n\n::: {.cell-output-display}\n![](Take-home_ex01_files/figure-html/unnamed-chunk-7-1.png){width=1152}\n:::\n:::\n\n:::\n\n### **1.4.1 Focused Event Types**\n\nFor the study, we focus on the following four event types from the ACLED dataset for Myanmar:\n\n-   **Battles**\n\n-   **Strategic developments**\n\n-   **Violence against civilians**\n\n-   **Explosion/Remote violence**\n\nThe study period spans from **January 2021 to June 2024**, broken down into **quarterly** intervals. We aim to visualize and analyze the spatial distribution of these armed conflict events in Myanmar.\n\nThe following function is used to generate spatial point pattern plots for each event type within the defined region throughout the stated time span:\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Function to create combined events object with owin object\nplot_event_by_quarter <- function(event_data, event_name) {\n  quarter_data_ppp <- as.ppp(st_coordinates(event_data), st_bbox(event_data))\n  regions_owin <- as.owin(regions_sf)\n  quarter_data_regions_ppp = quarter_data_ppp[regions_owin]\n  \n  plot(quarter_data_regions_ppp,\n     main = paste(\"Events in Myanmar -\", event_name, \"(2021 - 2024)\"),\n     xlab = \"Longitude\", ylab = \"Latitude\")\n}\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Get a list of unique quarters\nevents <- unique(acled_sf$event_type)\n\n# Loop over each quarter and generate the plot\nmap(events, ~ {\n  event_data <- acled_sf %>% filter(event_type == .x)\n  plot_event_by_quarter(event_data, .x)\n})\n```\n\n::: {.cell-output-display}\n![](Take-home_ex01_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](Take-home_ex01_files/figure-html/unnamed-chunk-9-2.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](Take-home_ex01_files/figure-html/unnamed-chunk-9-3.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](Take-home_ex01_files/figure-html/unnamed-chunk-9-4.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[[1]]\nSymbol map with constant values\ncols: #00000033\n\n[[2]]\nSymbol map with constant values\ncols: #00000033\n\n[[3]]\nSymbol map with constant values\ncols: #00000033\n\n[[4]]\nSymbol map with constant values\ncols: #00000033\n```\n\n\n:::\n:::\n\n\n## **1.5 Determining KDE Layer**\n\n### **1.5.1 Choosing Sample Dataset**\n\nIn this section, we focus on determining the appropriate Kernel Density Estimate (KDE) layer format for analyzing the spatial distribution of events across different quarters and event types. KDE is a fundamental tool for identifying patterns of spatial clustering and dispersion, providing a smooth surface that highlights areas of high and low event concentration. The selection of an appropriate bandwidth is crucial, as it influences the level of detail and accuracy in the density estimate. By standardizing the KDE layer format, we aim to ensure consistency and comparability throughout the analysis, particularly using the **Violence against civilians** event type as a reference for refining our approach.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nExample <- \"Violence against civilians\"\nacled_2021 <- acled_sf %>%\n  filter(event_type == Example & year == 2021)\nyear_data <- as_Spatial(acled_2021)\nregions <- as_Spatial(regions_sf)\n\nyear_data_sp <- as(year_data, \"SpatialPoints\")\nregions_sp <- as(regions, \"SpatialPolygons\")\n\nyear_data_ppp <- as.ppp(st_coordinates(acled_2021), st_bbox(acled_2021))\nyear_data_ppp\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nPlanar point pattern: 1877 points\nwindow: rectangle = [-191409.1, 591875.9] x [1132472.1, 3042960.3] units\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nany(duplicated(year_data_ppp))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] TRUE\n```\n\n\n:::\n:::\n\n\nAs there are duplicate points, we will use jittering to slightly displace the points so that overlapping points are separated on the map. The `jitter` parameter will slightly move each point by a small, random amount. This can help to visually separate points that are in the same space.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nyear_data_ppp_jit <- rjitter(year_data_ppp, \n                             retry=TRUE, \n                             nsim=1, \n                             drop=TRUE)\nany(duplicated(year_data_ppp_jit))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] FALSE\n```\n\n\n:::\n:::\n\n\n### **1.5.2 Creating Owin Object**\n\nTo confine analysis to a geographical area, convert the `SpatialPolygon` object to an `owin` object of `spatstat`:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nregions_owin <- as.owin(regions_sf)\n\nyear_data_regions_ppp = year_data_ppp_jit[regions_owin]\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(year_data_regions_ppp)\n```\n\n::: {.cell-output-display}\n![](Take-home_ex01_files/figure-html/unnamed-chunk-14-1.png){width=672}\n:::\n:::\n\n\nDue to the size of Myanmar, rescaling would need to be done:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nyear_data_regions_ppp.km <- rescale.ppp(year_data_regions_ppp, 50000, \"km\")\n```\n:::\n\n\n### **1.5.3 Working With Different Automatic Bandwidth Methods**\n\nThe `density()` function from the `spatstat` package computes the kernel density estimate for a given set of spatial point events, providing insights into the spatial distribution of those events.\n\n-   **`bw.diggle()`**: This method selects the bandwidth (σ) by minimizing the mean-square error, as defined by Diggle (1985). The mean-square error measures the average squared difference between the estimated and actual values, aiming to reduce errors in the density estimate.\n\n-   **`bw.CvL()`**: Cronie and van Lieshout’s method selects the bandwidth by minimizing the discrepancy between the area of the observation window and the sum of reciprocal estimated intensity values at the event points. It balances the observed points and the space they occupy, capturing the underlying point process effectively.\n\n-   **`bw.scott()`**: Scott’s rule, a fast and computationally efficient method, calculates the bandwidth proportional to $(n^{-\\frac{1}{d+4}})$, where (n) is the number of points and (d) the spatial dimensions. It typically produces a larger bandwidth and is ideal for detecting gradual trends.\n\n-   **`bw.ppl()`**: This method selects the bandwidth through likelihood cross-validation, maximizing the point process likelihood to provide the best-fitting model for the observed data, particularly when the goal is to optimize the likelihood of the given event distribution.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbw_CvL <- bw.CvL(year_data_regions_ppp.km)\nbw_CvL\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  sigma \n1.06566 \n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nbw_scott <- bw.scott(year_data_regions_ppp.km)\nbw_scott\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  sigma.x   sigma.y \n0.6975202 1.8339348 \n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nbw_ppl <- bw.ppl(year_data_regions_ppp.km)\nbw_ppl\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n    sigma \n0.1144767 \n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nbw_diggle <- bw.diggle(year_data_regions_ppp.km)\nbw_diggle\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n     sigma \n0.02286341 \n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nkde_diggle <- density(year_data_regions_ppp.km, bw_diggle)\nkde_CvL <- density(year_data_regions_ppp.km, bw_CvL)\nkde_scott <- density(year_data_regions_ppp.km, bw_scott)\nkde_ppl <- density(year_data_regions_ppp.km, bw_ppl)\n\npar(mar = c(2, 2, 2, 2),mfrow = c(2,2))\nplot(kde_diggle, main = \"kde_diggle\")\nplot(kde_CvL, main = \"kde_CvL\")\nplot(kde_scott, main = \"kde_scott\")\nplot(kde_ppl, main = \"kde_ppl\")\n```\n\n::: {.cell-output-display}\n![](Take-home_ex01_files/figure-html/unnamed-chunk-20-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\npar(mar = c(2,2,2,2),mfrow = c(2,2))\nhist(kde_diggle, main = \"kde_diggle\")\nhist(kde_CvL, main = \"kde_CvL\")\nhist(kde_scott, main = \"kde_scott\")\nhist(kde_ppl, main = \"kde_ppl\")\n```\n\n::: {.cell-output-display}\n![](Take-home_ex01_files/figure-html/unnamed-chunk-21-1.png){width=672}\n:::\n:::\n\n\n::: {.callout-tip title=\"Reflection\"}\nBandwidth Selection Comparison for KDE:\n\n-   **kde_diggle**: The sharp peak at the beginning indicates that the Diggle method for bandwidth selection has identified a concentrated cluster of points in the initial bin. The remaining bins show little to no concentration, suggesting a significant level of spatial clustering in one specific area within the observation window. This method may highlight a localized, high-intensity clustering effect.\n\n-   **kde_CvL**: The left-skewed, more balanced distribution suggests that the CvL method is identifying a broader range of spatial concentrations. However, the smaller bin sizes smooth out finer details, which could mask important aspects of the point pattern. This method provides a more generalized view of the distribution but at the cost of losing granular insights.\n\n-   **kde_scott**: The wider range of values and the absence of a sharp peak, compared to kde_diggle, indicates that the Scott method is capturing both highly dense clusters and moderately concentrated areas. This makes it more suitable for capturing variations in spatial concentration across different regions.\n\n-   **kde_ppl**: Similar to the Diggle method, kde_ppl shows a sharp peak, suggesting the presence of a high concentration of points in a specific region. This points to a localized cluster, but with a similar potential risk of missing broader patterns in the dataset.\n:::\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndse_diggle <- density(year_data_regions_ppp.km, bw_diggle, se=TRUE)$SE\ndse_CvL <- density(year_data_regions_ppp.km, bw_CvL, se=TRUE)$SE\ndse_scott <- density(year_data_regions_ppp.km, bw_scott, se=TRUE)$SE\ndse_ppl <- density(year_data_regions_ppp.km, bw_ppl, se=TRUE)$SE\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\npar(mar = c(2,2,2,2),mfrow = c(2,2))\nplot(dse_diggle,main = \"standard error_diggle\")\nplot(dse_CvL,main = \"standard error_CvL\")\nplot(dse_scott,main = \"standard error_scott\")\nplot(dse_ppl,main = \"standard error_ppl\")\n```\n\n::: {.cell-output-display}\n![](Take-home_ex01_files/figure-html/unnamed-chunk-23-1.png){width=672}\n:::\n:::\n\n\n::: {.callout-tip title=\"Reflection\"}\nConsideration of Standard Error:\n\nWhile the standard error (SE) of the density estimate provides valuable insight into the uncertainty associated with each density estimate, it is not the primary focus of this analysis. The shape of the density estimate, rather than its absolute value, is more critical when analyzing spatial patterns. Consequently, the SE was not used as a key criterion for bandwidth selection in this analysis.\n\nConsideration of Standard Error: While the standard error (SE) of the density estimate provides valuable insight into the uncertainty associated with each density estimate, it is not the primary focus of this analysis. The shape of the density estimate, rather than its absolute value, is more critical when analyzing spatial patterns. Consequently, the SE was not used as a key criterion for bandwidth selection in this analysis.\n:::\n\n### **1.5.4 Final Bandwidth Selection**\n\nUpon the exploration of various fixed bandwidth selection methods for computing KDE vales, and subsequent plotting of the respective KDE estimates, their distributions and associated standard errors, we will now select the KDE bandwidth to be used in our analysis.\n\nWe landed on the `bw_scott` method for further analysis. This is because:\n\n1.  `bw_scott` method provides a pair of bandwidth values for each coordinate axis. This allows it to capture the different levels of spatial clustering in each direction more accurately.\n2.  `bw_scott` method capture the balance between bias and variance the best among all methods. If the bandwidth is too small, the estimate may be too skewed (high variance). The distribution histograms of KDE layers using `bw_diggle` and `bw_ppl` tend to indicate such nature. On the other hand, if the bandwidth is too large, the estimate may be over smoothed, missing crucial elements of the point pattern (high bias). This is what we observed in the distribution histogram of KDE layer using `bw_CvL`.\n\nSince we have chosen to use `bw_scott` method, now we will plot the KDE layer using this method for further analysis.\n\n#### **1.5.4.1 Working With Different Kernel Methods**\n\nBeyond the Gaussian kernel, three other kernels can be used to compute KDE: - Epanechnikov - Quartic - Disc\n\n\n::: {.cell}\n\n```{.r .cell-code}\npar(mfrow=c(2,2), mar=c(1, 1, 1, 1), cex=0.5)\nplot(density(year_data_regions_ppp.km, \n             sigma=bw_scott, \n             edge=TRUE, \n             kernel=\"gaussian\"), \n     main=\"Gaussian\")\nplot(density(year_data_regions_ppp.km, \n             sigma=bw_scott, \n             edge=TRUE, \n             kernel=\"epanechnikov\"), \n     main=\"Epanechnikov\")\nplot(density(year_data_regions_ppp.km, \n             sigma=bw_scott, \n             edge=TRUE, \n             kernel=\"quartic\"), \n     main=\"Quartic\")\nplot(density(year_data_regions_ppp.km, \n             sigma=bw_scott, \n             edge=TRUE, \n             kernel=\"disc\"), \n     main=\"Disc\")\n```\n\n::: {.cell-output-display}\n![](Take-home_ex01_files/figure-html/unnamed-chunk-24-1.png){width=672}\n:::\n:::\n\n\n::: {.callout-tip title=\"Reflection\"}\nUpon comparing the outputs of different kernel functions **(Gaussian, Epanechnikov, Quartic, Disc)**, we observed that the resulting density estimates were very similar across all kernels. Given the minimal variation, the choice of kernel is not critical for this particular analysis.\n\nWe opted for the **Gaussian** kernel as it is widely used in kernel density estimation and tends to produce smooth, continuous estimates. Its flexibility in capturing both sharp peaks and gradual trends makes it a reasonable default choice, especially when the differences between kernels are negligible, as seen here.\n:::\n\n\n::: {.cell}\n\n```{.r .cell-code}\nkde_fixed_scott <- density(year_data_regions_ppp.km, bw_scott)\nplot(kde_fixed_scott,main = \"Fixed bandwidth KDE (Using bw_scott)\")\ncontour(kde_fixed_scott, add=TRUE)\n```\n\n::: {.cell-output-display}\n![](Take-home_ex01_files/figure-html/unnamed-chunk-25-1.png){width=1152}\n:::\n:::\n\n\nHowever, upon visual inspection, there are signs of a certain degree of over-smoothing when directly applying the bandwidth provided by the `bw_scott` method. While automatic bandwidth selection methods offer a useful starting point, further fine-tuning is often necessary to ensure the accuracy of the KDE plot.\n\nTo address the over-smoothing, we will apply a \"rule of thumb\" adjustment by dividing the bandwidth value by 2. This reduction in bandwidth size will help minimize the over-smoothing effect and enhance the precision of the spatial point pattern analysis.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nkde_year_data_regions_fixed_scott <- density(year_data_regions_ppp.km, bw_scott/2)\nkde_year_data_regions_adaptive <- adaptive.density(year_data_regions_ppp.km, method=\"kernel\")\n\npar(mfrow=c(1,2))\nplot(kde_year_data_regions_fixed_scott, main = \"Fixed Bandwidth (bw_scott)\")\nplot(kde_year_data_regions_adaptive, main = \"Adaptive Bandwidth\")\n```\n\n::: {.cell-output-display}\n![](Take-home_ex01_files/figure-html/unnamed-chunk-26-1.png){width=1152}\n:::\n:::\n\n\n::: {.callout-tip title=\"Reflection\"}\nAfter comparing the two approaches for kernel density estimation, Fixed Bandwidth using `bw_scott/2` and `Adaptive Bandwidth`, we observed that the fixed bandwidth method provides a more stable and interpretable result across the observation window. While adaptive bandwidth is designed to adjust to local point densities and capture finer details, it can sometimes introduce unnecessary complexity and overfit the density estimate, especially in areas with sparse data.\n\nGiven the goals of our analysis, which emphasize consistency and smoothness over high local sensitivity, the Fixed Bandwidth approach strikes a better balance between capturing spatial trends and avoiding over-complication.\n:::\n\n### **Year 2021**\n\n#### **Quarter 1**\n\n::: panel-tabset\n## Explosions/Remote violence\n\n\n::: {.cell}\n\n```{.r .cell-code}\nExample <- \"Explosions/Remote violence\"\nmy_2021_Q1 <- acled_sf  %>%\n  filter(event_type == Example & quarter == \"2021 Q1\")\nquarter_data <- as_Spatial(my_2021_Q1)\nquarter_data_sp <- as(quarter_data, \"SpatialPoints\")\nquarter_data_ppp <- as.ppp(st_coordinates(my_2021_Q1), st_bbox(my_2021_Q1))\n\nquarter_data_ppp_jit <- rjitter(quarter_data_ppp, \n                             retry=TRUE, \n                             nsim=1, \n                             drop=TRUE)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmy_2021_Q1_ER_quarter_data_regions_ppp = quarter_data_ppp_jit[regions_owin]\nquarter_data_regions_ppp.km <- rescale.ppp(my_2021_Q1_ER_quarter_data_regions_ppp, 50000, \"km\")\n\nbw_scott <- bw.scott(quarter_data_regions_ppp.km)\n\nplot(density(quarter_data_regions_ppp.km, \n             sigma=bw_scott/2, \n             edge=TRUE, \n             kernel=\"gaussian\"), \n     main = \"2021 Q1 - Explosion/Remote violence\")\n```\n\n::: {.cell-output-display}\n![](Take-home_ex01_files/figure-html/unnamed-chunk-28-1.png){width=1152}\n:::\n:::\n\n\n## Strategic developments\n\n\n::: {.cell}\n\n```{.r .cell-code}\nExample <- \"Strategic developments\"\nmy_2021_Q1 <- acled_sf  %>%\n  filter(event_type == Example & quarter == \"2021 Q1\")\nquarter_data <- as_Spatial(my_2021_Q1)\nquarter_data_sp <- as(quarter_data, \"SpatialPoints\")\nquarter_data_ppp <- as.ppp(st_coordinates(my_2021_Q1), st_bbox(my_2021_Q1))\n\nquarter_data_ppp_jit <- rjitter(quarter_data_ppp, \n                             retry=TRUE, \n                             nsim=1, \n                             drop=TRUE)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmy_2021_Q1_SD_quarter_data_regions_ppp = quarter_data_ppp_jit[regions_owin]\nquarter_data_regions_ppp.km <- rescale.ppp(my_2021_Q1_SD_quarter_data_regions_ppp , 50000, \"km\")\n\nbw_scott <- bw.scott(quarter_data_regions_ppp.km)\n\nplot(density(quarter_data_regions_ppp.km, \n             sigma=bw_scott/2, \n             edge=TRUE, \n             kernel=\"gaussian\"), \n     main = \"2021 Q1 - Strategic developments\")\n```\n\n::: {.cell-output-display}\n![](Take-home_ex01_files/figure-html/unnamed-chunk-30-1.png){width=1152}\n:::\n:::\n\n\n## Battles\n\n\n::: {.cell}\n\n```{.r .cell-code}\nExample <- \"Battles\"\nmy_2021_Q1 <- acled_sf  %>%\n  filter(event_type == Example & quarter == \"2021 Q1\")\nquarter_data <- as_Spatial(my_2021_Q1)\nquarter_data_sp <- as(quarter_data, \"SpatialPoints\")\nquarter_data_ppp <- as.ppp(st_coordinates(my_2021_Q1), st_bbox(my_2021_Q1))\n\nquarter_data_ppp_jit <- rjitter(quarter_data_ppp, \n                             retry=TRUE, \n                             nsim=1, \n                             drop=TRUE)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmy_2021_Q1_B_quarter_data_regions_ppp = quarter_data_ppp_jit[regions_owin]\nquarter_data_regions_ppp.km <- rescale.ppp(my_2021_Q1_B_quarter_data_regions_ppp, 50000, \"km\")\n\nbw_scott <- bw.scott(quarter_data_regions_ppp.km)\n\nplot(density(quarter_data_regions_ppp.km, \n             sigma=bw_scott/2, \n             edge=TRUE, \n             kernel=\"gaussian\"), \n     main = \"2021 Q1 - Battles\")\n```\n\n::: {.cell-output-display}\n![](Take-home_ex01_files/figure-html/unnamed-chunk-32-1.png){width=1152}\n:::\n:::\n\n\n## Violence against civilians\n\n\n::: {.cell}\n\n```{.r .cell-code}\nExample <- \"Violence against civilians\"\nmy_2021_Q1 <- acled_sf  %>%\n  filter(event_type == Example & quarter == \"2021 Q1\")\nquarter_data <- as_Spatial(my_2021_Q1)\nquarter_data_sp <- as(quarter_data, \"SpatialPoints\")\nquarter_data_ppp <- as.ppp(st_coordinates(my_2021_Q1), st_bbox(my_2021_Q1))\n\nquarter_data_ppp_jit <- rjitter(quarter_data_ppp, \n                             retry=TRUE, \n                             nsim=1, \n                             drop=TRUE)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmy_2021_Q1_VAC_quarter_data_regions_ppp = quarter_data_ppp_jit[regions_owin]\nquarter_data_regions_ppp.km <- rescale.ppp(my_2021_Q1_VAC_quarter_data_regions_ppp, 50000, \"km\")\n\nbw_scott <- bw.scott(quarter_data_regions_ppp.km)\n\nplot(density(quarter_data_regions_ppp.km, \n             sigma=bw_scott/2, \n             edge=TRUE, \n             kernel=\"gaussian\"), \n     main = \"2021 Q1 -Violence against civilians\")\n```\n\n::: {.cell-output-display}\n![](Take-home_ex01_files/figure-html/unnamed-chunk-34-1.png){width=1152}\n:::\n:::\n\n:::\n\n#### **Quarter 2**\n\n::: panel-tabset\n## Explosions/Remote violence\n\n\n::: {.cell}\n\n```{.r .cell-code}\nExample <- \"Explosions/Remote violence\"\nmy_2021_Q2 <- acled_sf  %>%\n  filter(event_type == Example & quarter == \"2021 Q2\")\nquarter_data <- as_Spatial(my_2021_Q2)\nquarter_data_sp <- as(quarter_data, \"SpatialPoints\")\nquarter_data_ppp <- as.ppp(st_coordinates(my_2021_Q2), st_bbox(my_2021_Q2))\n\nquarter_data_ppp_jit <- rjitter(quarter_data_ppp, \n                             retry=TRUE, \n                             nsim=1, \n                             drop=TRUE)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmy_2021_Q2_ER_quarter_data_regions_ppp = quarter_data_ppp_jit[regions_owin]\nquarter_data_regions_ppp.km <- rescale.ppp(my_2021_Q2_ER_quarter_data_regions_ppp, 50000, \"km\")\n\nbw_scott <- bw.scott(quarter_data_regions_ppp.km)\n\nplot(density(quarter_data_regions_ppp.km, \n             sigma=bw_scott/2, \n             edge=TRUE, \n             kernel=\"gaussian\"), \n     main = \"2021 Q2 - Explosion/Remote violence\")\n```\n\n::: {.cell-output-display}\n![](Take-home_ex01_files/figure-html/unnamed-chunk-36-1.png){width=1152}\n:::\n:::\n\n\n## Strategic developments\n\n\n::: {.cell}\n\n```{.r .cell-code}\nExample <- \"Strategic developments\"\nmy_2021_Q2 <- acled_sf  %>%\n  filter(event_type == Example & quarter == \"2021 Q2\")\nquarter_data <- as_Spatial(my_2021_Q2)\nquarter_data_sp <- as(quarter_data, \"SpatialPoints\")\nquarter_data_ppp <- as.ppp(st_coordinates(my_2021_Q2), st_bbox(my_2021_Q2))\n\nquarter_data_ppp_jit <- rjitter(quarter_data_ppp, \n                             retry=TRUE, \n                             nsim=1, \n                             drop=TRUE)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmy_2021_Q2_SD_quarter_data_regions_ppp = quarter_data_ppp_jit[regions_owin]\nquarter_data_regions_ppp.km <- rescale.ppp(my_2021_Q2_SD_quarter_data_regions_ppp, 50000, \"km\")\n\nbw_scott <- bw.scott(quarter_data_regions_ppp.km)\n\nplot(density(quarter_data_regions_ppp.km, \n             sigma=bw_scott/2, \n             edge=TRUE, \n             kernel=\"gaussian\"), \n     main = \"2021 Q2 - Strategic developments\")\n```\n\n::: {.cell-output-display}\n![](Take-home_ex01_files/figure-html/unnamed-chunk-38-1.png){width=1152}\n:::\n:::\n\n\n## Battles\n\n\n::: {.cell}\n\n```{.r .cell-code}\nExample <- \"Battles\"\nmy_2021_Q2 <- acled_sf  %>%\n  filter(event_type == Example & quarter == \"2021 Q2\")\nquarter_data <- as_Spatial(my_2021_Q2)\nquarter_data_sp <- as(quarter_data, \"SpatialPoints\")\nquarter_data_ppp <- as.ppp(st_coordinates(my_2021_Q2), st_bbox(my_2021_Q2))\n\nquarter_data_ppp_jit <- rjitter(quarter_data_ppp, \n                             retry=TRUE, \n                             nsim=1, \n                             drop=TRUE)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmy_2021_Q2_B_quarter_data_regions_ppp = quarter_data_ppp_jit[regions_owin]\nquarter_data_regions_ppp.km <- rescale.ppp(my_2021_Q2_B_quarter_data_regions_ppp, 50000, \"km\")\n\nbw_scott <- bw.scott(quarter_data_regions_ppp.km)\n\nplot(density(quarter_data_regions_ppp.km, \n             sigma=bw_scott/2, \n             edge=TRUE, \n             kernel=\"gaussian\"), \n     main = \"2021 Q2 - Battles\")\n```\n\n::: {.cell-output-display}\n![](Take-home_ex01_files/figure-html/unnamed-chunk-40-1.png){width=1152}\n:::\n:::\n\n\n## Violence against civilians\n\n\n::: {.cell}\n\n```{.r .cell-code}\nExample <- \"Violence against civilians\"\nmy_2021_Q2 <- acled_sf  %>%\n  filter(event_type == Example & quarter == \"2021 Q2\")\nquarter_data <- as_Spatial(my_2021_Q2)\nquarter_data_sp <- as(quarter_data, \"SpatialPoints\")\nquarter_data_ppp <- as.ppp(st_coordinates(my_2021_Q2), st_bbox(my_2021_Q2))\n\nquarter_data_ppp_jit <- rjitter(quarter_data_ppp, \n                             retry=TRUE, \n                             nsim=1, \n                             drop=TRUE)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmy_2021_Q2_VAC_quarter_data_regions_ppp = quarter_data_ppp_jit[regions_owin]\nquarter_data_regions_ppp.km <- rescale.ppp(my_2021_Q2_VAC_quarter_data_regions_ppp, 50000, \"km\")\n\nbw_scott <- bw.scott(quarter_data_regions_ppp.km)\n\nplot(density(quarter_data_regions_ppp.km, \n             sigma=bw_scott/2, \n             edge=TRUE, \n             kernel=\"gaussian\"), \n     main = \"2021 Q2 - Violence against civilians\")\n```\n\n::: {.cell-output-display}\n![](Take-home_ex01_files/figure-html/unnamed-chunk-42-1.png){width=1152}\n:::\n:::\n\n:::\n\n#### **Quarter 3**\n\n::: panel-tabset\n## Explosions/Remote violence\n\n\n::: {.cell}\n\n```{.r .cell-code}\nExample <- \"Explosions/Remote violence\"\nmy_2021_Q3 <- acled_sf  %>%\n  filter(event_type == Example & quarter == \"2021 Q3\")\nquarter_data <- as_Spatial(my_2021_Q3)\nquarter_data_sp <- as(quarter_data, \"SpatialPoints\")\nquarter_data_ppp <- as.ppp(st_coordinates(my_2021_Q3), st_bbox(my_2021_Q3))\n\nquarter_data_ppp_jit <- rjitter(quarter_data_ppp, \n                             retry=TRUE, \n                             nsim=1, \n                             drop=TRUE)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmy_2021_Q3_ER_quarter_data_regions_ppp = quarter_data_ppp_jit[regions_owin]\nquarter_data_regions_ppp.km <- rescale.ppp(my_2021_Q3_ER_quarter_data_regions_ppp, 50000, \"km\")\n\nbw_scott <- bw.scott(quarter_data_regions_ppp.km)\n\nplot(density(quarter_data_regions_ppp.km, \n             sigma=bw_scott/2, \n             edge=TRUE, \n             kernel=\"gaussian\"), \n     main = \"2021 Q3 - Explosion/Remote violence\")\n```\n\n::: {.cell-output-display}\n![](Take-home_ex01_files/figure-html/unnamed-chunk-44-1.png){width=1152}\n:::\n:::\n\n\n## Strategic developments\n\n\n::: {.cell}\n\n```{.r .cell-code}\nExample <- \"Strategic developments\"\nmy_2021_Q3 <- acled_sf  %>%\n  filter(event_type == Example & quarter == \"2021 Q3\")\nquarter_data <- as_Spatial(my_2021_Q3)\nquarter_data_sp <- as(quarter_data, \"SpatialPoints\")\nquarter_data_ppp <- as.ppp(st_coordinates(my_2021_Q3), st_bbox(my_2021_Q3))\n\nquarter_data_ppp_jit <- rjitter(quarter_data_ppp, \n                             retry=TRUE, \n                             nsim=1, \n                             drop=TRUE)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmy_2021_Q3_SD_quarter_data_regions_ppp = quarter_data_ppp_jit[regions_owin]\nquarter_data_regions_ppp.km <- rescale.ppp(my_2021_Q3_SD_quarter_data_regions_ppp, 50000, \"km\")\n\nbw_scott <- bw.scott(quarter_data_regions_ppp.km)\n\nplot(density(quarter_data_regions_ppp.km, \n             sigma=bw_scott/2, \n             edge=TRUE, \n             kernel=\"gaussian\"), \n     main = \"2021 Q3 - Strategic developments\")\n```\n\n::: {.cell-output-display}\n![](Take-home_ex01_files/figure-html/unnamed-chunk-46-1.png){width=1152}\n:::\n:::\n\n\n## Battles\n\n\n::: {.cell}\n\n```{.r .cell-code}\nExample <- \"Battles\"\nmy_2021_Q3 <- acled_sf  %>%\n  filter(event_type == Example & quarter == \"2021 Q3\")\nquarter_data <- as_Spatial(my_2021_Q3)\nquarter_data_sp <- as(quarter_data, \"SpatialPoints\")\nquarter_data_ppp <- as.ppp(st_coordinates(my_2021_Q3), st_bbox(my_2021_Q3))\n\nquarter_data_ppp_jit <- rjitter(quarter_data_ppp, \n                             retry=TRUE, \n                             nsim=1, \n                             drop=TRUE)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmy_2021_Q3_B_quarter_data_regions_ppp = quarter_data_ppp_jit[regions_owin]\nquarter_data_regions_ppp.km <- rescale.ppp(my_2021_Q3_B_quarter_data_regions_ppp, 50000, \"km\")\n\nbw_scott <- bw.scott(quarter_data_regions_ppp.km)\n\nplot(density(quarter_data_regions_ppp.km, \n             sigma=bw_scott/2, \n             edge=TRUE, \n             kernel=\"gaussian\"), \n     main = \"2021 Q3 - Battles\")\n```\n\n::: {.cell-output-display}\n![](Take-home_ex01_files/figure-html/unnamed-chunk-48-1.png){width=1152}\n:::\n:::\n\n\n## Violence against civilians\n\n\n::: {.cell}\n\n```{.r .cell-code}\nExample <- \"Violence against civilians\"\nmy_2021_Q3 <- acled_sf  %>%\n  filter(event_type == Example & quarter == \"2021 Q3\")\nquarter_data <- as_Spatial(my_2021_Q3)\nquarter_data_sp <- as(quarter_data, \"SpatialPoints\")\nquarter_data_ppp <- as.ppp(st_coordinates(my_2021_Q3), st_bbox(my_2021_Q3))\n\nquarter_data_ppp_jit <- rjitter(quarter_data_ppp, \n                             retry=TRUE, \n                             nsim=1, \n                             drop=TRUE)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmy_2021_Q3_VAC_quarter_data_regions_ppp = quarter_data_ppp_jit[regions_owin]\nquarter_data_regions_ppp.km <- rescale.ppp(my_2021_Q3_VAC_quarter_data_regions_ppp, 50000, \"km\")\n\nbw_scott <- bw.scott(quarter_data_regions_ppp.km)\n\nplot(density(quarter_data_regions_ppp.km, \n             sigma=bw_scott/2, \n             edge=TRUE, \n             kernel=\"gaussian\"), \n     main = \"2021 Q3 - Violence against civilians\")\n```\n\n::: {.cell-output-display}\n![](Take-home_ex01_files/figure-html/unnamed-chunk-50-1.png){width=1152}\n:::\n:::\n\n:::\n\n#### **Quarter 4**\n\n::: panel-tabset\n## Explosions/Remote violence\n\n\n::: {.cell}\n\n```{.r .cell-code}\nExample <- \"Explosions/Remote violence\"\nmy_2021_Q4 <- acled_sf  %>%\n  filter(event_type == Example & quarter == \"2021 Q4\")\nquarter_data <- as_Spatial(my_2021_Q4)\nquarter_data_sp <- as(quarter_data, \"SpatialPoints\")\nquarter_data_ppp <- as.ppp(st_coordinates(my_2021_Q4), st_bbox(my_2021_Q4))\n\nquarter_data_ppp_jit <- rjitter(quarter_data_ppp, \n                             retry=TRUE, \n                             nsim=1, \n                             drop=TRUE)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmy_2021_Q4_ER_quarter_data_regions_ppp = quarter_data_ppp_jit[regions_owin]\nquarter_data_regions_ppp.km <- rescale.ppp(my_2021_Q4_ER_quarter_data_regions_ppp, 50000, \"km\")\n\nbw_scott <- bw.scott(quarter_data_regions_ppp.km)\n\nplot(density(quarter_data_regions_ppp.km, \n             sigma=bw_scott/2, \n             edge=TRUE, \n             kernel=\"gaussian\"), \n     main = \"2021 Q4 - Explosion/Remote violence\")\n```\n\n::: {.cell-output-display}\n![](Take-home_ex01_files/figure-html/unnamed-chunk-52-1.png){width=1152}\n:::\n:::\n\n\n## Strategic developments\n\n\n::: {.cell}\n\n```{.r .cell-code}\nExample <- \"Strategic developments\"\nmy_2021_Q4 <- acled_sf  %>%\n  filter(event_type == Example & quarter == \"2021 Q4\")\nquarter_data <- as_Spatial(my_2021_Q4)\nquarter_data_sp <- as(quarter_data, \"SpatialPoints\")\nquarter_data_ppp <- as.ppp(st_coordinates(my_2021_Q4), st_bbox(my_2021_Q4))\n\nquarter_data_ppp_jit <- rjitter(quarter_data_ppp, \n                             retry=TRUE, \n                             nsim=1, \n                             drop=TRUE)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmy_2021_Q4_SD_quarter_data_regions_ppp = quarter_data_ppp_jit[regions_owin]\nquarter_data_regions_ppp.km <- rescale.ppp(my_2021_Q4_SD_quarter_data_regions_ppp, 50000, \"km\")\n\nbw_scott <- bw.scott(quarter_data_regions_ppp.km)\n\nplot(density(quarter_data_regions_ppp.km, \n             sigma=bw_scott/2, \n             edge=TRUE, \n             kernel=\"gaussian\"), \n     main = \"2021 Q4 - Strategic developments\")\n```\n\n::: {.cell-output-display}\n![](Take-home_ex01_files/figure-html/unnamed-chunk-54-1.png){width=1152}\n:::\n:::\n\n\n## Battles\n\n\n::: {.cell}\n\n```{.r .cell-code}\nExample <- \"Battles\"\nmy_2021_Q4 <- acled_sf  %>%\n  filter(event_type == Example & quarter == \"2021 Q4\")\nquarter_data <- as_Spatial(my_2021_Q4)\nquarter_data_sp <- as(quarter_data, \"SpatialPoints\")\nquarter_data_ppp <- as.ppp(st_coordinates(my_2021_Q4), st_bbox(my_2021_Q4))\n\nquarter_data_ppp_jit <- rjitter(quarter_data_ppp, \n                             retry=TRUE, \n                             nsim=1, \n                             drop=TRUE)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmy_2021_Q4_B_quarter_data_regions_ppp = quarter_data_ppp_jit[regions_owin]\nquarter_data_regions_ppp.km <- rescale.ppp(my_2021_Q4_B_quarter_data_regions_ppp, 50000, \"km\")\n\nbw_scott <- bw.scott(quarter_data_regions_ppp.km)\n\nplot(density(quarter_data_regions_ppp.km, \n             sigma=bw_scott/2, \n             edge=TRUE, \n             kernel=\"gaussian\"), \n     main = \"2021 Q4 - Battles\")\n```\n\n::: {.cell-output-display}\n![](Take-home_ex01_files/figure-html/unnamed-chunk-56-1.png){width=1152}\n:::\n:::\n\n\n## Violence against civilians\n\n\n::: {.cell}\n\n```{.r .cell-code}\nExample <- \"Violence against civilians\"\nmy_2021_Q4 <- acled_sf  %>%\n  filter(event_type == Example & quarter == \"2021 Q4\")\nquarter_data <- as_Spatial(my_2021_Q4)\nquarter_data_sp <- as(quarter_data, \"SpatialPoints\")\nquarter_data_ppp <- as.ppp(st_coordinates(my_2021_Q4), st_bbox(my_2021_Q4))\n\nquarter_data_ppp_jit <- rjitter(quarter_data_ppp, \n                             retry=TRUE, \n                             nsim=1, \n                             drop=TRUE)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmy_2021_Q4_VAC_quarter_data_regions_ppp = quarter_data_ppp_jit[regions_owin]\nquarter_data_regions_ppp.km <- rescale.ppp(my_2021_Q4_VAC_quarter_data_regions_ppp, 50000, \"km\")\n\nbw_scott <- bw.scott(quarter_data_regions_ppp.km)\n\nplot(density(quarter_data_regions_ppp.km, \n             sigma=bw_scott/2, \n             edge=TRUE, \n             kernel=\"gaussian\"), \n     main = \"2021 Q4 - Violence against civilians\")\n```\n\n::: {.cell-output-display}\n![](Take-home_ex01_files/figure-html/unnamed-chunk-58-1.png){width=1152}\n:::\n:::\n\n:::\n\n### **Year 2022**\n\n#### **Quarter 1**\n\n::: panel-tabset\n## Explosions/Remote violence\n\n\n::: {.cell}\n\n```{.r .cell-code}\nExample <- \"Explosions/Remote violence\"\nmy_2022_Q1 <- acled_sf  %>%\n  filter(event_type == Example & quarter == \"2022 Q1\")\nquarter_data <- as_Spatial(my_2022_Q1)\nquarter_data_sp <- as(quarter_data, \"SpatialPoints\")\nquarter_data_ppp <- as.ppp(st_coordinates(my_2022_Q1), st_bbox(my_2022_Q1))\n\nquarter_data_ppp_jit <- rjitter(quarter_data_ppp, \n                             retry=TRUE, \n                             nsim=1, \n                             drop=TRUE)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmy_2022_Q1_ER_quarter_data_regions_ppp = quarter_data_ppp_jit[regions_owin]\nquarter_data_regions_ppp.km <- rescale.ppp(my_2022_Q1_ER_quarter_data_regions_ppp, 50000, \"km\")\n\nbw_scott <- bw.scott(quarter_data_regions_ppp.km)\n\nplot(density(quarter_data_regions_ppp.km, \n             sigma=bw_scott/2, \n             edge=TRUE, \n             kernel=\"gaussian\"), \n     main = \"2022 Q1 - Explosion/Remote violence\")\n```\n\n::: {.cell-output-display}\n![](Take-home_ex01_files/figure-html/unnamed-chunk-60-1.png){width=1152}\n:::\n:::\n\n\n## Strategic developments\n\n\n::: {.cell}\n\n```{.r .cell-code}\nExample <- \"Strategic developments\"\nmy_2022_Q1 <- acled_sf  %>%\n  filter(event_type == Example & quarter == \"2022 Q1\")\nquarter_data <- as_Spatial(my_2022_Q1)\nquarter_data_sp <- as(quarter_data, \"SpatialPoints\")\nquarter_data_ppp <- as.ppp(st_coordinates(my_2022_Q1), st_bbox(my_2022_Q1))\n\nquarter_data_ppp_jit <- rjitter(quarter_data_ppp, \n                             retry=TRUE, \n                             nsim=1, \n                             drop=TRUE)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmy_2022_Q1_SD_quarter_data_regions_ppp = quarter_data_ppp_jit[regions_owin]\nquarter_data_regions_ppp.km <- rescale.ppp(my_2022_Q1_SD_quarter_data_regions_ppp, 50000, \"km\")\n\nbw_scott <- bw.scott(quarter_data_regions_ppp.km)\n\nplot(density(quarter_data_regions_ppp.km, \n             sigma=bw_scott/2, \n             edge=TRUE, \n             kernel=\"gaussian\"), \n     main = \"2022 Q1 - Strategic developments\")\n```\n\n::: {.cell-output-display}\n![](Take-home_ex01_files/figure-html/unnamed-chunk-62-1.png){width=1152}\n:::\n:::\n\n\n## Battles\n\n\n::: {.cell}\n\n```{.r .cell-code}\nExample <- \"Battles\"\nmy_2022_Q1 <- acled_sf  %>%\n  filter(event_type == Example & quarter == \"2022 Q1\")\nquarter_data <- as_Spatial(my_2022_Q1)\nquarter_data_sp <- as(quarter_data, \"SpatialPoints\")\nquarter_data_ppp <- as.ppp(st_coordinates(my_2022_Q1), st_bbox(my_2022_Q1))\n\nquarter_data_ppp_jit <- rjitter(quarter_data_ppp, \n                             retry=TRUE, \n                             nsim=1, \n                             drop=TRUE)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmy_2022_Q1_B_quarter_data_regions_ppp = quarter_data_ppp_jit[regions_owin]\nquarter_data_regions_ppp.km <- rescale.ppp(my_2022_Q1_B_quarter_data_regions_ppp, 50000, \"km\")\n\nbw_scott <- bw.scott(quarter_data_regions_ppp.km)\n\nplot(density(quarter_data_regions_ppp.km, \n             sigma=bw_scott/2, \n             edge=TRUE, \n             kernel=\"gaussian\"), \n     main = \"2022 Q1 - Battles\")\n```\n\n::: {.cell-output-display}\n![](Take-home_ex01_files/figure-html/unnamed-chunk-64-1.png){width=1152}\n:::\n:::\n\n\n## Violence against civilians\n\n\n::: {.cell}\n\n```{.r .cell-code}\nExample <- \"Violence against civilians\"\nmy_2022_Q1 <- acled_sf  %>%\n  filter(event_type == Example & quarter == \"2022 Q1\")\nquarter_data <- as_Spatial(my_2022_Q1)\nquarter_data_sp <- as(quarter_data, \"SpatialPoints\")\nquarter_data_ppp <- as.ppp(st_coordinates(my_2022_Q1), st_bbox(my_2022_Q1))\n\nquarter_data_ppp_jit <- rjitter(quarter_data_ppp, \n                             retry=TRUE, \n                             nsim=1, \n                             drop=TRUE)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmy_2022_Q1_VAC_quarter_data_regions_ppp = quarter_data_ppp_jit[regions_owin]\nquarter_data_regions_ppp.km <- rescale.ppp(my_2022_Q1_VAC_quarter_data_regions_ppp, 50000, \"km\")\n\nbw_scott <- bw.scott(quarter_data_regions_ppp.km)\n\nplot(density(quarter_data_regions_ppp.km, \n             sigma=bw_scott/2, \n             edge=TRUE, \n             kernel=\"gaussian\"), \n     main = \"2022 Q1 -Violence against civilians\")\n```\n\n::: {.cell-output-display}\n![](Take-home_ex01_files/figure-html/unnamed-chunk-66-1.png){width=1152}\n:::\n:::\n\n:::\n\n#### **Quarter 2**\n\n::: panel-tabset\n## Explosions/Remote violence\n\n\n::: {.cell}\n\n```{.r .cell-code}\nExample <- \"Explosions/Remote violence\"\nmy_2022_Q2 <- acled_sf  %>%\n  filter(event_type == Example & quarter == \"2022 Q2\")\nquarter_data <- as_Spatial(my_2022_Q2)\nquarter_data_sp <- as(quarter_data, \"SpatialPoints\")\nquarter_data_ppp <- as.ppp(st_coordinates(my_2022_Q2), st_bbox(my_2022_Q2))\n\nquarter_data_ppp_jit <- rjitter(quarter_data_ppp, \n                             retry=TRUE, \n                             nsim=1, \n                             drop=TRUE)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmy_2022_Q2_ER_quarter_data_regions_ppp = quarter_data_ppp_jit[regions_owin]\nquarter_data_regions_ppp.km <- rescale.ppp(my_2022_Q2_ER_quarter_data_regions_ppp, 50000, \"km\")\n\nbw_scott <- bw.scott(quarter_data_regions_ppp.km)\n\nplot(density(quarter_data_regions_ppp.km, \n             sigma=bw_scott/2, \n             edge=TRUE, \n             kernel=\"gaussian\"), \n     main = \"2022 Q2 - Explosion/Remote violence\")\n```\n\n::: {.cell-output-display}\n![](Take-home_ex01_files/figure-html/unnamed-chunk-68-1.png){width=1152}\n:::\n:::\n\n\n## Strategic developments\n\n\n::: {.cell}\n\n```{.r .cell-code}\nExample <- \"Strategic developments\"\nmy_2022_Q2 <- acled_sf  %>%\n  filter(event_type == Example & quarter == \"2022 Q2\")\nquarter_data <- as_Spatial(my_2022_Q2)\nquarter_data_sp <- as(quarter_data, \"SpatialPoints\")\nquarter_data_ppp <- as.ppp(st_coordinates(my_2022_Q2), st_bbox(my_2022_Q2))\n\nquarter_data_ppp_jit <- rjitter(quarter_data_ppp, \n                             retry=TRUE, \n                             nsim=1, \n                             drop=TRUE)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmy_2022_Q2_SD_quarter_data_regions_ppp = quarter_data_ppp_jit[regions_owin]\nquarter_data_regions_ppp.km <- rescale.ppp(my_2022_Q2_SD_quarter_data_regions_ppp, 50000, \"km\")\n\nbw_scott <- bw.scott(quarter_data_regions_ppp.km)\n\nplot(density(quarter_data_regions_ppp.km, \n             sigma=bw_scott/2, \n             edge=TRUE, \n             kernel=\"gaussian\"), \n     main = \"2022 Q2 - Strategic developments\")\n```\n\n::: {.cell-output-display}\n![](Take-home_ex01_files/figure-html/unnamed-chunk-70-1.png){width=1152}\n:::\n:::\n\n\n## Battles\n\n\n::: {.cell}\n\n```{.r .cell-code}\nExample <- \"Battles\"\nmy_2022_Q2 <- acled_sf  %>%\n  filter(event_type == Example & quarter == \"2022 Q2\")\nquarter_data <- as_Spatial(my_2022_Q2)\nquarter_data_sp <- as(quarter_data, \"SpatialPoints\")\nquarter_data_ppp <- as.ppp(st_coordinates(my_2022_Q2), st_bbox(my_2022_Q2))\n\nquarter_data_ppp_jit <- rjitter(quarter_data_ppp, \n                             retry=TRUE, \n                             nsim=1, \n                             drop=TRUE)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmy_2022_Q2_B_quarter_data_regions_ppp = quarter_data_ppp_jit[regions_owin]\nquarter_data_regions_ppp.km <- rescale.ppp(my_2022_Q2_B_quarter_data_regions_ppp, 50000, \"km\")\n\nbw_scott <- bw.scott(quarter_data_regions_ppp.km)\n\nplot(density(quarter_data_regions_ppp.km, \n             sigma=bw_scott/2, \n             edge=TRUE, \n             kernel=\"gaussian\"), \n     main = \"2022 Q2 - Battles\")\n```\n\n::: {.cell-output-display}\n![](Take-home_ex01_files/figure-html/unnamed-chunk-72-1.png){width=1152}\n:::\n:::\n\n\n## Violence against civilians\n\n\n::: {.cell}\n\n```{.r .cell-code}\nExample <- \"Violence against civilians\"\nmy_2022_Q2 <- acled_sf  %>%\n  filter(event_type == Example & quarter == \"2022 Q2\")\nquarter_data <- as_Spatial(my_2022_Q2)\nquarter_data_sp <- as(quarter_data, \"SpatialPoints\")\nquarter_data_ppp <- as.ppp(st_coordinates(my_2022_Q2), st_bbox(my_2022_Q2))\n\nquarter_data_ppp_jit <- rjitter(quarter_data_ppp, \n                             retry=TRUE, \n                             nsim=1, \n                             drop=TRUE)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmy_2022_Q2_VAC_quarter_data_regions_ppp = quarter_data_ppp_jit[regions_owin]\nquarter_data_regions_ppp.km <- rescale.ppp(my_2022_Q2_VAC_quarter_data_regions_ppp, 50000, \"km\")\n\nbw_scott <- bw.scott(quarter_data_regions_ppp.km)\n\nplot(density(quarter_data_regions_ppp.km, \n             sigma=bw_scott/2, \n             edge=TRUE, \n             kernel=\"gaussian\"), \n     main = \"2022 Q2 - Violence against civilians\")\n```\n\n::: {.cell-output-display}\n![](Take-home_ex01_files/figure-html/unnamed-chunk-74-1.png){width=1152}\n:::\n:::\n\n:::\n\n#### **Quarter 3**\n\n::: panel-tabset\n## Explosions/Remote violence\n\n\n::: {.cell}\n\n```{.r .cell-code}\nExample <- \"Explosions/Remote violence\"\nmy_2022_Q3 <- acled_sf  %>%\n  filter(event_type == Example & quarter == \"2022 Q3\")\nquarter_data <- as_Spatial(my_2022_Q3)\nquarter_data_sp <- as(quarter_data, \"SpatialPoints\")\nquarter_data_ppp <- as.ppp(st_coordinates(my_2022_Q3), st_bbox(my_2022_Q3))\n\nquarter_data_ppp_jit <- rjitter(quarter_data_ppp, \n                             retry=TRUE, \n                             nsim=1, \n                             drop=TRUE)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmy_2022_Q3_ER_quarter_data_regions_ppp = quarter_data_ppp_jit[regions_owin]\nquarter_data_regions_ppp.km <- rescale.ppp(my_2022_Q3_ER_quarter_data_regions_ppp, 50000, \"km\")\n\nbw_scott <- bw.scott(quarter_data_regions_ppp.km)\n\nplot(density(quarter_data_regions_ppp.km, \n             sigma=bw_scott/2, \n             edge=TRUE, \n             kernel=\"gaussian\"), \n     main = \"2022 Q3 - Explosion/Remote violence\")\n```\n\n::: {.cell-output-display}\n![](Take-home_ex01_files/figure-html/unnamed-chunk-76-1.png){width=1152}\n:::\n:::\n\n\n## Strategic developments\n\n\n::: {.cell}\n\n```{.r .cell-code}\nExample <- \"Strategic developments\"\nmy_2022_Q3 <- acled_sf  %>%\n  filter(event_type == Example & quarter == \"2022 Q3\")\nquarter_data <- as_Spatial(my_2022_Q3)\nquarter_data_sp <- as(quarter_data, \"SpatialPoints\")\nquarter_data_ppp <- as.ppp(st_coordinates(my_2022_Q3), st_bbox(my_2022_Q3))\n\nquarter_data_ppp_jit <- rjitter(quarter_data_ppp, \n                             retry=TRUE, \n                             nsim=1, \n                             drop=TRUE)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmy_2022_Q3_SD_quarter_data_regions_ppp = quarter_data_ppp_jit[regions_owin]\nquarter_data_regions_ppp.km <- rescale.ppp(my_2022_Q3_SD_quarter_data_regions_ppp, 50000, \"km\")\n\nbw_scott <- bw.scott(quarter_data_regions_ppp.km)\n\nplot(density(quarter_data_regions_ppp.km, \n             sigma=bw_scott/2, \n             edge=TRUE, \n             kernel=\"gaussian\"), \n     main = \"2022 Q3 - Strategic developments\")\n```\n\n::: {.cell-output-display}\n![](Take-home_ex01_files/figure-html/unnamed-chunk-78-1.png){width=1152}\n:::\n:::\n\n\n## Battles\n\n\n::: {.cell}\n\n```{.r .cell-code}\nExample <- \"Battles\"\nmy_2022_Q3 <- acled_sf  %>%\n  filter(event_type == Example & quarter == \"2022 Q3\")\nquarter_data <- as_Spatial(my_2022_Q3)\nquarter_data_sp <- as(quarter_data, \"SpatialPoints\")\nquarter_data_ppp <- as.ppp(st_coordinates(my_2022_Q3), st_bbox(my_2022_Q3))\n\nquarter_data_ppp_jit <- rjitter(quarter_data_ppp, \n                             retry=TRUE, \n                             nsim=1, \n                             drop=TRUE)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmy_2022_Q3_B_quarter_data_regions_ppp = quarter_data_ppp_jit[regions_owin]\nquarter_data_regions_ppp.km <- rescale.ppp(my_2022_Q3_B_quarter_data_regions_ppp, 50000, \"km\")\n\nbw_scott <- bw.scott(quarter_data_regions_ppp.km)\n\nplot(density(quarter_data_regions_ppp.km, \n             sigma=bw_scott/2, \n             edge=TRUE, \n             kernel=\"gaussian\"), \n     main = \"2022 Q3 - Battles\")\n```\n\n::: {.cell-output-display}\n![](Take-home_ex01_files/figure-html/unnamed-chunk-80-1.png){width=1152}\n:::\n:::\n\n\n## Violence against civilians\n\n\n::: {.cell}\n\n```{.r .cell-code}\nExample <- \"Violence against civilians\"\nmy_2022_Q3 <- acled_sf  %>%\n  filter(event_type == Example & quarter == \"2022 Q3\")\nquarter_data <- as_Spatial(my_2022_Q3)\nquarter_data_sp <- as(quarter_data, \"SpatialPoints\")\nquarter_data_ppp <- as.ppp(st_coordinates(my_2022_Q3), st_bbox(my_2022_Q3))\n\nquarter_data_ppp_jit <- rjitter(quarter_data_ppp, \n                             retry=TRUE, \n                             nsim=1, \n                             drop=TRUE)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmy_2022_Q3_VAC_quarter_data_regions_ppp = quarter_data_ppp_jit[regions_owin]\nquarter_data_regions_ppp.km <- rescale.ppp(my_2022_Q3_VAC_quarter_data_regions_ppp, 50000, \"km\")\n\nbw_scott <- bw.scott(quarter_data_regions_ppp.km)\n\nplot(density(quarter_data_regions_ppp.km, \n             sigma=bw_scott/2, \n             edge=TRUE, \n             kernel=\"gaussian\"), \n     main = \"2022 Q3 - Violence against civilians\")\n```\n\n::: {.cell-output-display}\n![](Take-home_ex01_files/figure-html/unnamed-chunk-82-1.png){width=1152}\n:::\n:::\n\n:::\n\n#### **Quarter 4**\n\n::: panel-tabset\n## Explosions/Remote violence\n\n\n::: {.cell}\n\n```{.r .cell-code}\nExample <- \"Explosions/Remote violence\"\nmy_2022_Q4 <- acled_sf  %>%\n  filter(event_type == Example & quarter == \"2022 Q4\")\nquarter_data <- as_Spatial(my_2022_Q4)\nquarter_data_sp <- as(quarter_data, \"SpatialPoints\")\nquarter_data_ppp <- as.ppp(st_coordinates(my_2022_Q4), st_bbox(my_2022_Q4))\n\nquarter_data_ppp_jit <- rjitter(quarter_data_ppp, \n                             retry=TRUE, \n                             nsim=1, \n                             drop=TRUE)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmy_2022_Q4_ER_quarter_data_regions_ppp = quarter_data_ppp_jit[regions_owin]\nquarter_data_regions_ppp.km <- rescale.ppp(my_2022_Q4_ER_quarter_data_regions_ppp, 50000, \"km\")\n\nbw_scott <- bw.scott(quarter_data_regions_ppp.km)\n\nplot(density(quarter_data_regions_ppp.km, \n             sigma=bw_scott/2, \n             edge=TRUE, \n             kernel=\"gaussian\"), \n     main = \"2022 Q4 - Explosion/Remote violence\")\n```\n\n::: {.cell-output-display}\n![](Take-home_ex01_files/figure-html/unnamed-chunk-84-1.png){width=1152}\n:::\n:::\n\n\n## Strategic developments\n\n\n::: {.cell}\n\n```{.r .cell-code}\nExample <- \"Strategic developments\"\nmy_2022_Q4 <- acled_sf  %>%\n  filter(event_type == Example & quarter == \"2022 Q4\")\nquarter_data <- as_Spatial(my_2022_Q4)\nquarter_data_sp <- as(quarter_data, \"SpatialPoints\")\nquarter_data_ppp <- as.ppp(st_coordinates(my_2022_Q4), st_bbox(my_2022_Q4))\n\nquarter_data_ppp_jit <- rjitter(quarter_data_ppp, \n                             retry=TRUE, \n                             nsim=1, \n                             drop=TRUE)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmy_2022_Q4_SD_quarter_data_regions_ppp = quarter_data_ppp_jit[regions_owin]\nquarter_data_regions_ppp.km <- rescale.ppp(my_2022_Q4_SD_quarter_data_regions_ppp, 50000, \"km\")\n\nbw_scott <- bw.scott(quarter_data_regions_ppp.km)\n\nplot(density(quarter_data_regions_ppp.km, \n             sigma=bw_scott/2, \n             edge=TRUE, \n             kernel=\"gaussian\"), \n     main = \"2022 Q4 - Strategic developments\")\n```\n\n::: {.cell-output-display}\n![](Take-home_ex01_files/figure-html/unnamed-chunk-86-1.png){width=1152}\n:::\n:::\n\n\n## Battles\n\n\n::: {.cell}\n\n```{.r .cell-code}\nExample <- \"Battles\"\nmy_2022_Q4 <- acled_sf  %>%\n  filter(event_type == Example & quarter == \"2022 Q4\")\nquarter_data <- as_Spatial(my_2022_Q4)\nquarter_data_sp <- as(quarter_data, \"SpatialPoints\")\nquarter_data_ppp <- as.ppp(st_coordinates(my_2022_Q4), st_bbox(my_2022_Q4))\n\nquarter_data_ppp_jit <- rjitter(quarter_data_ppp, \n                             retry=TRUE, \n                             nsim=1, \n                             drop=TRUE)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmy_2022_Q4_B_quarter_data_regions_ppp = quarter_data_ppp_jit[regions_owin]\nquarter_data_regions_ppp.km <- rescale.ppp(my_2022_Q4_B_quarter_data_regions_ppp, 50000, \"km\")\n\nbw_scott <- bw.scott(quarter_data_regions_ppp.km)\n\nplot(density(quarter_data_regions_ppp.km, \n             sigma=bw_scott/2, \n             edge=TRUE, \n             kernel=\"gaussian\"), \n     main = \"2022 Q4 - Battles\")\n```\n\n::: {.cell-output-display}\n![](Take-home_ex01_files/figure-html/unnamed-chunk-88-1.png){width=1152}\n:::\n:::\n\n\n## Violence against civilians\n\n\n::: {.cell}\n\n```{.r .cell-code}\nExample <- \"Violence against civilians\"\nmy_2022_Q4 <- acled_sf  %>%\n  filter(event_type == Example & quarter == \"2022 Q4\")\nquarter_data <- as_Spatial(my_2022_Q4)\nquarter_data_sp <- as(quarter_data, \"SpatialPoints\")\nquarter_data_ppp <- as.ppp(st_coordinates(my_2022_Q4), st_bbox(my_2022_Q4))\n\nquarter_data_ppp_jit <- rjitter(quarter_data_ppp, \n                             retry=TRUE, \n                             nsim=1, \n                             drop=TRUE)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmy_2022_Q4_VAC_quarter_data_regions_ppp = quarter_data_ppp_jit[regions_owin]\nquarter_data_regions_ppp.km <- rescale.ppp(my_2022_Q4_VAC_quarter_data_regions_ppp, 50000, \"km\")\n\nbw_scott <- bw.scott(quarter_data_regions_ppp.km)\n\nplot(density(quarter_data_regions_ppp.km, \n             sigma=bw_scott/2, \n             edge=TRUE, \n             kernel=\"gaussian\"), \n     main = \"2022 Q4 - Violence against civilians\")\n```\n\n::: {.cell-output-display}\n![](Take-home_ex01_files/figure-html/unnamed-chunk-90-1.png){width=1152}\n:::\n:::\n\n:::\n\n### **Year 2023**\n\n#### **Quarter 1**\n\n::: panel-tabset\n## Explosions/Remote violence\n\n\n::: {.cell}\n\n```{.r .cell-code}\nExample <- \"Explosions/Remote violence\"\nmy_2023_Q1 <- acled_sf  %>%\n  filter(event_type == Example & quarter == \"2023 Q1\")\nquarter_data <- as_Spatial(my_2023_Q1)\nquarter_data_sp <- as(quarter_data, \"SpatialPoints\")\nquarter_data_ppp <- as.ppp(st_coordinates(my_2023_Q1), st_bbox(my_2023_Q1))\n\nquarter_data_ppp_jit <- rjitter(quarter_data_ppp, \n                             retry=TRUE, \n                             nsim=1, \n                             drop=TRUE)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmy_2023_Q1_ER_quarter_data_regions_ppp = quarter_data_ppp_jit[regions_owin]\nquarter_data_regions_ppp.km <- rescale.ppp(my_2023_Q1_ER_quarter_data_regions_ppp, 50000, \"km\")\n\nbw_scott <- bw.scott(quarter_data_regions_ppp.km)\n\nplot(density(quarter_data_regions_ppp.km, \n             sigma=bw_scott/2, \n             edge=TRUE, \n             kernel=\"gaussian\"), \n     main = \"2023 Q1 - Explosion/Remote violence\")\n```\n\n::: {.cell-output-display}\n![](Take-home_ex01_files/figure-html/unnamed-chunk-92-1.png){width=1152}\n:::\n:::\n\n\n## Strategic developments\n\n\n::: {.cell}\n\n```{.r .cell-code}\nExample <- \"Strategic developments\"\nmy_2023_Q1 <- acled_sf  %>%\n  filter(event_type == Example & quarter == \"2023 Q1\")\nquarter_data <- as_Spatial(my_2023_Q1)\nquarter_data_sp <- as(quarter_data, \"SpatialPoints\")\nquarter_data_ppp <- as.ppp(st_coordinates(my_2023_Q1), st_bbox(my_2023_Q1))\n\nquarter_data_ppp_jit <- rjitter(quarter_data_ppp, \n                             retry=TRUE, \n                             nsim=1, \n                             drop=TRUE)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmy_2023_Q1_SD_quarter_data_regions_ppp = quarter_data_ppp_jit[regions_owin]\nquarter_data_regions_ppp.km <- rescale.ppp(my_2023_Q1_SD_quarter_data_regions_ppp, 50000, \"km\")\n\nbw_scott <- bw.scott(quarter_data_regions_ppp.km)\n\nplot(density(quarter_data_regions_ppp.km, \n             sigma=bw_scott/2, \n             edge=TRUE, \n             kernel=\"gaussian\"), \n     main = \"2023 Q1 - Strategic developments\")\n```\n\n::: {.cell-output-display}\n![](Take-home_ex01_files/figure-html/unnamed-chunk-94-1.png){width=1152}\n:::\n:::\n\n\n## Battles\n\n\n::: {.cell}\n\n```{.r .cell-code}\nExample <- \"Battles\"\nmy_2023_Q1 <- acled_sf  %>%\n  filter(event_type == Example & quarter == \"2023 Q1\")\nquarter_data <- as_Spatial(my_2023_Q1)\nquarter_data_sp <- as(quarter_data, \"SpatialPoints\")\nquarter_data_ppp <- as.ppp(st_coordinates(my_2023_Q1), st_bbox(my_2023_Q1))\n\nquarter_data_ppp_jit <- rjitter(quarter_data_ppp, \n                             retry=TRUE, \n                             nsim=1, \n                             drop=TRUE)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmy_2023_Q1_B_quarter_data_regions_ppp = quarter_data_ppp_jit[regions_owin]\nquarter_data_regions_ppp.km <- rescale.ppp(my_2023_Q1_B_quarter_data_regions_ppp, 50000, \"km\")\n\nbw_scott <- bw.scott(quarter_data_regions_ppp.km)\n\nplot(density(quarter_data_regions_ppp.km, \n             sigma=bw_scott/2, \n             edge=TRUE, \n             kernel=\"gaussian\"), \n     main = \"2023 Q1 - Battles\")\n```\n\n::: {.cell-output-display}\n![](Take-home_ex01_files/figure-html/unnamed-chunk-96-1.png){width=1152}\n:::\n:::\n\n\n## Violence against civilians\n\n\n::: {.cell}\n\n```{.r .cell-code}\nExample <- \"Violence against civilians\"\nmy_2023_Q1 <- acled_sf  %>%\n  filter(event_type == Example & quarter == \"2023 Q1\")\nquarter_data <- as_Spatial(my_2023_Q1)\nquarter_data_sp <- as(quarter_data, \"SpatialPoints\")\nquarter_data_ppp <- as.ppp(st_coordinates(my_2023_Q1), st_bbox(my_2023_Q1))\n\nquarter_data_ppp_jit <- rjitter(quarter_data_ppp, \n                             retry=TRUE, \n                             nsim=1, \n                             drop=TRUE)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmy_2023_Q1_VAC_quarter_data_regions_ppp = quarter_data_ppp_jit[regions_owin]\nquarter_data_regions_ppp.km <- rescale.ppp(my_2023_Q1_VAC_quarter_data_regions_ppp, 50000, \"km\")\n\nbw_scott <- bw.scott(quarter_data_regions_ppp.km)\n\nplot(density(quarter_data_regions_ppp.km, \n             sigma=bw_scott/2, \n             edge=TRUE, \n             kernel=\"gaussian\"), \n     main = \"2023 Q1 -Violence against civilians\")\n```\n\n::: {.cell-output-display}\n![](Take-home_ex01_files/figure-html/unnamed-chunk-98-1.png){width=1152}\n:::\n:::\n\n:::\n\n#### **Quarter 2**\n\n::: panel-tabset\n## Explosions/Remote violence\n\n\n::: {.cell}\n\n```{.r .cell-code}\nExample <- \"Explosions/Remote violence\"\nmy_2023_Q2 <- acled_sf  %>%\n  filter(event_type == Example & quarter == \"2023 Q2\")\nquarter_data <- as_Spatial(my_2023_Q2)\nquarter_data_sp <- as(quarter_data, \"SpatialPoints\")\nquarter_data_ppp <- as.ppp(st_coordinates(my_2023_Q2), st_bbox(my_2023_Q2))\n\nquarter_data_ppp_jit <- rjitter(quarter_data_ppp, \n                             retry=TRUE, \n                             nsim=1, \n                             drop=TRUE)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmy_2023_Q2_ER_quarter_data_regions_ppp = quarter_data_ppp_jit[regions_owin]\nquarter_data_regions_ppp.km <- rescale.ppp(my_2023_Q2_ER_quarter_data_regions_ppp, 50000, \"km\")\n\nbw_scott <- bw.scott(quarter_data_regions_ppp.km)\n\nplot(density(quarter_data_regions_ppp.km, \n             sigma=bw_scott/2, \n             edge=TRUE, \n             kernel=\"gaussian\"), \n     main = \"2023 Q2 - Explosion/Remote violence\")\n```\n\n::: {.cell-output-display}\n![](Take-home_ex01_files/figure-html/unnamed-chunk-100-1.png){width=1152}\n:::\n:::\n\n\n## Strategic developments\n\n\n::: {.cell}\n\n```{.r .cell-code}\nExample <- \"Strategic developments\"\nmy_2023_Q2 <- acled_sf  %>%\n  filter(event_type == Example & quarter == \"2023 Q2\")\nquarter_data <- as_Spatial(my_2023_Q2)\nquarter_data_sp <- as(quarter_data, \"SpatialPoints\")\nquarter_data_ppp <- as.ppp(st_coordinates(my_2023_Q2), st_bbox(my_2023_Q2))\n\nquarter_data_ppp_jit <- rjitter(quarter_data_ppp, \n                             retry=TRUE, \n                             nsim=1, \n                             drop=TRUE)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmy_2023_Q2_SD_quarter_data_regions_ppp = quarter_data_ppp_jit[regions_owin]\nquarter_data_regions_ppp.km <- rescale.ppp(my_2023_Q2_SD_quarter_data_regions_ppp, 50000, \"km\")\n\nbw_scott <- bw.scott(quarter_data_regions_ppp.km)\n\nplot(density(quarter_data_regions_ppp.km, \n             sigma=bw_scott/2, \n             edge=TRUE, \n             kernel=\"gaussian\"), \n     main = \"2023 Q2 - Strategic developments\")\n```\n\n::: {.cell-output-display}\n![](Take-home_ex01_files/figure-html/unnamed-chunk-102-1.png){width=1152}\n:::\n:::\n\n\n## Battles\n\n\n::: {.cell}\n\n```{.r .cell-code}\nExample <- \"Battles\"\nmy_2023_Q2 <- acled_sf  %>%\n  filter(event_type == Example & quarter == \"2023 Q2\")\nquarter_data <- as_Spatial(my_2023_Q2)\nquarter_data_sp <- as(quarter_data, \"SpatialPoints\")\nquarter_data_ppp <- as.ppp(st_coordinates(my_2023_Q2), st_bbox(my_2023_Q2))\n\nquarter_data_ppp_jit <- rjitter(quarter_data_ppp, \n                             retry=TRUE, \n                             nsim=1, \n                             drop=TRUE)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmy_2023_Q2_B_quarter_data_regions_ppp = quarter_data_ppp_jit[regions_owin]\nquarter_data_regions_ppp.km <- rescale.ppp(my_2023_Q2_B_quarter_data_regions_ppp, 50000, \"km\")\n\nbw_scott <- bw.scott(quarter_data_regions_ppp.km)\n\nplot(density(quarter_data_regions_ppp.km, \n             sigma=bw_scott/2, \n             edge=TRUE, \n             kernel=\"gaussian\"), \n     main = \"2023 Q2 - Battles\")\n```\n\n::: {.cell-output-display}\n![](Take-home_ex01_files/figure-html/unnamed-chunk-104-1.png){width=1152}\n:::\n:::\n\n\n## Violence against civilians\n\n\n::: {.cell}\n\n```{.r .cell-code}\nExample <- \"Violence against civilians\"\nmy_2023_Q2 <- acled_sf  %>%\n  filter(event_type == Example & quarter == \"2023 Q2\")\nquarter_data <- as_Spatial(my_2023_Q2)\nquarter_data_sp <- as(quarter_data, \"SpatialPoints\")\nquarter_data_ppp <- as.ppp(st_coordinates(my_2023_Q2), st_bbox(my_2023_Q2))\n\nquarter_data_ppp_jit <- rjitter(quarter_data_ppp, \n                             retry=TRUE, \n                             nsim=1, \n                             drop=TRUE)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmy_2023_Q2_VAC_quarter_data_regions_ppp = quarter_data_ppp_jit[regions_owin]\nquarter_data_regions_ppp.km <- rescale.ppp(my_2023_Q2_VAC_quarter_data_regions_ppp, 50000, \"km\")\n\nbw_scott <- bw.scott(quarter_data_regions_ppp.km)\n\nplot(density(quarter_data_regions_ppp.km, \n             sigma=bw_scott/2, \n             edge=TRUE, \n             kernel=\"gaussian\"), \n     main = \"2023 Q2 - Violence against civilians\")\n```\n\n::: {.cell-output-display}\n![](Take-home_ex01_files/figure-html/unnamed-chunk-106-1.png){width=1152}\n:::\n:::\n\n:::\n\n#### **Quarter 3**\n\n::: panel-tabset\n## Explosions/Remote violence\n\n\n::: {.cell}\n\n```{.r .cell-code}\nExample <- \"Explosions/Remote violence\"\nmy_2023_Q3 <- acled_sf  %>%\n  filter(event_type == Example & quarter == \"2023 Q3\")\nquarter_data <- as_Spatial(my_2023_Q3)\nquarter_data_sp <- as(quarter_data, \"SpatialPoints\")\nquarter_data_ppp <- as.ppp(st_coordinates(my_2023_Q3), st_bbox(my_2023_Q3))\n\nquarter_data_ppp_jit <- rjitter(quarter_data_ppp, \n                             retry=TRUE, \n                             nsim=1, \n                             drop=TRUE)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmy_2023_Q3_ER_quarter_data_regions_ppp = quarter_data_ppp_jit[regions_owin]\nquarter_data_regions_ppp.km <- rescale.ppp(my_2023_Q3_ER_quarter_data_regions_ppp, 50000, \"km\")\n\nbw_scott <- bw.scott(quarter_data_regions_ppp.km)\n\nplot(density(quarter_data_regions_ppp.km, \n             sigma=bw_scott/2, \n             edge=TRUE, \n             kernel=\"gaussian\"), \n     main = \"2023 Q3 - Explosion/Remote violence\")\n```\n\n::: {.cell-output-display}\n![](Take-home_ex01_files/figure-html/unnamed-chunk-108-1.png){width=1152}\n:::\n:::\n\n\n## Strategic developments\n\n\n::: {.cell}\n\n```{.r .cell-code}\nExample <- \"Strategic developments\"\nmy_2023_Q3 <- acled_sf  %>%\n  filter(event_type == Example & quarter == \"2023 Q3\")\nquarter_data <- as_Spatial(my_2023_Q3)\nquarter_data_sp <- as(quarter_data, \"SpatialPoints\")\nquarter_data_ppp <- as.ppp(st_coordinates(my_2023_Q3), st_bbox(my_2023_Q3))\n\nquarter_data_ppp_jit <- rjitter(quarter_data_ppp, \n                             retry=TRUE, \n                             nsim=1, \n                             drop=TRUE)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmy_2023_Q3_SD_quarter_data_regions_ppp = quarter_data_ppp_jit[regions_owin]\nquarter_data_regions_ppp.km <- rescale.ppp(my_2023_Q3_SD_quarter_data_regions_ppp, 50000, \"km\")\n\nbw_scott <- bw.scott(quarter_data_regions_ppp.km)\n\nplot(density(quarter_data_regions_ppp.km, \n             sigma=bw_scott/2, \n             edge=TRUE, \n             kernel=\"gaussian\"), \n     main = \"2023 Q3 - Strategic developments\")\n```\n\n::: {.cell-output-display}\n![](Take-home_ex01_files/figure-html/unnamed-chunk-110-1.png){width=1152}\n:::\n:::\n\n\n## Battles\n\n\n::: {.cell}\n\n```{.r .cell-code}\nExample <- \"Battles\"\nmy_2023_Q3 <- acled_sf  %>%\n  filter(event_type == Example & quarter == \"2023 Q3\")\nquarter_data <- as_Spatial(my_2023_Q3)\nquarter_data_sp <- as(quarter_data, \"SpatialPoints\")\nquarter_data_ppp <- as.ppp(st_coordinates(my_2023_Q3), st_bbox(my_2023_Q3))\n\nquarter_data_ppp_jit <- rjitter(quarter_data_ppp, \n                             retry=TRUE, \n                             nsim=1, \n                             drop=TRUE)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmy_2023_Q3_B_quarter_data_regions_ppp = quarter_data_ppp_jit[regions_owin]\nquarter_data_regions_ppp.km <- rescale.ppp(my_2023_Q3_B_quarter_data_regions_ppp, 50000, \"km\")\n\nbw_scott <- bw.scott(quarter_data_regions_ppp.km)\n\nplot(density(quarter_data_regions_ppp.km, \n             sigma=bw_scott/2, \n             edge=TRUE, \n             kernel=\"gaussian\"), \n     main = \"2023 Q3 - Battles\")\n```\n\n::: {.cell-output-display}\n![](Take-home_ex01_files/figure-html/unnamed-chunk-112-1.png){width=1152}\n:::\n:::\n\n\n## Violence against civilians\n\n\n::: {.cell}\n\n```{.r .cell-code}\nExample <- \"Violence against civilians\"\nmy_2023_Q3 <- acled_sf  %>%\n  filter(event_type == Example & quarter == \"2023 Q3\")\nquarter_data <- as_Spatial(my_2023_Q3)\nquarter_data_sp <- as(quarter_data, \"SpatialPoints\")\nquarter_data_ppp <- as.ppp(st_coordinates(my_2023_Q3), st_bbox(my_2023_Q3))\n\nquarter_data_ppp_jit <- rjitter(quarter_data_ppp, \n                             retry=TRUE, \n                             nsim=1, \n                             drop=TRUE)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmy_2023_Q3_VAC_quarter_data_regions_ppp = quarter_data_ppp_jit[regions_owin]\nquarter_data_regions_ppp.km <- rescale.ppp(my_2023_Q3_VAC_quarter_data_regions_ppp, 50000, \"km\")\n\nbw_scott <- bw.scott(quarter_data_regions_ppp.km)\n\nplot(density(quarter_data_regions_ppp.km, \n             sigma=bw_scott/2, \n             edge=TRUE, \n             kernel=\"gaussian\"), \n     main = \"2023 Q3 - Violence against civilians\")\n```\n\n::: {.cell-output-display}\n![](Take-home_ex01_files/figure-html/unnamed-chunk-114-1.png){width=1152}\n:::\n:::\n\n:::\n\n#### **Quarter 4**\n\n::: panel-tabset\n## Explosions/Remote violence\n\n\n::: {.cell}\n\n```{.r .cell-code}\nExample <- \"Explosions/Remote violence\"\nmy_2023_Q4 <- acled_sf  %>%\n  filter(event_type == Example & quarter == \"2023 Q4\")\nquarter_data <- as_Spatial(my_2023_Q4)\nquarter_data_sp <- as(quarter_data, \"SpatialPoints\")\nquarter_data_ppp <- as.ppp(st_coordinates(my_2023_Q4), st_bbox(my_2023_Q4))\n\nquarter_data_ppp_jit <- rjitter(quarter_data_ppp, \n                             retry=TRUE, \n                             nsim=1, \n                             drop=TRUE)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmy_2023_Q4_ER_quarter_data_regions_ppp = quarter_data_ppp_jit[regions_owin]\nquarter_data_regions_ppp.km <- rescale.ppp(my_2023_Q4_ER_quarter_data_regions_ppp, 50000, \"km\")\n\nbw_scott <- bw.scott(quarter_data_regions_ppp.km)\n\nplot(density(quarter_data_regions_ppp.km, \n             sigma=bw_scott/2, \n             edge=TRUE, \n             kernel=\"gaussian\"), \n     main = \"2023 Q4 - Explosion/Remote violence\")\n```\n\n::: {.cell-output-display}\n![](Take-home_ex01_files/figure-html/unnamed-chunk-116-1.png){width=1152}\n:::\n:::\n\n\n## Strategic developments\n\n\n::: {.cell}\n\n```{.r .cell-code}\nExample <- \"Strategic developments\"\nmy_2023_Q4 <- acled_sf  %>%\n  filter(event_type == Example & quarter == \"2023 Q4\")\nquarter_data <- as_Spatial(my_2023_Q4)\nquarter_data_sp <- as(quarter_data, \"SpatialPoints\")\nquarter_data_ppp <- as.ppp(st_coordinates(my_2023_Q4), st_bbox(my_2023_Q4))\n\nquarter_data_ppp_jit <- rjitter(quarter_data_ppp, \n                             retry=TRUE, \n                             nsim=1, \n                             drop=TRUE)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmy_2023_Q4_SD_quarter_data_regions_ppp = quarter_data_ppp_jit[regions_owin]\nquarter_data_regions_ppp.km <- rescale.ppp(my_2023_Q4_SD_quarter_data_regions_ppp, 50000, \"km\")\n\nbw_scott <- bw.scott(quarter_data_regions_ppp.km)\n\nplot(density(quarter_data_regions_ppp.km, \n             sigma=bw_scott/2, \n             edge=TRUE, \n             kernel=\"gaussian\"), \n     main = \"2023 Q4 - Strategic developments\")\n```\n\n::: {.cell-output-display}\n![](Take-home_ex01_files/figure-html/unnamed-chunk-118-1.png){width=1152}\n:::\n:::\n\n\n## Battles\n\n\n::: {.cell}\n\n```{.r .cell-code}\nExample <- \"Battles\"\nmy_2023_Q4 <- acled_sf  %>%\n  filter(event_type == Example & quarter == \"2023 Q4\")\nquarter_data <- as_Spatial(my_2023_Q4)\nquarter_data_sp <- as(quarter_data, \"SpatialPoints\")\nquarter_data_ppp <- as.ppp(st_coordinates(my_2023_Q4), st_bbox(my_2023_Q4))\n\nquarter_data_ppp_jit <- rjitter(quarter_data_ppp, \n                             retry=TRUE, \n                             nsim=1, \n                             drop=TRUE)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmy_2023_Q4_B_quarter_data_regions_ppp = quarter_data_ppp_jit[regions_owin]\nquarter_data_regions_ppp.km <- rescale.ppp(my_2023_Q4_B_quarter_data_regions_ppp, 50000, \"km\")\n\nbw_scott <- bw.scott(quarter_data_regions_ppp.km)\n\nplot(density(quarter_data_regions_ppp.km, \n             sigma=bw_scott/2, \n             edge=TRUE, \n             kernel=\"gaussian\"), \n     main = \"2023 Q4 - Battles\")\n```\n\n::: {.cell-output-display}\n![](Take-home_ex01_files/figure-html/unnamed-chunk-120-1.png){width=1152}\n:::\n:::\n\n\n## Violence against civilians\n\n\n::: {.cell}\n\n```{.r .cell-code}\nExample <- \"Violence against civilians\"\nmy_2023_Q4 <- acled_sf  %>%\n  filter(event_type == Example & quarter == \"2023 Q4\")\nquarter_data <- as_Spatial(my_2023_Q4)\nquarter_data_sp <- as(quarter_data, \"SpatialPoints\")\nquarter_data_ppp <- as.ppp(st_coordinates(my_2023_Q4), st_bbox(my_2023_Q4))\n\nquarter_data_ppp_jit <- rjitter(quarter_data_ppp, \n                             retry=TRUE, \n                             nsim=1, \n                             drop=TRUE)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmy_2023_Q4_VAC_quarter_data_regions_ppp = quarter_data_ppp_jit[regions_owin]\nquarter_data_regions_ppp.km <- rescale.ppp(my_2023_Q4_VAC_quarter_data_regions_ppp, 50000, \"km\")\n\nbw_scott <- bw.scott(quarter_data_regions_ppp.km)\n\nplot(density(quarter_data_regions_ppp.km, \n             sigma=bw_scott/2, \n             edge=TRUE, \n             kernel=\"gaussian\"), \n     main = \"2023 Q4 - Violence against civilians\")\n```\n\n::: {.cell-output-display}\n![](Take-home_ex01_files/figure-html/unnamed-chunk-122-1.png){width=1152}\n:::\n:::\n\n:::\n\n### **Year 2024**\n\n#### **Quarter 1**\n\n::: panel-tabset\n## Explosions/Remote violence\n\n\n::: {.cell}\n\n```{.r .cell-code}\nExample <- \"Explosions/Remote violence\"\nmy_2024_Q1 <- acled_sf  %>%\n  filter(event_type == Example & quarter == \"2024 Q1\")\nquarter_data <- as_Spatial(my_2024_Q1)\nquarter_data_sp <- as(quarter_data, \"SpatialPoints\")\nquarter_data_ppp <- as.ppp(st_coordinates(my_2024_Q1), st_bbox(my_2024_Q1))\n\nquarter_data_ppp_jit <- rjitter(quarter_data_ppp, \n                             retry=TRUE, \n                             nsim=1, \n                             drop=TRUE)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmy_2024_Q1_ER_quarter_data_regions_ppp = quarter_data_ppp_jit[regions_owin]\nquarter_data_regions_ppp.km <- rescale.ppp(my_2024_Q1_ER_quarter_data_regions_ppp, 50000, \"km\")\n\nbw_scott <- bw.scott(quarter_data_regions_ppp.km)\n\nplot(density(quarter_data_regions_ppp.km, \n             sigma=bw_scott/2, \n             edge=TRUE, \n             kernel=\"gaussian\"), \n     main = \"2024 Q1 - Explosion/Remote violence\")\n```\n\n::: {.cell-output-display}\n![](Take-home_ex01_files/figure-html/unnamed-chunk-124-1.png){width=1152}\n:::\n:::\n\n\n## Strategic developments\n\n\n::: {.cell}\n\n```{.r .cell-code}\nExample <- \"Strategic developments\"\nmy_2024_Q1 <- acled_sf  %>%\n  filter(event_type == Example & quarter == \"2024 Q1\")\nquarter_data <- as_Spatial(my_2024_Q1)\nquarter_data_sp <- as(quarter_data, \"SpatialPoints\")\nquarter_data_ppp <- as.ppp(st_coordinates(my_2024_Q1), st_bbox(my_2024_Q1))\n\nquarter_data_ppp_jit <- rjitter(quarter_data_ppp, \n                             retry=TRUE, \n                             nsim=1, \n                             drop=TRUE)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmy_2024_Q1_SD_quarter_data_regions_ppp = quarter_data_ppp_jit[regions_owin]\nquarter_data_regions_ppp.km <- rescale.ppp(my_2024_Q1_SD_quarter_data_regions_ppp, 50000, \"km\")\n\nbw_scott <- bw.scott(quarter_data_regions_ppp.km)\n\nplot(density(quarter_data_regions_ppp.km, \n             sigma=bw_scott/2, \n             edge=TRUE, \n             kernel=\"gaussian\"), \n     main = \"2024 Q1 - Strategic developments\")\n```\n\n::: {.cell-output-display}\n![](Take-home_ex01_files/figure-html/unnamed-chunk-126-1.png){width=1152}\n:::\n:::\n\n\n## Battles\n\n\n::: {.cell}\n\n```{.r .cell-code}\nExample <- \"Battles\"\nmy_2024_Q1 <- acled_sf  %>%\n  filter(event_type == Example & quarter == \"2024 Q1\")\nquarter_data <- as_Spatial(my_2024_Q1)\nquarter_data_sp <- as(quarter_data, \"SpatialPoints\")\nquarter_data_ppp <- as.ppp(st_coordinates(my_2024_Q1), st_bbox(my_2024_Q1))\n\nquarter_data_ppp_jit <- rjitter(quarter_data_ppp, \n                             retry=TRUE, \n                             nsim=1, \n                             drop=TRUE)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmy_2024_Q1_B_quarter_data_regions_ppp = quarter_data_ppp_jit[regions_owin]\nquarter_data_regions_ppp.km <- rescale.ppp(my_2024_Q1_B_quarter_data_regions_ppp, 50000, \"km\")\n\nbw_scott <- bw.scott(quarter_data_regions_ppp.km)\n\nplot(density(quarter_data_regions_ppp.km, \n             sigma=bw_scott/2, \n             edge=TRUE, \n             kernel=\"gaussian\"), \n     main = \"2024 Q1 - Battles\")\n```\n\n::: {.cell-output-display}\n![](Take-home_ex01_files/figure-html/unnamed-chunk-128-1.png){width=1152}\n:::\n:::\n\n\n## Violence against civilians\n\n\n::: {.cell}\n\n```{.r .cell-code}\nExample <- \"Violence against civilians\"\nmy_2024_Q1 <- acled_sf  %>%\n  filter(event_type == Example & quarter == \"2024 Q1\")\nquarter_data <- as_Spatial(my_2024_Q1)\nquarter_data_sp <- as(quarter_data, \"SpatialPoints\")\nquarter_data_ppp <- as.ppp(st_coordinates(my_2024_Q1), st_bbox(my_2024_Q1))\n\nquarter_data_ppp_jit <- rjitter(quarter_data_ppp, \n                             retry=TRUE, \n                             nsim=1, \n                             drop=TRUE)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmy_2024_Q1_VAC_quarter_data_regions_ppp = quarter_data_ppp_jit[regions_owin]\nquarter_data_regions_ppp.km <- rescale.ppp(my_2024_Q1_VAC_quarter_data_regions_ppp, 50000, \"km\")\n\nbw_scott <- bw.scott(quarter_data_regions_ppp.km)\n\nplot(density(quarter_data_regions_ppp.km, \n             sigma=bw_scott/2, \n             edge=TRUE, \n             kernel=\"gaussian\"), \n     main = \"2024 Q1 -Violence against civilians\")\n```\n\n::: {.cell-output-display}\n![](Take-home_ex01_files/figure-html/unnamed-chunk-130-1.png){width=1152}\n:::\n:::\n\n:::\n\n#### **Quarter 2**\n\n::: panel-tabset\n## Explosions/Remote violence\n\n\n::: {.cell}\n\n```{.r .cell-code}\nExample <- \"Explosions/Remote violence\"\nmy_2024_Q2 <- acled_sf  %>%\n  filter(event_type == Example & quarter == \"2024 Q2\")\nquarter_data <- as_Spatial(my_2024_Q2)\nquarter_data_sp <- as(quarter_data, \"SpatialPoints\")\nquarter_data_ppp <- as.ppp(st_coordinates(my_2024_Q2), st_bbox(my_2024_Q2))\n\nquarter_data_ppp_jit <- rjitter(quarter_data_ppp, \n                             retry=TRUE, \n                             nsim=1, \n                             drop=TRUE)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmy_2024_Q2_ER_quarter_data_regions_ppp = quarter_data_ppp_jit[regions_owin]\nquarter_data_regions_ppp.km <- rescale.ppp(my_2024_Q2_ER_quarter_data_regions_ppp, 50000, \"km\")\n\nbw_scott <- bw.scott(quarter_data_regions_ppp.km)\n\nplot(density(quarter_data_regions_ppp.km, \n             sigma=bw_scott/2, \n             edge=TRUE, \n             kernel=\"gaussian\"), \n     main = \"2024 Q2 - Explosion/Remote violence\")\n```\n\n::: {.cell-output-display}\n![](Take-home_ex01_files/figure-html/unnamed-chunk-132-1.png){width=1152}\n:::\n:::\n\n\n## Strategic developments\n\n\n::: {.cell}\n\n```{.r .cell-code}\nExample <- \"Strategic developments\"\nmy_2024_Q2 <- acled_sf  %>%\n  filter(event_type == Example & quarter == \"2024 Q2\")\nquarter_data <- as_Spatial(my_2024_Q2)\nquarter_data_sp <- as(quarter_data, \"SpatialPoints\")\nquarter_data_ppp <- as.ppp(st_coordinates(my_2024_Q2), st_bbox(my_2024_Q2))\n\nquarter_data_ppp_jit <- rjitter(quarter_data_ppp, \n                             retry=TRUE, \n                             nsim=1, \n                             drop=TRUE)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmy_2024_Q2_SD_quarter_data_regions_ppp = quarter_data_ppp_jit[regions_owin]\nquarter_data_regions_ppp.km <- rescale.ppp(my_2024_Q2_SD_quarter_data_regions_ppp, 50000, \"km\")\n\nbw_scott <- bw.scott(quarter_data_regions_ppp.km)\n\nplot(density(quarter_data_regions_ppp.km, \n             sigma=bw_scott/2, \n             edge=TRUE, \n             kernel=\"gaussian\"), \n     main = \"2024 Q2 - Strategic developments\")\n```\n\n::: {.cell-output-display}\n![](Take-home_ex01_files/figure-html/unnamed-chunk-134-1.png){width=1152}\n:::\n:::\n\n\n## Battles\n\n\n::: {.cell}\n\n```{.r .cell-code}\nExample <- \"Battles\"\nmy_2024_Q2 <- acled_sf  %>%\n  filter(event_type == Example & quarter == \"2024 Q2\")\nquarter_data <- as_Spatial(my_2024_Q2)\nquarter_data_sp <- as(quarter_data, \"SpatialPoints\")\nquarter_data_ppp <- as.ppp(st_coordinates(my_2024_Q2), st_bbox(my_2024_Q2))\n\nquarter_data_ppp_jit <- rjitter(quarter_data_ppp, \n                             retry=TRUE, \n                             nsim=1, \n                             drop=TRUE)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmy_2024_Q2_B_quarter_data_regions_ppp = quarter_data_ppp_jit[regions_owin]\nquarter_data_regions_ppp.km <- rescale.ppp(my_2024_Q2_B_quarter_data_regions_ppp, 50000, \"km\")\n\nbw_scott <- bw.scott(quarter_data_regions_ppp.km)\n\nplot(density(quarter_data_regions_ppp.km, \n             sigma=bw_scott/2, \n             edge=TRUE, \n             kernel=\"gaussian\"), \n     main = \"2024 Q2 - Battles\")\n```\n\n::: {.cell-output-display}\n![](Take-home_ex01_files/figure-html/unnamed-chunk-136-1.png){width=1152}\n:::\n:::\n\n\n## Violence against civilians\n\n\n::: {.cell}\n\n```{.r .cell-code}\nExample <- \"Violence against civilians\"\nmy_2024_Q2 <- acled_sf  %>%\n  filter(event_type == Example & quarter == \"2024 Q2\")\nquarter_data <- as_Spatial(my_2024_Q2)\nquarter_data_sp <- as(quarter_data, \"SpatialPoints\")\nquarter_data_ppp <- as.ppp(st_coordinates(my_2024_Q2), st_bbox(my_2024_Q2))\n\nquarter_data_ppp_jit <- rjitter(quarter_data_ppp, \n                             retry=TRUE, \n                             nsim=1, \n                             drop=TRUE)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmy_2024_Q2_VAC_quarter_data_regions_ppp = quarter_data_ppp_jit[regions_owin]\nquarter_data_regions_ppp.km <- rescale.ppp(my_2024_Q2_VAC_quarter_data_regions_ppp, 50000, \"km\")\n\nbw_scott <- bw.scott(quarter_data_regions_ppp.km)\n\nplot(density(quarter_data_regions_ppp.km, \n             sigma=bw_scott/2, \n             edge=TRUE, \n             kernel=\"gaussian\"), \n     main = \"2024 Q2 - Violence against civilians\")\n```\n\n::: {.cell-output-display}\n![](Take-home_ex01_files/figure-html/unnamed-chunk-138-1.png){width=1152}\n:::\n:::\n\n:::\n\n## **1.6 2nd-Order Spatial Point Patterns Analysis**\n\n### **1.6.1 Overview**\n\nTo perform a Second-order Spatial Point Patterns Analysis, we utilize the G, F, K, and L functions of the `spatstat` package in R. Each of these functions analyzes different aspects of spatial point patterns. Given the nature of the dataset, it is crucial to choose an analysis that best captures the complexity of spatial distributions for conflict events. Each of the spatial functions (G, F, K, and L) has its strengths, but here’s how they align with conflict data analysis, with a particular focus on the G-function:\n\n1.  **G-Function (Nearest Neighbor Distribution)**:\n\n    -   **Detecting local clustering**: The G-function focuses on the distribution of nearest neighbors, making it particularly useful for detecting local clustering of events. In the civil war context, where conflict events often cluster in specific regions or around key areas of interest (e.g., cities, roads, military bases), the G-function can quickly and efficiently help identify **hotspots** of violence. Its simplicity and computational efficiency make it an excellent choice for analyzing localized patterns of violence, especially when time and resources are limited.\n\n2.  **F-Function (Empty Space Function)**:\n\n    -   **Detecting global regularity**: The F-function measures the distance from random locations to the nearest event. While it can offer insights into the global spread of events, this function is less relevant for conflict analysis because it emphasizes regularity over clustering, which is not typical in conflict zones. Conflict events are rarely evenly spaced, making the F-function less suited for this kind of data.\n\n3.  **K-Function (Ripley’s K-Function)**:\n\n    -   **Multi-scale clustering**: The K-function is valuable for analyzing clustering at different spatial scales, especially in hierarchical conflict scenarios where regional and local clusters coexist. However, the K-function's multi-scale nature comes with a higher computational cost, making it less practical for when large datasets are involved. While informative, its complexity and runtime can be a drawback.\n\n4.  **L-Function (Transformed K-Function)**:\n\n    -   **Simplifying K-function results**: The L-function is a linearized version of the K-function and offers more intuitive interpretations of clustering versus dispersion. However, like the K-function, it involves significant computation time, and its added complexity may not always justify its use, especially when the G-function already provides key insights into local clustering.\n\nGiven the nature of the civil war event data, where localized patterns and hotspots of violence are of primary concern, the **G-function** emerges as the most suitable tool for analysis. Its ability to efficiently detect **local clustering** while being computationally lightweight makes it a clear choice. While both **K-function** and **L-functions** offer multi-scale insights, they come at the cost of significant computation time, which may not be necessary for this analysis.\n\nThe **G-function** provides a focused and practical approach to understanding the spatial distribution of conflict events, making it the **preferred choice** in this context.\n\n\n### Explosions/Remote violence overview\n\n::: {.cell}\n\n```{.r .cell-code}\n# Create a list of all the ER quarter datasets\ner_datasets <- list(\n  my_2021_Q1_ER_quarter_data_regions_ppp,\n  my_2021_Q2_ER_quarter_data_regions_ppp,\n  my_2021_Q3_ER_quarter_data_regions_ppp,\n  my_2021_Q4_ER_quarter_data_regions_ppp,\n  my_2022_Q1_ER_quarter_data_regions_ppp,\n  my_2022_Q2_ER_quarter_data_regions_ppp,\n  my_2022_Q3_ER_quarter_data_regions_ppp,\n  my_2022_Q4_ER_quarter_data_regions_ppp,\n  my_2023_Q1_ER_quarter_data_regions_ppp,\n  my_2023_Q2_ER_quarter_data_regions_ppp,\n  my_2023_Q3_ER_quarter_data_regions_ppp,\n  my_2023_Q4_ER_quarter_data_regions_ppp,\n  my_2024_Q1_ER_quarter_data_regions_ppp,\n  my_2024_Q2_ER_quarter_data_regions_ppp\n)\n\n# Corresponding year and quarter labels for the plots\ner_labels <- c(\n  \"2021 Q1\", \"2021 Q2\", \"2021 Q3\", \"2021 Q4\",\n  \"2022 Q1\", \"2022 Q2\", \"2022 Q3\", \"2022 Q4\",\n  \"2023 Q1\", \"2023 Q2\", \"2023 Q3\", \"2023 Q4\",\n  \"2024 Q1\", \"2024 Q2\"\n)\n\n# Set up the plotting area\npar(mar = c(2,0,2,0))\npar(mfrow=c(4,4))\n\n# Loop through each dataset and create the KDE plots\nfor (i in seq_along(er_datasets)) {\n    G_CK.csr <- envelope(er_datasets[[i]], Gest, nsim = 50, correction=\"all\", parallel = parallel::detectCores()\n    )\n  plot(G_CK.csr, xlim=c(0,10000), main= er_labels[[i]])\n}\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGenerating 50 simulations of CSR  ...\n1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20,\n21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40,\n41, 42, 43, 44, 45, 46, 47, 48, 49, \n50.\n\nDone.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGenerating 50 simulations of CSR  ...\n1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20,\n21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40,\n41, 42, 43, 44, 45, 46, 47, 48, 49, \n50.\n\nDone.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGenerating 50 simulations of CSR  ...\n1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20,\n21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40,\n41, 42, 43, 44, 45, 46, 47, 48, 49, \n50.\n\nDone.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGenerating 50 simulations of CSR  ...\n1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20,\n21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40,\n41, 42, 43, 44, 45, 46, 47, 48, 49, \n50.\n\nDone.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGenerating 50 simulations of CSR  ...\n1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20,\n21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40,\n41, 42, 43, 44, 45, 46, 47, 48, 49, \n50.\n\nDone.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGenerating 50 simulations of CSR  ...\n1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20,\n21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40,\n41, 42, 43, 44, 45, 46, 47, 48, 49, \n50.\n\nDone.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGenerating 50 simulations of CSR  ...\n1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20,\n21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40,\n41, 42, 43, 44, 45, 46, 47, 48, 49, \n50.\n\nDone.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGenerating 50 simulations of CSR  ...\n1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20,\n21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40,\n41, 42, 43, 44, 45, 46, 47, 48, 49, \n50.\n\nDone.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGenerating 50 simulations of CSR  ...\n1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20,\n21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40,\n41, 42, 43, 44, 45, 46, 47, 48, 49, \n50.\n\nDone.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGenerating 50 simulations of CSR  ...\n1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20,\n21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40,\n41, 42, 43, 44, 45, 46, 47, 48, 49, \n50.\n\nDone.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGenerating 50 simulations of CSR  ...\n1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20,\n21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40,\n41, 42, 43, 44, 45, 46, 47, 48, 49, \n50.\n\nDone.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGenerating 50 simulations of CSR  ...\n1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20,\n21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40,\n41, 42, 43, 44, 45, 46, 47, 48, 49, \n50.\n\nDone.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGenerating 50 simulations of CSR  ...\n1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20,\n21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40,\n41, 42, 43, 44, 45, 46, 47, 48, 49, \n50.\n\nDone.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGenerating 50 simulations of CSR  ...\n1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20,\n21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40,\n41, 42, 43, 44, 45, 46, 47, 48, 49, \n50.\n\nDone.\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](Take-home_ex01_files/figure-html/unnamed-chunk-139-1.png){width=1152}\n:::\n:::\n\n\n### Strategic developments overview\n\n::: {.cell}\n\n```{.r .cell-code}\n# Create a list of all the ER quarter datasets\ner_datasets <- list(\n  my_2021_Q1_SD_quarter_data_regions_ppp,\n  my_2021_Q2_SD_quarter_data_regions_ppp,\n  my_2021_Q3_SD_quarter_data_regions_ppp,\n  my_2021_Q4_SD_quarter_data_regions_ppp,\n  my_2022_Q1_SD_quarter_data_regions_ppp,\n  my_2022_Q2_SD_quarter_data_regions_ppp,\n  my_2022_Q3_SD_quarter_data_regions_ppp,\n  my_2022_Q4_SD_quarter_data_regions_ppp,\n  my_2023_Q1_SD_quarter_data_regions_ppp,\n  my_2023_Q2_SD_quarter_data_regions_ppp,\n  my_2023_Q3_SD_quarter_data_regions_ppp,\n  my_2023_Q4_SD_quarter_data_regions_ppp,\n  my_2024_Q1_SD_quarter_data_regions_ppp,\n  my_2024_Q2_SD_quarter_data_regions_ppp\n)\n\n# Corresponding year and quarter labels for the plots\ner_labels <- c(\n  \"2021 Q1\", \"2021 Q2\", \"2021 Q3\", \"2021 Q4\",\n  \"2022 Q1\", \"2022 Q2\", \"2022 Q3\", \"2022 Q4\",\n  \"2023 Q1\", \"2023 Q2\", \"2023 Q3\", \"2023 Q4\",\n  \"2024 Q1\", \"2024 Q2\"\n)\n\n# Set up the plotting area\npar(mar = c(2,1,2,1))\npar(mfrow=c(4,4))\n\n# Loop through each dataset and create the KDE plots\nfor (i in seq_along(er_datasets)) {\n    G_CK.csr <- envelope(er_datasets[[i]], Gest, nsim = 50, parallel = parallel::detectCores())\n  plot(G_CK.csr, xlim=c(0,10000), main= er_labels[[i]])\n}\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGenerating 50 simulations of CSR  ...\n1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20,\n21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40,\n41, 42, 43, 44, 45, 46, 47, 48, 49, \n50.\n\nDone.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGenerating 50 simulations of CSR  ...\n1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20,\n21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40,\n41, 42, 43, 44, 45, 46, 47, 48, 49, \n50.\n\nDone.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGenerating 50 simulations of CSR  ...\n1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20,\n21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40,\n41, 42, 43, 44, 45, 46, 47, 48, 49, \n50.\n\nDone.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGenerating 50 simulations of CSR  ...\n1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20,\n21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40,\n41, 42, 43, 44, 45, 46, 47, 48, 49, \n50.\n\nDone.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGenerating 50 simulations of CSR  ...\n1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20,\n21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40,\n41, 42, 43, 44, 45, 46, 47, 48, 49, \n50.\n\nDone.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGenerating 50 simulations of CSR  ...\n1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20,\n21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40,\n41, 42, 43, 44, 45, 46, 47, 48, 49, \n50.\n\nDone.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGenerating 50 simulations of CSR  ...\n1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20,\n21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40,\n41, 42, 43, 44, 45, 46, 47, 48, 49, \n50.\n\nDone.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGenerating 50 simulations of CSR  ...\n1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20,\n21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40,\n41, 42, 43, 44, 45, 46, 47, 48, 49, \n50.\n\nDone.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGenerating 50 simulations of CSR  ...\n1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20,\n21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40,\n41, 42, 43, 44, 45, 46, 47, 48, 49, \n50.\n\nDone.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGenerating 50 simulations of CSR  ...\n1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20,\n21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40,\n41, 42, 43, 44, 45, 46, 47, 48, 49, \n50.\n\nDone.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGenerating 50 simulations of CSR  ...\n1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20,\n21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40,\n41, 42, 43, 44, 45, 46, 47, 48, 49, \n50.\n\nDone.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGenerating 50 simulations of CSR  ...\n1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20,\n21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40,\n41, 42, 43, 44, 45, 46, 47, 48, 49, \n50.\n\nDone.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGenerating 50 simulations of CSR  ...\n1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20,\n21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40,\n41, 42, 43, 44, 45, 46, 47, 48, 49, \n50.\n\nDone.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGenerating 50 simulations of CSR  ...\n1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20,\n21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40,\n41, 42, 43, 44, 45, 46, 47, 48, 49, \n50.\n\nDone.\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](Take-home_ex01_files/figure-html/unnamed-chunk-140-1.png){width=1152}\n:::\n:::\n\n\n### Battles overview\n\n::: {.cell}\n\n```{.r .cell-code}\n# Create a list of all the ER quarter datasets\ner_datasets <- list(\n  my_2021_Q1_B_quarter_data_regions_ppp,\n  my_2021_Q2_B_quarter_data_regions_ppp,\n  my_2021_Q3_B_quarter_data_regions_ppp,\n  my_2021_Q4_B_quarter_data_regions_ppp,\n  my_2022_Q1_B_quarter_data_regions_ppp,\n  my_2022_Q2_B_quarter_data_regions_ppp,\n  my_2022_Q3_B_quarter_data_regions_ppp,\n  my_2022_Q4_B_quarter_data_regions_ppp,\n  my_2023_Q1_B_quarter_data_regions_ppp,\n  my_2023_Q2_B_quarter_data_regions_ppp,\n  my_2023_Q3_B_quarter_data_regions_ppp,\n  my_2023_Q4_B_quarter_data_regions_ppp,\n  my_2024_Q1_B_quarter_data_regions_ppp,\n  my_2024_Q2_B_quarter_data_regions_ppp\n)\n\n# Corresponding year and quarter labels for the plots\ner_labels <- c(\n  \"2021 Q1\", \"2021 Q2\", \"2021 Q3\", \"2021 Q4\",\n  \"2022 Q1\", \"2022 Q2\", \"2022 Q3\", \"2022 Q4\",\n  \"2023 Q1\", \"2023 Q2\", \"2023 Q3\", \"2023 Q4\",\n  \"2024 Q1\", \"2024 Q2\"\n)\n\n# Set up the plotting area\npar(mar = c(2,1,2,1))\npar(mfrow=c(4,4))\n\n# Loop through each dataset and create the KDE plots\nfor (i in seq_along(er_datasets)) {\n    G_CK.csr <- envelope(er_datasets[[i]], Gest, nsim = 50, parallel = parallel::detectCores())\n  plot(G_CK.csr, xlim=c(0,10000), main= er_labels[[i]])\n}\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGenerating 50 simulations of CSR  ...\n1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20,\n21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40,\n41, 42, 43, 44, 45, 46, 47, 48, 49, \n50.\n\nDone.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGenerating 50 simulations of CSR  ...\n1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20,\n21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40,\n41, 42, 43, 44, 45, 46, 47, 48, 49, \n50.\n\nDone.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGenerating 50 simulations of CSR  ...\n1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20,\n21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40,\n41, 42, 43, 44, 45, 46, 47, 48, 49, \n50.\n\nDone.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGenerating 50 simulations of CSR  ...\n1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20,\n21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40,\n41, 42, 43, 44, 45, 46, 47, 48, 49, \n50.\n\nDone.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGenerating 50 simulations of CSR  ...\n1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20,\n21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40,\n41, 42, 43, 44, 45, 46, 47, 48, 49, \n50.\n\nDone.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGenerating 50 simulations of CSR  ...\n1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20,\n21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40,\n41, 42, 43, 44, 45, 46, 47, 48, 49, \n50.\n\nDone.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGenerating 50 simulations of CSR  ...\n1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20,\n21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40,\n41, 42, 43, 44, 45, 46, 47, 48, 49, \n50.\n\nDone.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGenerating 50 simulations of CSR  ...\n1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20,\n21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40,\n41, 42, 43, 44, 45, 46, 47, 48, 49, \n50.\n\nDone.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGenerating 50 simulations of CSR  ...\n1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20,\n21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40,\n41, 42, 43, 44, 45, 46, 47, 48, 49, \n50.\n\nDone.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGenerating 50 simulations of CSR  ...\n1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20,\n21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40,\n41, 42, 43, 44, 45, 46, 47, 48, 49, \n50.\n\nDone.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGenerating 50 simulations of CSR  ...\n1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20,\n21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40,\n41, 42, 43, 44, 45, 46, 47, 48, 49, \n50.\n\nDone.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGenerating 50 simulations of CSR  ...\n1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20,\n21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40,\n41, 42, 43, 44, 45, 46, 47, 48, 49, \n50.\n\nDone.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGenerating 50 simulations of CSR  ...\n1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20,\n21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40,\n41, 42, 43, 44, 45, 46, 47, 48, 49, \n50.\n\nDone.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGenerating 50 simulations of CSR  ...\n1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20,\n21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40,\n41, 42, 43, 44, 45, 46, 47, 48, 49, \n50.\n\nDone.\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](Take-home_ex01_files/figure-html/unnamed-chunk-141-1.png){width=1152}\n:::\n:::\n\n\n### Violence against civilians overview\n\n::: {.cell}\n\n```{.r .cell-code}\n# Create a list of all the ER quarter datasets\ner_datasets <- list(\n  my_2021_Q1_VAC_quarter_data_regions_ppp,\n  my_2021_Q2_VAC_quarter_data_regions_ppp,\n  my_2021_Q3_VAC_quarter_data_regions_ppp,\n  my_2021_Q4_VAC_quarter_data_regions_ppp,\n  my_2022_Q1_VAC_quarter_data_regions_ppp,\n  my_2022_Q2_VAC_quarter_data_regions_ppp,\n  my_2022_Q3_VAC_quarter_data_regions_ppp,\n  my_2022_Q4_VAC_quarter_data_regions_ppp,\n  my_2023_Q1_VAC_quarter_data_regions_ppp,\n  my_2023_Q2_VAC_quarter_data_regions_ppp,\n  my_2023_Q3_VAC_quarter_data_regions_ppp,\n  my_2023_Q4_VAC_quarter_data_regions_ppp,\n  my_2024_Q1_VAC_quarter_data_regions_ppp,\n  my_2024_Q2_VAC_quarter_data_regions_ppp\n)\n\n# Corresponding year and quarter labels for the plots\ner_labels <- c(\n  \"2021 Q1\", \"2021 Q2\", \"2021 Q3\", \"2021 Q4\",\n  \"2022 Q1\", \"2022 Q2\", \"2022 Q3\", \"2022 Q4\",\n  \"2023 Q1\", \"2023 Q2\", \"2023 Q3\", \"2023 Q4\",\n  \"2024 Q1\", \"2024 Q2\"\n)\n\n# Set up the plotting area\npar(mar = c(2,1,2,1))\npar(mfrow=c(4,4))\n\n# Loop through each dataset and create the KDE plots\nfor (i in seq_along(er_datasets)) {\n    G_CK.csr <- envelope(er_datasets[[i]], Gest, nsim = 50, parallel = parallel::detectCores())\n  plot(G_CK.csr, xlim=c(0,10000), main= er_labels[[i]])\n}\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGenerating 50 simulations of CSR  ...\n1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20,\n21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40,\n41, 42, 43, 44, 45, 46, 47, 48, 49, \n50.\n\nDone.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGenerating 50 simulations of CSR  ...\n1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20,\n21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40,\n41, 42, 43, 44, 45, 46, 47, 48, 49, \n50.\n\nDone.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGenerating 50 simulations of CSR  ...\n1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20,\n21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40,\n41, 42, 43, 44, 45, 46, 47, 48, 49, \n50.\n\nDone.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGenerating 50 simulations of CSR  ...\n1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20,\n21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40,\n41, 42, 43, 44, 45, 46, 47, 48, 49, \n50.\n\nDone.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGenerating 50 simulations of CSR  ...\n1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20,\n21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40,\n41, 42, 43, 44, 45, 46, 47, 48, 49, \n50.\n\nDone.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGenerating 50 simulations of CSR  ...\n1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20,\n21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40,\n41, 42, 43, 44, 45, 46, 47, 48, 49, \n50.\n\nDone.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGenerating 50 simulations of CSR  ...\n1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20,\n21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40,\n41, 42, 43, 44, 45, 46, 47, 48, 49, \n50.\n\nDone.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGenerating 50 simulations of CSR  ...\n1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20,\n21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40,\n41, 42, 43, 44, 45, 46, 47, 48, 49, \n50.\n\nDone.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGenerating 50 simulations of CSR  ...\n1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20,\n21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40,\n41, 42, 43, 44, 45, 46, 47, 48, 49, \n50.\n\nDone.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGenerating 50 simulations of CSR  ...\n1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20,\n21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40,\n41, 42, 43, 44, 45, 46, 47, 48, 49, \n50.\n\nDone.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGenerating 50 simulations of CSR  ...\n1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20,\n21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40,\n41, 42, 43, 44, 45, 46, 47, 48, 49, \n50.\n\nDone.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGenerating 50 simulations of CSR  ...\n1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20,\n21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40,\n41, 42, 43, 44, 45, 46, 47, 48, 49, \n50.\n\nDone.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGenerating 50 simulations of CSR  ...\n1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20,\n21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40,\n41, 42, 43, 44, 45, 46, 47, 48, 49, \n50.\n\nDone.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGenerating 50 simulations of CSR  ...\n1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20,\n21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40,\n41, 42, 43, 44, 45, 46, 47, 48, 49, \n50.\n\nDone.\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](Take-home_ex01_files/figure-html/unnamed-chunk-142-1.png){width=1152}\n:::\n:::\n\n\n::: {.callout-tip title=\"Note\"}\n**Quarter-wise analysis for all event types:**\n\n-   **2021 Q1**: There is a strong deviation from the CSR, where the empirical G-function lies well above the envelope. This suggests clustering, particularly over the distances considered.\n\n-   **2021 Q2 to 2024 Q2**: Most quarters show a more stable pattern with the empirical G-function generally falling within the simulation envelope or only slightly above it at different distances. This suggests that there is no significant deviation from CSR, implying randomness in the spatial arrangement of points during most of these quarters. In some cases, the curve slightly rises above the envelope, which could indicate mild clustering.\n\n**General Trend:**\nAcross the quarters, the empirical G-function mostly lies within the CSR envelope, indicating a spatial point pattern that does not strongly deviate from randomness. The early quarters show more clustering, but later quarters become more consistent with random spatial distribution.\n:::\n\n\n## **1.7 Determining Spatio-Temporal KDE Layer**\n\n### **1.7.1 Visualising geographic distribution of events by month**\n\n::: {.cell}\n\n```{.r .cell-code}\ntemporal_acled_sf <- acled_sf %>%\n  mutate(q = quarter(event_date))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ntm_shape(regions_sf)+\n  tm_polygons() +\ntm_shape(temporal_acled_sf) +\n  tm_dots() +\ntm_facets(by=\"quarter\", \n            free.coords=FALSE, \n            drop.units = TRUE)\n```\n\n::: {.cell-output-display}\n![](Take-home_ex01_files/figure-html/unnamed-chunk-144-1.png){width=672}\n:::\n:::\n\n### **1.7.2 Deriving Quarterly Spatio-Temporal KDE Layers**\n\n#### **1.7.2.1 Explosions/Remote violence**\n\n::: {.cell}\n\n```{.r .cell-code}\nExample <- \"Explosions/Remote violence\"\nacled_quarters_2021_ppp <- as.ppp(temporal_acled_sf %>%\n  filter(year == 2021 & event_type == Example) %>%\n  select(q))\nacled_quarters_2022_ppp <- as.ppp(temporal_acled_sf %>%\n  filter(year == 2022 & event_type == Example) %>%\n  select(q))\nacled_quarters_2023_ppp <- as.ppp(temporal_acled_sf %>%\n  filter(year == 2023 & event_type == Example) %>%\n  select(q))\nacled_quarters_2024_ppp <- as.ppp(temporal_acled_sf %>%\n  filter(year == 2024 & event_type == Example) %>%\n  select(q))\n```\n:::\n\n\n::: panel-tabset\n## **Year 2021**\n\n::: {.cell}\n\n```{.r .cell-code}\nacled_spatio_ppp_owin <- acled_quarters_2021_ppp[regions_owin]\nst_kde <- spattemp.density(acled_spatio_ppp_owin)\n\ntims <- c(1, 3, 2, 4)\npar(mfcol=c(2,2))\nfor(i in tims){ \n  plot(st_kde, i, \n       override.par=FALSE, \n       fix.range=TRUE, \n       main=paste(\"KDE at 2021 Q\",i))\n}\n```\n\n::: {.cell-output-display}\n![](Take-home_ex01_files/figure-html/unnamed-chunk-146-1.png){width=1152}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nfor(i in tims){\n  png(filename = paste0(\"kde_plots/ER/kde_2021_ER\", i, \".png\"), width = 800, height = 600)\n  \n  plot(st_kde, i, \n       override.par=FALSE, \n       fix.range=TRUE, \n       main=paste(\"KDE at 2021 Q\",i))\n  # Close the PNG device to save the image\n  dev.off()\n}\n```\n:::\n\n## **Year 2022**\n\n::: {.cell}\n\n```{.r .cell-code}\nacled_spatio_ppp_owin <- acled_quarters_2022_ppp[regions_owin]\nst_kde <- spattemp.density(acled_spatio_ppp_owin)\n\ntims <- c(1, 3, 2, 4)\npar(mfcol=c(2,2))\nfor(i in tims){ \n  plot(st_kde, i, \n       override.par=FALSE, \n       fix.range=TRUE, \n       main=paste(\"KDE at 2022 Q\",i))\n}\n```\n\n::: {.cell-output-display}\n![](Take-home_ex01_files/figure-html/unnamed-chunk-148-1.png){width=1152}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nfor(i in tims){\n  png(filename = paste0(\"kde_plots/ER/kde_2022_ER\", i, \".png\"), width = 800, height = 600)\n  \n  plot(st_kde, i, \n       override.par=FALSE, \n       fix.range=TRUE, \n       main=paste(\"KDE at 2022 Q\",i))\n  # Close the PNG device to save the image\n  dev.off()\n}\n```\n:::\n\n## **Year 2023**\n\n::: {.cell}\n\n```{.r .cell-code}\nacled_spatio_ppp_owin <- acled_quarters_2023_ppp[regions_owin]\nst_kde <- spattemp.density(acled_spatio_ppp_owin)\n\ntims <- c(1, 3, 2, 4)\npar(mfcol=c(2,2))\nfor(i in tims){ \n  plot(st_kde, i, \n       override.par=FALSE, \n       fix.range=TRUE, \n       main=paste(\"KDE at 2023 Q\",i))\n}\n```\n\n::: {.cell-output-display}\n![](Take-home_ex01_files/figure-html/unnamed-chunk-150-1.png){width=1152}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nfor(i in tims){\n  png(filename = paste0(\"kde_plots/ER/kde_2023_ER\", i, \".png\"), width = 800, height = 600)\n  \n  plot(st_kde, i, \n       override.par=FALSE, \n       fix.range=TRUE, \n       main=paste(\"KDE at 2023 Q\",i))\n  # Close the PNG device to save the image\n  dev.off()\n}\n```\n:::\n\n## **Year 2024**\n\n::: {.cell}\n\n```{.r .cell-code}\nacled_spatio_ppp_owin <- acled_quarters_2024_ppp[regions_owin]\nst_kde <- spattemp.density(acled_spatio_ppp_owin)\n\ntims <- c(1, 2)\npar(mfrow=c(1,2))\nfor(i in tims){ \n  plot(st_kde, i, \n       override.par=FALSE, \n       fix.range=TRUE, \n       main=paste(\"KDE at 2024 Q\",i))\n}\n```\n\n::: {.cell-output-display}\n![](Take-home_ex01_files/figure-html/unnamed-chunk-152-1.png){width=1152}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nfor(i in tims){\n  png(filename = paste0(\"kde_plots/ER/kde_2024_ER\", i, \".png\"), width = 800, height = 600)\n  \n  plot(st_kde, i, \n       override.par=FALSE, \n       fix.range=TRUE, \n       main=paste(\"KDE at 2024 Q\",i))\n  # Close the PNG device to save the image\n  dev.off()\n}\n```\n:::\n\n:::\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Load images and create a GIF\nkde_images <- list.files(\"kde_plots/ER/\", full.names = TRUE, pattern = \".png\")\nimage_read(kde_images) %>%\n  image_animate(fps = 2)  # Adjust fps (frames per second) for speed\n```\n\n::: {.cell-output-display}\n![](Take-home_ex01_files/figure-html/unnamed-chunk-154-1.gif)\n:::\n:::\n\n\n#### **1.7.2.2 Strategic developments**\n\n::: {.cell}\n\n```{.r .cell-code}\nExample <- \"Strategic developments\"\nacled_quarters_2021_ppp <- as.ppp(temporal_acled_sf %>%\n  filter(year == 2021 & event_type == Example) %>%\n  select(q))\nacled_quarters_2022_ppp <- as.ppp(temporal_acled_sf %>%\n  filter(year == 2022 & event_type == Example) %>%\n  select(q))\nacled_quarters_2023_ppp <- as.ppp(temporal_acled_sf %>%\n  filter(year == 2023 & event_type == Example) %>%\n  select(q))\nacled_quarters_2024_ppp <- as.ppp(temporal_acled_sf %>%\n  filter(year == 2024 & event_type == Example) %>%\n  select(q))\n```\n:::\n\n\n::: panel-tabset\n## **Year 2021**\n\n::: {.cell}\n\n```{.r .cell-code}\nacled_spatio_ppp_owin <- acled_quarters_2021_ppp[regions_owin]\nst_kde <- spattemp.density(acled_spatio_ppp_owin)\n\ntims <- c(1, 3, 2, 4)\npar(mfcol=c(2,2))\nfor(i in tims){ \n  plot(st_kde, i, \n       override.par=FALSE, \n       fix.range=TRUE, \n       main=paste(\"KDE at 2021 Q\",i))\n}\n```\n\n::: {.cell-output-display}\n![](Take-home_ex01_files/figure-html/unnamed-chunk-156-1.png){width=1152}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nfor(i in tims){\n  png(filename = paste0(\"kde_plots/SD/kde_2021_SD\", i, \".png\"), width = 800, height = 600)\n  \n  plot(st_kde, i, \n       override.par=FALSE, \n       fix.range=TRUE, \n       main=paste(\"KDE at 2021 Q\",i))\n  # Close the PNG device to save the image\n  dev.off()\n}\n```\n:::\n\n\n## **Year 2022**\n\n::: {.cell}\n\n```{.r .cell-code}\nacled_spatio_ppp_owin <- acled_quarters_2022_ppp[regions_owin]\nst_kde <- spattemp.density(acled_spatio_ppp_owin)\n\ntims <- c(1, 3, 2, 4)\npar(mfcol=c(2,2))\nfor(i in tims){ \n  plot(st_kde, i, \n       override.par=FALSE, \n       fix.range=TRUE, \n       main=paste(\"KDE at 2022 Q\",i))\n}\n```\n\n::: {.cell-output-display}\n![](Take-home_ex01_files/figure-html/unnamed-chunk-158-1.png){width=1152}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nfor(i in tims){\n  png(filename = paste0(\"kde_plots/SD/kde_2022_SD\", i, \".png\"), width = 800, height = 600)\n  \n  plot(st_kde, i, \n       override.par=FALSE, \n       fix.range=TRUE, \n       main=paste(\"KDE at 2022 Q\",i))\n  # Close the PNG device to save the image\n  dev.off()\n}\n```\n:::\n\n\n## **Year 2023**\n\n::: {.cell}\n\n```{.r .cell-code}\nacled_spatio_ppp_owin <- acled_quarters_2023_ppp[regions_owin]\nst_kde <- spattemp.density(acled_spatio_ppp_owin)\n\ntims <- c(1, 3, 2, 4)\npar(mfcol=c(2,2))\nfor(i in tims){ \n  plot(st_kde, i, \n       override.par=FALSE, \n       fix.range=TRUE, \n       main=paste(\"KDE at 2023 Q\",i))\n}\n```\n\n::: {.cell-output-display}\n![](Take-home_ex01_files/figure-html/unnamed-chunk-160-1.png){width=1152}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nfor(i in tims){\n  png(filename = paste0(\"kde_plots/SD/kde_2023_SD\", i, \".png\"), width = 800, height = 600)\n  \n  plot(st_kde, i, \n       override.par=FALSE, \n       fix.range=TRUE, \n       main=paste(\"KDE at 2023 Q\",i))\n  # Close the PNG device to save the image\n  dev.off()\n}\n```\n:::\n\n\n## **Year 2024**\n\n::: {.cell}\n\n```{.r .cell-code}\nacled_spatio_ppp_owin <- acled_quarters_2024_ppp[regions_owin]\nst_kde <- spattemp.density(acled_spatio_ppp_owin)\n\ntims <- c(1, 2)\npar(mfrow=c(1,2))\nfor(i in tims){ \n  plot(st_kde, i, \n       override.par=FALSE, \n       fix.range=TRUE, \n       main=paste(\"KDE at 2024 Q\",i))\n}\n```\n\n::: {.cell-output-display}\n![](Take-home_ex01_files/figure-html/unnamed-chunk-162-1.png){width=1152}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nfor(i in tims){\n  png(filename = paste0(\"kde_plots/SD/kde_2024_SD\", i, \".png\"), width = 800, height = 600)\n  \n  plot(st_kde, i, \n       override.par=FALSE, \n       fix.range=TRUE, \n       main=paste(\"KDE at 2024 Q\",i))\n  # Close the PNG device to save the image\n  dev.off()\n}\n```\n:::\n\n:::\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Load images and create a GIF\nkde_images <- list.files(\"kde_plots/SD/\", full.names = TRUE, pattern = \".png\")\nimage_read(kde_images) %>%\n  image_animate(fps = 2)  # Adjust fps (frames per second) for speed\n```\n\n::: {.cell-output-display}\n![](Take-home_ex01_files/figure-html/unnamed-chunk-164-1.gif)\n:::\n:::\n\n\n#### **1.7.2.3 Battles**\n\n::: {.cell}\n\n```{.r .cell-code}\nExample <- \"Battles\"\nacled_quarters_2021_ppp <- as.ppp(temporal_acled_sf %>%\n  filter(year == 2021 & event_type == Example) %>%\n  select(q))\nacled_quarters_2022_ppp <- as.ppp(temporal_acled_sf %>%\n  filter(year == 2022 & event_type == Example) %>%\n  select(q))\nacled_quarters_2023_ppp <- as.ppp(temporal_acled_sf %>%\n  filter(year == 2023 & event_type == Example) %>%\n  select(q))\nacled_quarters_2024_ppp <- as.ppp(temporal_acled_sf %>%\n  filter(year == 2024 & event_type == Example) %>%\n  select(q))\n```\n:::\n\n\n::: panel-tabset\n## **Year 2021**\n\n::: {.cell}\n\n```{.r .cell-code}\nacled_spatio_ppp_owin <- acled_quarters_2021_ppp[regions_owin]\nst_kde <- spattemp.density(acled_spatio_ppp_owin)\n\ntims <- c(1, 3, 2, 4)\npar(mfcol=c(2,2))\nfor(i in tims){ \n  plot(st_kde, i, \n       override.par=FALSE, \n       fix.range=TRUE, \n       main=paste(\"KDE at 2021 Q\",i))\n}\n```\n\n::: {.cell-output-display}\n![](Take-home_ex01_files/figure-html/unnamed-chunk-166-1.png){width=1152}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nfor(i in tims){\n  png(filename = paste0(\"kde_plots/B/kde_2021_B\", i, \".png\"), width = 800, height = 600)\n  \n  plot(st_kde, i, \n       override.par=FALSE, \n       fix.range=TRUE, \n       main=paste(\"KDE at 2021 Q\",i))\n  # Close the PNG device to save the image\n  dev.off()\n}\n```\n:::\n\n## **Year 2022**\n\n::: {.cell}\n\n```{.r .cell-code}\nacled_spatio_ppp_owin <- acled_quarters_2022_ppp[regions_owin]\nst_kde <- spattemp.density(acled_spatio_ppp_owin)\n\ntims <- c(1, 3, 2, 4)\npar(mfcol=c(2,2))\nfor(i in tims){ \n  plot(st_kde, i, \n       override.par=FALSE, \n       fix.range=TRUE, \n       main=paste(\"KDE at 2022 Q\",i))\n}\n```\n\n::: {.cell-output-display}\n![](Take-home_ex01_files/figure-html/unnamed-chunk-168-1.png){width=1152}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nfor(i in tims){\n  png(filename = paste0(\"kde_plots/B/kde_2022_B\", i, \".png\"), width = 800, height = 600)\n  \n  plot(st_kde, i, \n       override.par=FALSE, \n       fix.range=TRUE, \n       main=paste(\"KDE at 2022 Q\",i))\n  # Close the PNG device to save the image\n  dev.off()\n}\n```\n:::\n\n## **Year 2023**\n\n::: {.cell}\n\n```{.r .cell-code}\nacled_spatio_ppp_owin <- acled_quarters_2023_ppp[regions_owin]\nst_kde <- spattemp.density(acled_spatio_ppp_owin)\n\ntims <- c(1, 3, 2, 4)\npar(mfcol=c(2,2))\nfor(i in tims){ \n  plot(st_kde, i, \n       override.par=FALSE, \n       fix.range=TRUE, \n       main=paste(\"KDE at 2023 Q\",i))\n}\n```\n\n::: {.cell-output-display}\n![](Take-home_ex01_files/figure-html/unnamed-chunk-170-1.png){width=1152}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nfor(i in tims){\n  png(filename = paste0(\"kde_plots/B/kde_2023_B\", i, \".png\"), width = 800, height = 600)\n  \n  plot(st_kde, i, \n       override.par=FALSE, \n       fix.range=TRUE, \n       main=paste(\"KDE at 2023 Q\",i))\n  # Close the PNG device to save the image\n  dev.off()\n}\n```\n:::\n\n\n## **Year 2024**\n\n::: {.cell}\n\n```{.r .cell-code}\nacled_spatio_ppp_owin <- acled_quarters_2024_ppp[regions_owin]\nst_kde <- spattemp.density(acled_spatio_ppp_owin)\n\ntims <- c(1, 2)\npar(mfrow=c(1,2))\nfor(i in tims){ \n  plot(st_kde, i, \n       override.par=FALSE, \n       fix.range=TRUE, \n       main=paste(\"KDE at 2024 Q\",i))\n}\n```\n\n::: {.cell-output-display}\n![](Take-home_ex01_files/figure-html/unnamed-chunk-172-1.png){width=1152}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nfor(i in tims){\n  png(filename = paste0(\"kde_plots/B/kde_2024_B\", i, \".png\"), width = 800, height = 600)\n  \n  plot(st_kde, i, \n       override.par=FALSE, \n       fix.range=TRUE, \n       main=paste(\"KDE at 2024 Q\",i))\n  # Close the PNG device to save the image\n  dev.off()\n}\n```\n:::\n\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Load images and create a GIF\nkde_images <- list.files(\"kde_plots/B/\", full.names = TRUE, pattern = \".png\")\nimage_read(kde_images) %>%\n  image_animate(fps = 2)  # Adjust fps (frames per second) for speed\n```\n\n::: {.cell-output-display}\n![](Take-home_ex01_files/figure-html/unnamed-chunk-174-1.gif)\n:::\n:::\n\n\n#### **1.7.2.4 Explosions/Remote violence**\n\n::: {.cell}\n\n```{.r .cell-code}\nExample <- \"Explosions/Remote violence\"\nacled_quarters_2021_ppp <- as.ppp(temporal_acled_sf %>%\n  filter(year == 2021 & event_type == Example) %>%\n  select(q))\nacled_quarters_2022_ppp <- as.ppp(temporal_acled_sf %>%\n  filter(year == 2022 & event_type == Example) %>%\n  select(q))\nacled_quarters_2023_ppp <- as.ppp(temporal_acled_sf %>%\n  filter(year == 2023 & event_type == Example) %>%\n  select(q))\nacled_quarters_2024_ppp <- as.ppp(temporal_acled_sf %>%\n  filter(year == 2024 & event_type == Example) %>%\n  select(q))\n```\n:::\n\n\n::: panel-tabset\n## **Year 2021**\n\n::: {.cell}\n\n```{.r .cell-code}\nacled_spatio_ppp_owin <- acled_quarters_2021_ppp[regions_owin]\nst_kde <- spattemp.density(acled_spatio_ppp_owin)\n\ntims <- c(1, 3, 2, 4)\npar(mfcol=c(2,2))\nfor(i in tims){ \n  plot(st_kde, i, \n       override.par=FALSE, \n       fix.range=TRUE, \n       main=paste(\"KDE at 2021 Q\",i))\n}\n```\n\n::: {.cell-output-display}\n![](Take-home_ex01_files/figure-html/unnamed-chunk-176-1.png){width=1152}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nfor(i in tims){\n  png(filename = paste0(\"kde_plots/VAC/kde_2021_VAC\", i, \".png\"), width = 800, height = 600)\n  \n  plot(st_kde, i, \n       override.par=FALSE, \n       fix.range=TRUE, \n       main=paste(\"KDE at 2021 Q\",i))\n  # Close the PNG device to save the image\n  dev.off()\n}\n```\n:::\n\n\n## **Year 2022**\n\n::: {.cell}\n\n```{.r .cell-code}\nacled_spatio_ppp_owin <- acled_quarters_2022_ppp[regions_owin]\nst_kde <- spattemp.density(acled_spatio_ppp_owin)\n\ntims <- c(1, 3, 2, 4)\npar(mfcol=c(2,2))\nfor(i in tims){ \n  plot(st_kde, i, \n       override.par=FALSE, \n       fix.range=TRUE, \n       main=paste(\"KDE at 2022 Q\",i))\n}\n```\n\n::: {.cell-output-display}\n![](Take-home_ex01_files/figure-html/unnamed-chunk-178-1.png){width=1152}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nfor(i in tims){\n  png(filename = paste0(\"kde_plots/VAC/kde_2022_VAC\", i, \".png\"), width = 800, height = 600)\n  \n  plot(st_kde, i, \n       override.par=FALSE, \n       fix.range=TRUE, \n       main=paste(\"KDE at 2022 Q\",i))\n  # Close the PNG device to save the image\n  dev.off()\n}\n```\n:::\n\n## **Year 2023**\n\n::: {.cell}\n\n```{.r .cell-code}\nacled_spatio_ppp_owin <- acled_quarters_2023_ppp[regions_owin]\nst_kde <- spattemp.density(acled_spatio_ppp_owin)\n\ntims <- c(1, 3, 2, 4)\npar(mfcol=c(2,2))\nfor(i in tims){ \n  plot(st_kde, i, \n       override.par=FALSE, \n       fix.range=TRUE, \n       main=paste(\"KDE at 2023 Q\",i))\n}\n```\n\n::: {.cell-output-display}\n![](Take-home_ex01_files/figure-html/unnamed-chunk-180-1.png){width=1152}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nfor(i in tims){\n  png(filename = paste0(\"kde_plots/VAC/kde_2023_VAC\", i, \".png\"), width = 800, height = 600)\n  \n  plot(st_kde, i, \n       override.par=FALSE, \n       fix.range=TRUE, \n       main=paste(\"KDE at 2023 Q\",i))\n  # Close the PNG device to save the image\n  dev.off()\n}\n```\n:::\n\n## **Year 2024**\n\n::: {.cell}\n\n```{.r .cell-code}\nacled_spatio_ppp_owin <- acled_quarters_2024_ppp[regions_owin]\nst_kde <- spattemp.density(acled_spatio_ppp_owin)\n\ntims <- c(1, 2)\npar(mfrow=c(1,2))\nfor(i in tims){ \n  plot(st_kde, i, \n       override.par=FALSE, \n       fix.range=TRUE, \n       main=paste(\"KDE at 2024 Q\",i))\n}\n```\n\n::: {.cell-output-display}\n![](Take-home_ex01_files/figure-html/unnamed-chunk-182-1.png){width=1152}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nfor(i in tims){\n  png(filename = paste0(\"kde_plots/VAC/kde_2024_VAC\", i, \".png\"), width = 800, height = 600)\n  \n  plot(st_kde, i, \n       override.par=FALSE, \n       fix.range=TRUE, \n       main=paste(\"KDE at 2024 Q\",i))\n  # Close the PNG device to save the image\n  dev.off()\n}\n```\n:::\n\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Load images and create a GIF\nkde_images <- list.files(\"kde_plots/VAC/\", full.names = TRUE, pattern = \".png\")\nimage_read(kde_images) %>%\n  image_animate(fps = 2)  # Adjust fps (frames per second) for speed\n```\n\n::: {.cell-output-display}\n![](Take-home_ex01_files/figure-html/unnamed-chunk-184-1.gif)\n:::\n:::\n\n\n## **1.8 2nd-Order Spatio-temporal Point Patterns Analysis**\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}