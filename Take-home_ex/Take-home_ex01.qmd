---
title: "Take-home Exercise 1: Geospatial Analytics for Social Good: Application of Spatial and Spatio-temporal Point Patterns Analysis to discover the geographical distribution of Armed Conflict in Myanmar"
author: "Brian Lim"
date: "September 8, 2024"
date-modified: "last-modified"
categories:
  - Analysis
  - R
  - sf
  - tidyverse
  - raster
  - spatstat
  - tmap
  - tidyverse
format: html
editor: visual
execute: 
  eval: true
  echo: true
  warning: false
  freeze: true
  cache: true
---

## **1.1 Exercise Overview**

Millions of people have their lives shattered by armed conflict – wars – every year.

Armed conflict has been on the rise since about 2012, after a decline in the 1990s and early 2000s. First came conflicts in Libya, Syria and Yemen, triggered by the 2011 Arab uprisings. Libya’s instability spilled south, helping set off a protracted crisis in the Sahel region. A fresh wave of major combat followed: the 2020 Azerbaijani-Armenian war over the Nagorno-Karabakh enclave, horrific fighting in Ethiopia’s northern Tigray region that began weeks later, the conflict prompted by the Myanmar army’s 2021 power grab and Russia’s 2022 assault on Ukraine. Add to those 2023’s devastation in Sudan and Gaza. Around the globe, more people are dying in fighting, being forced from their homes or in need of life-saving aid than in decades.

In this study, I will apply spatial point patterns analysis methods to discover the spatial and spatio-temporal distribution of armed conflict in Myanmar.

## **1.2 Data Acquisition**

The data sets that we will be using are the following: - Armed conflict data of Myanmar between 2021-2024. This data can be downloaded from Armed Conflict Location & Event Data [ACLED](https://acleddata.com/analysis/), an independent, impartial, international non-profit organization collecting data on violent conflict and protest in all countries and territories in the world, should be used. - The shapefile of the Myanmar State and Region Boundaries with Sub-regions. This data can be downloaded from [Myanmar Information Management Unit, MIMU](https://geonode.themimu.info/layers/geonode%3Ammr_polbnda2_adm1_250k_mimu_1).

## **1.3 Getting Started**

For this exercise, the following R packages will be used:

-   [**sf**](https://cran.r-project.org/web/packages/sf/) for handling geospatial data.

-   [**spatstat**](https://spatstat.org/), a comprehensive package for point pattern analysis. We'll use it to perform first- and second-order spatial point pattern analyses and to derive kernel density estimation (KDE) layers.

-   [**raster**](https://cran.r-project.org/web/packages/raster/), a package for reading, writing, manipulating, and modeling gridded spatial data (rasters). We will use it to convert image outputs generated by spatstat into raster format.

-   [**tmap**](https://cran.r-project.org/web/packages/tmap/index.html), a package for creating high-quality static and interactive maps, leveraging the Leaflet API for interactive visualizations.

-   [**tidyverse**](https://www.tidyverse.org/) for performing data science tasks such as importing, wrangling and visualising data.

-   [**RColorBrewer**](https://cran.r-project.org/web/packages/RColorBrewer/RColorBrewer.pdf) for creating nice looking color palettes especially for thematic maps.

As readr, tidyr and dplyr are part of tidyverse package. The code chunk below will suffice to install and load the required packages in RStudio.

To install and load these packages into the R environment, we use the `p_load` function from the `pacman` package:

```{r}
pacman::p_load(sf, raster, spatstat, tmap, tidyverse, RColorBrewer, lubridate, ggplot2, parallel, sparr, magick)
```

## **1.4 Importing Data into R**

Next, we will import the `ACLED-Southeast_Asia-Myanmar(1).csv` file into the R environment and save it into an R dataframe called `acled_sf`. The task can be performed using the `read_csv()` function from the readr package, as shown below:

```{r}
acled_sf <- read_csv("data/ACLED-Southeast_Asia-Myanmar(1).csv") %>% 
  st_as_sf(coords = c(
    "longitude", "latitude"), crs = 4326) %>% 
  st_transform(crs= 32647)%>%
  mutate(event_date = dmy(event_date)) %>%
  mutate(quarter = paste0(year, " Q", quarter(event_date)))
```

::: {.callout-tip title="Notes"}
We used the `mutate()` function to ensure that the **event_data** column is in the right format of `dmy()`, while also creating a **quarter** column to represent the current <year and quarter> that the row belongs to
:::

We can check the validity of the imported dataset, ensuring that it is in the right format with the `st_crs()` and `summary()` function:

```{r}
st_crs(acled_sf)
```

```{r}
summary(acled_sf)
```

We then import the boundaries and regions of Myanmar using the `st_read()` function to import the *mmr_polbnda2_adm1_250k_mimu_1* shapefile into R as a simple feature data frame named `regions_sf`:

```{r}
regions_sf <- st_read(dsn = "data/myanmar", 
                layer = "mmr_polbnda2_adm1_250k_mimu_1")
regions_sf <- st_transform(regions_sf, crs = 32647)
```

::: {.callout-tip title="Notes"}
The `acled_sf` and `regions_sf data` are being transformed to **EPSG 32647**, which corresponds to **UTM Zone 47N**. This CSR is fine for Myanmar. This consistency also ensures that the UTM zone transformation makes sense for the study area, and prevents any distortion in KDE results.
:::

After importing the boundary and region data, we can check that what was imported is correct by checking the summary and plotting the views:

::: panel-tabset
## Summary

```{r}
summary(regions_sf)
```

## Detailed Regional View

```{r, fig.width=12, fig.height=12}
num_colors <- length(unique(regions_sf$ST))
colors <- brewer.pal(n = num_colors, name = "Set1")

tm_shape(regions_sf) +
  tm_polygons(col = "ST", palette = colors) +
  tm_text("ST", size = 0.9, col = "black", bg.color = "white", 
          just = c("center", "center"), xmod = 0, ymod = 0) +
  tm_layout(main.title = "Region and Boundaries in Myanmar",
            main.title.position = "center",
            main.title.size = 1.6,
            legend.outside = TRUE,
            frame = TRUE) +
  tm_legend(title = "Sub-regions")
```
:::

### **1.4.1 Focused Event Types**

For the study, we focus on the following four event types from the ACLED dataset for Myanmar:

-   **Battles**

-   **Strategic developments**

-   **Violence against civilians**

-   **Explosion/Remote violence**

The study period spans from **January 2021 to June 2024**, broken down into **quarterly** intervals. We aim to visualize and analyze the spatial distribution of these armed conflict events in Myanmar.

The following function is used to generate spatial point pattern plots for each event type within the defined region throughout the stated time span:

```{r}
# Function to create combined events object with owin object
plot_event_by_quarter <- function(event_data, event_name) {
  quarter_data_ppp <- as.ppp(st_coordinates(event_data), st_bbox(event_data))
  regions_owin <- as.owin(regions_sf)
  quarter_data_regions_ppp = quarter_data_ppp[regions_owin]
  
  plot(quarter_data_regions_ppp,
     main = paste("Events in Myanmar -", event_name, "(2021 - 2024)"),
     xlab = "Longitude", ylab = "Latitude")
}
```

```{r}
# Get a list of unique quarters
events <- unique(acled_sf$event_type)

# Loop over each quarter and generate the plot
map(events, ~ {
  event_data <- acled_sf %>% filter(event_type == .x)
  plot_event_by_quarter(event_data, .x)
})
```

### **1.4.2 Storing key data**

We will store key data sets intermittently to keep track of key data.

```{r}
write_rds(acled_sf, "data/rds/acled_sf.rds")
write_rds(regions_sf, "data/rds/regions_sf.rds")
```

## **1.5 Determining KDE Layer**

### **1.5.1 Choosing Sample Dataset**

In this section, we focus on determining the appropriate Kernel Density Estimate (KDE) layer format for analyzing the spatial distribution of events across different quarters and event types. KDE is a fundamental tool for identifying patterns of spatial clustering and dispersion, providing a smooth surface that highlights areas of high and low event concentration. The selection of an appropriate bandwidth is crucial, as it influences the level of detail and accuracy in the density estimate. By standardizing the KDE layer format, we aim to ensure consistency and comparability throughout the analysis, particularly using the **Violence against civilians** event type as a reference for refining our approach.

```{r}
Example <- "Violence against civilians"
acled_2021 <- acled_sf %>%
  filter(event_type == Example & year == 2021)
year_data <- as_Spatial(acled_2021)
regions <- as_Spatial(regions_sf)

year_data_sp <- as(year_data, "SpatialPoints")
regions_sp <- as(regions, "SpatialPolygons")

year_data_ppp <- as.ppp(st_coordinates(acled_2021), st_bbox(acled_2021))
year_data_ppp
```

```{r}
any(duplicated(year_data_ppp))
```

As there are duplicate points, we will use jittering to slightly displace the points so that overlapping points are separated on the map. The `jitter` parameter will slightly move each point by a small, random amount. This can help to visually separate points that are in the same space.

```{r}
year_data_ppp_jit <- rjitter(year_data_ppp, 
                             retry=TRUE, 
                             nsim=1, 
                             drop=TRUE)
any(duplicated(year_data_ppp_jit))
```

### **1.5.2 Creating Owin Object**

To confine analysis to a geographical area, convert the `SpatialPolygon` object to an `owin` object of `spatstat`:

```{r}
regions_owin <- as.owin(regions_sf)

year_data_regions_ppp = year_data_ppp_jit[regions_owin]
```

```{r}
plot(year_data_regions_ppp)
```

Due to the size of Myanmar, rescaling would need to be done:

```{r}
year_data_regions_ppp.km <- rescale.ppp(year_data_regions_ppp, 50000, "km")
```

### **1.5.3 Working With Different Automatic Bandwidth Methods**

The `density()` function from the `spatstat` package computes the kernel density estimate for a given set of spatial point events, providing insights into the spatial distribution of those events.

-   **`bw.diggle()`**: This method selects the bandwidth (σ) by minimizing the mean-square error, as defined by Diggle (1985). The mean-square error measures the average squared difference between the estimated and actual values, aiming to reduce errors in the density estimate.

-   **`bw.CvL()`**: Cronie and van Lieshout’s method selects the bandwidth by minimizing the discrepancy between the area of the observation window and the sum of reciprocal estimated intensity values at the event points. It balances the observed points and the space they occupy, capturing the underlying point process effectively.

-   **`bw.scott()`**: Scott’s rule, a fast and computationally efficient method, calculates the bandwidth proportional to $(n^{-\frac{1}{d+4}})$, where (n) is the number of points and (d) the spatial dimensions. It typically produces a larger bandwidth and is ideal for detecting gradual trends.

-   **`bw.ppl()`**: This method selects the bandwidth through likelihood cross-validation, maximizing the point process likelihood to provide the best-fitting model for the observed data, particularly when the goal is to optimize the likelihood of the given event distribution.

```{r}
bw_CvL <- bw.CvL(year_data_regions_ppp.km)
bw_CvL
```

```{r}
bw_scott <- bw.scott(year_data_regions_ppp.km)
bw_scott
```

```{r}
bw_ppl <- bw.ppl(year_data_regions_ppp.km)
bw_ppl
```

```{r}
bw_diggle <- bw.diggle(year_data_regions_ppp.km)
bw_diggle
```

```{r}
kde_diggle <- density(year_data_regions_ppp.km, bw_diggle)
kde_CvL <- density(year_data_regions_ppp.km, bw_CvL)
kde_scott <- density(year_data_regions_ppp.km, bw_scott)
kde_ppl <- density(year_data_regions_ppp.km, bw_ppl)

par(mar = c(2, 2, 2, 2),mfrow = c(2,2))
plot(kde_diggle, main = "kde_diggle")
plot(kde_CvL, main = "kde_CvL")
plot(kde_scott, main = "kde_scott")
plot(kde_ppl, main = "kde_ppl")
```

```{r}
par(mar = c(2,2,2,2),mfrow = c(2,2))
hist(kde_diggle, main = "kde_diggle")
hist(kde_CvL, main = "kde_CvL")
hist(kde_scott, main = "kde_scott")
hist(kde_ppl, main = "kde_ppl")
```

::: {.callout-tip title="Reflection"}
Bandwidth Selection Comparison for KDE:

-   **kde_diggle**: The sharp peak at the beginning indicates that the Diggle method for bandwidth selection has identified a concentrated cluster of points in the initial bin. The remaining bins show little to no concentration, suggesting a significant level of spatial clustering in one specific area within the observation window. This method may highlight a localized, high-intensity clustering effect.

-   **kde_CvL**: The left-skewed, more balanced distribution suggests that the CvL method is identifying a broader range of spatial concentrations. However, the smaller bin sizes smooth out finer details, which could mask important aspects of the point pattern. This method provides a more generalized view of the distribution but at the cost of losing granular insights.

-   **kde_scott**: The wider range of values and the absence of a sharp peak, compared to kde_diggle, indicates that the Scott method is capturing both highly dense clusters and moderately concentrated areas. This makes it more suitable for capturing variations in spatial concentration across different regions.

-   **kde_ppl**: Similar to the Diggle method, kde_ppl shows a sharp peak, suggesting the presence of a high concentration of points in a specific region. This points to a localized cluster, but with a similar potential risk of missing broader patterns in the dataset.
:::

```{r}
dse_diggle <- density(year_data_regions_ppp.km, bw_diggle, se=TRUE)$SE
dse_CvL <- density(year_data_regions_ppp.km, bw_CvL, se=TRUE)$SE
dse_scott <- density(year_data_regions_ppp.km, bw_scott, se=TRUE)$SE
dse_ppl <- density(year_data_regions_ppp.km, bw_ppl, se=TRUE)$SE
```

```{r}
par(mar = c(2,2,2,2),mfrow = c(2,2))
plot(dse_diggle,main = "standard error_diggle")
plot(dse_CvL,main = "standard error_CvL")
plot(dse_scott,main = "standard error_scott")
plot(dse_ppl,main = "standard error_ppl")
```

::: {.callout-tip title="Reflection"}
Consideration of Standard Error:

While the standard error (SE) of the density estimate provides valuable insight into the uncertainty associated with each density estimate, it is not the primary focus of this analysis. The shape of the density estimate, rather than its absolute value, is more critical when analyzing spatial patterns. Consequently, the SE was not used as a key criterion for bandwidth selection in this analysis.

Consideration of Standard Error: While the standard error (SE) of the density estimate provides valuable insight into the uncertainty associated with each density estimate, it is not the primary focus of this analysis. The shape of the density estimate, rather than its absolute value, is more critical when analyzing spatial patterns. Consequently, the SE was not used as a key criterion for bandwidth selection in this analysis.
:::

### **1.5.4 Final Bandwidth Selection**

Upon the exploration of various fixed bandwidth selection methods for computing KDE vales, and subsequent plotting of the respective KDE estimates, their distributions and associated standard errors, we will now select the KDE bandwidth to be used in our analysis.

We landed on the `bw_scott` method for further analysis. This is because:

1.  `bw_scott` method provides a pair of bandwidth values for each coordinate axis. This allows it to capture the different levels of spatial clustering in each direction more accurately.
2.  `bw_scott` method capture the balance between bias and variance the best among all methods. If the bandwidth is too small, the estimate may be too skewed (high variance). The distribution histograms of KDE layers using `bw_diggle` and `bw_ppl` tend to indicate such nature. On the other hand, if the bandwidth is too large, the estimate may be over smoothed, missing crucial elements of the point pattern (high bias). This is what we observed in the distribution histogram of KDE layer using `bw_CvL`.

Since we have chosen to use `bw_scott` method, now we will plot the KDE layer using this method for further analysis.

#### **1.5.4.1 Working With Different Kernel Methods**

Beyond the Gaussian kernel, three other kernels can be used to compute KDE: - Epanechnikov - Quartic - Disc

```{r}
par(mfrow=c(2,2), mar=c(1, 1, 1, 1), cex=0.5)
plot(density(year_data_regions_ppp.km, 
             sigma=bw_scott, 
             edge=TRUE, 
             kernel="gaussian"), 
     main="Gaussian")
plot(density(year_data_regions_ppp.km, 
             sigma=bw_scott, 
             edge=TRUE, 
             kernel="epanechnikov"), 
     main="Epanechnikov")
plot(density(year_data_regions_ppp.km, 
             sigma=bw_scott, 
             edge=TRUE, 
             kernel="quartic"), 
     main="Quartic")
plot(density(year_data_regions_ppp.km, 
             sigma=bw_scott, 
             edge=TRUE, 
             kernel="disc"), 
     main="Disc")
```

::: {.callout-tip title="Reflection"}
Upon comparing the outputs of different kernel functions **(Gaussian, Epanechnikov, Quartic, Disc)**, we observed that the resulting density estimates were very similar across all kernels. Given the minimal variation, the choice of kernel is not critical for this particular analysis.

We opted for the **Gaussian** kernel as it is widely used in kernel density estimation and tends to produce smooth, continuous estimates. Its flexibility in capturing both sharp peaks and gradual trends makes it a reasonable default choice, especially when the differences between kernels are negligible, as seen here.
:::

```{r,fig.width=12, fig.height=12}
kde_fixed_scott <- density(year_data_regions_ppp.km, bw_scott)
plot(kde_fixed_scott,main = "Fixed bandwidth KDE (Using bw_scott)")
contour(kde_fixed_scott, add=TRUE)
```

However, upon visual inspection, there are signs of a certain degree of over-smoothing when directly applying the bandwidth provided by the `bw_scott` method. While automatic bandwidth selection methods offer a useful starting point, further fine-tuning is often necessary to ensure the accuracy of the KDE plot.

To address the over-smoothing, we will apply a "rule of thumb" adjustment by dividing the bandwidth value by 2. This reduction in bandwidth size will help minimize the over-smoothing effect and enhance the precision of the spatial point pattern analysis.

```{r,fig.width=12, fig.height=12}
kde_year_data_regions_fixed_scott <- density(year_data_regions_ppp.km, bw_scott/2)
kde_year_data_regions_adaptive <- adaptive.density(year_data_regions_ppp.km, method="kernel")

par(mfrow=c(1,2))
plot(kde_year_data_regions_fixed_scott, main = "Fixed Bandwidth (bw_scott)")
plot(kde_year_data_regions_adaptive, main = "Adaptive Bandwidth")
```

#### **1.5.4.2 Plotting Interactive KDE Maps**

```{r}
raster_kde_fixed_scott <- raster(kde_year_data_regions_fixed_scott)
raster_kde_adaptive_kernel <- raster(kde_year_data_regions_adaptive)

# Set the correct CRS for the raster (EPSG:32647)
projection(raster_kde_fixed_scott) <- CRS("+init=EPSG:32647 +units=km")
projection(raster_kde_adaptive_kernel) <- CRS("+init=EPSG:32647 +units=km")

```

```{r, fig.height=12, fig.width=12}
#| eval: false
tmap_mode('view')

kde_fixed_scott <- tm_basemap(server = "OpenStreetMap") +
  tm_basemap(server = "Esri.WorldImagery") +
  tm_shape(raster_kde_fixed_scott) +
  tm_raster("layer",
            n = 10,
            title = "KDE_Fixed_scott",
            alpha = 0.6,
            palette = c("#fafac3","#fd953b","#f02a75","#b62385","#021c9e")) +
  tm_shape(regions_sf) +  # Transform only for visualization
  tm_polygons(alpha=0.1, id="ST_PCODE") +
  tmap_options(check.and.fix = TRUE)

kde_adaptive_kernel <- tm_basemap(server = "OpenStreetMap") +
  tm_basemap(server = "Esri.WorldImagery") +
  tm_shape(raster_kde_adaptive_kernel) +
  tm_raster("layer",
            n = 7,
            title = "KDE_Adaptive_Kernel",
            style = "pretty",
            alpha = 0.6,
            palette = c("#fafac3","#fd953b","#f02a75","#b62385","#021c9e")) +
  tm_shape(regions_sf) +  # Transform only for visualization
  tm_polygons(alpha=0.1, id="ST_PCODE") +
  tmap_options(check.and.fix = TRUE)

tmap_arrange(kde_fixed_scott, kde_adaptive_kernel, ncol=1, nrow=2, sync = TRUE)
```

::: {.callout-tip title="Reflection"}
After comparing the two approaches for kernel density estimation, Fixed Bandwidth using `bw_scott/2` and `Adaptive Bandwidth`, we observed that the fixed bandwidth method provides a more stable and interpretable result across the observation window. While adaptive bandwidth is designed to adjust to local point densities and capture finer details, it can sometimes introduce unnecessary complexity and overfit the density estimate, especially in areas with sparse data.

Given the goals of our analysis, which emphasize consistency and smoothness over high local sensitivity, the Fixed Bandwidth approach strikes a better balance between capturing spatial trends and avoiding over-complication.
:::

#### **1.5.4.3 Viewing Quarterly KDE Maps**

### **Year 2021**

#### **Quarter 1**

::: panel-tabset
## Explosions/Remote violence

```{r}
Example <- "Explosions/Remote violence"
my_2021_Q1 <- acled_sf  %>%
  filter(event_type == Example & quarter == "2021 Q1")

write_rds(my_2021_Q1, "data/rds/my_2021_Q1_ER_quarter_data_regions_sf.rds")

quarter_data <- as_Spatial(my_2021_Q1)
quarter_data_sp <- as(quarter_data, "SpatialPoints")
quarter_data_ppp <- as.ppp(st_coordinates(my_2021_Q1), st_bbox(my_2021_Q1))

quarter_data_ppp_jit <- rjitter(quarter_data_ppp, 
                             retry=TRUE, 
                             nsim=1, 
                             drop=TRUE)
```

```{r,fig.width=12, fig.height=12}
my_2021_Q1_ER_quarter_data_regions_ppp = quarter_data_ppp_jit[regions_owin]
quarter_data_regions_ppp.km <- rescale.ppp(my_2021_Q1_ER_quarter_data_regions_ppp, 50000, "km")

bw_scott <- bw.scott(quarter_data_regions_ppp.km)

plot(density(quarter_data_regions_ppp.km, 
             sigma=bw_scott/2, 
             edge=TRUE, 
             kernel="gaussian"), 
     main = "2021 Q1 - Explosion/Remote violence")
```

## Strategic developments

```{r}
Example <- "Strategic developments"
my_2021_Q1 <- acled_sf  %>%
  filter(event_type == Example & quarter == "2021 Q1")

write_rds(my_2021_Q1, "data/rds/my_2021_Q1_SD_quarter_data_regions_sf.rds")

quarter_data <- as_Spatial(my_2021_Q1)
quarter_data_sp <- as(quarter_data, "SpatialPoints")
quarter_data_ppp <- as.ppp(st_coordinates(my_2021_Q1), st_bbox(my_2021_Q1))

quarter_data_ppp_jit <- rjitter(quarter_data_ppp, 
                             retry=TRUE, 
                             nsim=1, 
                             drop=TRUE)
```

```{r,fig.width=12, fig.height=12}
my_2021_Q1_SD_quarter_data_regions_ppp = quarter_data_ppp_jit[regions_owin]
quarter_data_regions_ppp.km <- rescale.ppp(my_2021_Q1_SD_quarter_data_regions_ppp , 50000, "km")

bw_scott <- bw.scott(quarter_data_regions_ppp.km)

plot(density(quarter_data_regions_ppp.km, 
             sigma=bw_scott/2, 
             edge=TRUE, 
             kernel="gaussian"), 
     main = "2021 Q1 - Strategic developments")
```

## Battles

```{r}
Example <- "Battles"
my_2021_Q1 <- acled_sf  %>%
  filter(event_type == Example & quarter == "2021 Q1")

write_rds(my_2021_Q1, "data/rds/my_2021_Q1_B_quarter_data_regions_sf.rds")

quarter_data <- as_Spatial(my_2021_Q1)
quarter_data_sp <- as(quarter_data, "SpatialPoints")
quarter_data_ppp <- as.ppp(st_coordinates(my_2021_Q1), st_bbox(my_2021_Q1))

quarter_data_ppp_jit <- rjitter(quarter_data_ppp, 
                             retry=TRUE, 
                             nsim=1, 
                             drop=TRUE)
```

```{r,fig.width=12, fig.height=12}
my_2021_Q1_B_quarter_data_regions_ppp = quarter_data_ppp_jit[regions_owin]
quarter_data_regions_ppp.km <- rescale.ppp(my_2021_Q1_B_quarter_data_regions_ppp, 50000, "km")

bw_scott <- bw.scott(quarter_data_regions_ppp.km)

plot(density(quarter_data_regions_ppp.km, 
             sigma=bw_scott/2, 
             edge=TRUE, 
             kernel="gaussian"), 
     main = "2021 Q1 - Battles")
```

## Violence against civilians

```{r}
Example <- "Violence against civilians"
my_2021_Q1 <- acled_sf  %>%
  filter(event_type == Example & quarter == "2021 Q1")

write_rds(my_2021_Q1, "data/rds/my_2021_Q1_VAC_quarter_data_regions_sf.rds")

quarter_data <- as_Spatial(my_2021_Q1)
quarter_data_sp <- as(quarter_data, "SpatialPoints")
quarter_data_ppp <- as.ppp(st_coordinates(my_2021_Q1), st_bbox(my_2021_Q1))

quarter_data_ppp_jit <- rjitter(quarter_data_ppp, 
                             retry=TRUE, 
                             nsim=1, 
                             drop=TRUE)
```

```{r,fig.width=12, fig.height=12}
my_2021_Q1_VAC_quarter_data_regions_ppp = quarter_data_ppp_jit[regions_owin]
quarter_data_regions_ppp.km <- rescale.ppp(my_2021_Q1_VAC_quarter_data_regions_ppp, 50000, "km")

bw_scott <- bw.scott(quarter_data_regions_ppp.km)

plot(density(quarter_data_regions_ppp.km, 
             sigma=bw_scott/2, 
             edge=TRUE, 
             kernel="gaussian"), 
     main = "2021 Q1 -Violence against civilians")
```
:::

#### **Quarter 2**

::: panel-tabset
## Explosions/Remote violence

```{r}
Example <- "Explosions/Remote violence"
my_2021_Q2 <- acled_sf  %>%
  filter(event_type == Example & quarter == "2021 Q2")

write_rds(my_2021_Q2, "data/rds/my_2021_Q2_ER_quarter_data_regions_sf.rds")

quarter_data <- as_Spatial(my_2021_Q2)
quarter_data_sp <- as(quarter_data, "SpatialPoints")
quarter_data_ppp <- as.ppp(st_coordinates(my_2021_Q2), st_bbox(my_2021_Q2))

quarter_data_ppp_jit <- rjitter(quarter_data_ppp, 
                             retry=TRUE, 
                             nsim=1, 
                             drop=TRUE)
```

```{r,fig.width=12, fig.height=12}
my_2021_Q2_ER_quarter_data_regions_ppp = quarter_data_ppp_jit[regions_owin]
quarter_data_regions_ppp.km <- rescale.ppp(my_2021_Q2_ER_quarter_data_regions_ppp, 50000, "km")

bw_scott <- bw.scott(quarter_data_regions_ppp.km)

plot(density(quarter_data_regions_ppp.km, 
             sigma=bw_scott/2, 
             edge=TRUE, 
             kernel="gaussian"), 
     main = "2021 Q2 - Explosion/Remote violence")
```

## Strategic developments

```{r}
Example <- "Strategic developments"
my_2021_Q2 <- acled_sf  %>%
  filter(event_type == Example & quarter == "2021 Q2")

write_rds(my_2021_Q2, "data/rds/my_2021_Q2_SD_quarter_data_regions_sf.rds")

quarter_data <- as_Spatial(my_2021_Q2)
quarter_data_sp <- as(quarter_data, "SpatialPoints")
quarter_data_ppp <- as.ppp(st_coordinates(my_2021_Q2), st_bbox(my_2021_Q2))

quarter_data_ppp_jit <- rjitter(quarter_data_ppp, 
                             retry=TRUE, 
                             nsim=1, 
                             drop=TRUE)
```

```{r,fig.width=12, fig.height=12}
my_2021_Q2_SD_quarter_data_regions_ppp = quarter_data_ppp_jit[regions_owin]
quarter_data_regions_ppp.km <- rescale.ppp(my_2021_Q2_SD_quarter_data_regions_ppp, 50000, "km")

bw_scott <- bw.scott(quarter_data_regions_ppp.km)

plot(density(quarter_data_regions_ppp.km, 
             sigma=bw_scott/2, 
             edge=TRUE, 
             kernel="gaussian"), 
     main = "2021 Q2 - Strategic developments")
```

## Battles

```{r}
Example <- "Battles"
my_2021_Q2 <- acled_sf  %>%
  filter(event_type == Example & quarter == "2021 Q2")

write_rds(my_2021_Q2, "data/rds/my_2021_Q2_B_quarter_data_regions_sf.rds")

quarter_data <- as_Spatial(my_2021_Q2)
quarter_data_sp <- as(quarter_data, "SpatialPoints")
quarter_data_ppp <- as.ppp(st_coordinates(my_2021_Q2), st_bbox(my_2021_Q2))

quarter_data_ppp_jit <- rjitter(quarter_data_ppp, 
                             retry=TRUE, 
                             nsim=1, 
                             drop=TRUE)
```

```{r,fig.width=12, fig.height=12}
my_2021_Q2_B_quarter_data_regions_ppp = quarter_data_ppp_jit[regions_owin]
quarter_data_regions_ppp.km <- rescale.ppp(my_2021_Q2_B_quarter_data_regions_ppp, 50000, "km")

bw_scott <- bw.scott(quarter_data_regions_ppp.km)

plot(density(quarter_data_regions_ppp.km, 
             sigma=bw_scott/2, 
             edge=TRUE, 
             kernel="gaussian"), 
     main = "2021 Q2 - Battles")
```

## Violence against civilians

```{r}
Example <- "Violence against civilians"
my_2021_Q2 <- acled_sf  %>%
  filter(event_type == Example & quarter == "2021 Q2")

write_rds(my_2021_Q2, "data/rds/my_2021_Q2_VAC_quarter_data_regions_sf.rds")

quarter_data <- as_Spatial(my_2021_Q2)
quarter_data_sp <- as(quarter_data, "SpatialPoints")
quarter_data_ppp <- as.ppp(st_coordinates(my_2021_Q2), st_bbox(my_2021_Q2))

quarter_data_ppp_jit <- rjitter(quarter_data_ppp, 
                             retry=TRUE, 
                             nsim=1, 
                             drop=TRUE)
```

```{r,fig.width=12, fig.height=12}
my_2021_Q2_VAC_quarter_data_regions_ppp = quarter_data_ppp_jit[regions_owin]
quarter_data_regions_ppp.km <- rescale.ppp(my_2021_Q2_VAC_quarter_data_regions_ppp, 50000, "km")

bw_scott <- bw.scott(quarter_data_regions_ppp.km)

plot(density(quarter_data_regions_ppp.km, 
             sigma=bw_scott/2, 
             edge=TRUE, 
             kernel="gaussian"), 
     main = "2021 Q2 - Violence against civilians")
```
:::

#### **Quarter 3**

::: panel-tabset
## Explosions/Remote violence

```{r}
Example <- "Explosions/Remote violence"
my_2021_Q3 <- acled_sf  %>%
  filter(event_type == Example & quarter == "2021 Q3")

write_rds(my_2021_Q3, "data/rds/my_2021_Q3_ER_quarter_data_regions_sf.rds")

quarter_data <- as_Spatial(my_2021_Q3)
quarter_data_sp <- as(quarter_data, "SpatialPoints")
quarter_data_ppp <- as.ppp(st_coordinates(my_2021_Q3), st_bbox(my_2021_Q3))

quarter_data_ppp_jit <- rjitter(quarter_data_ppp, 
                             retry=TRUE, 
                             nsim=1, 
                             drop=TRUE)
```

```{r,fig.width=12, fig.height=12}
my_2021_Q3_ER_quarter_data_regions_ppp = quarter_data_ppp_jit[regions_owin]
quarter_data_regions_ppp.km <- rescale.ppp(my_2021_Q3_ER_quarter_data_regions_ppp, 50000, "km")

bw_scott <- bw.scott(quarter_data_regions_ppp.km)

plot(density(quarter_data_regions_ppp.km, 
             sigma=bw_scott/2, 
             edge=TRUE, 
             kernel="gaussian"), 
     main = "2021 Q3 - Explosion/Remote violence")
```

## Strategic developments

```{r}
Example <- "Strategic developments"
my_2021_Q3 <- acled_sf  %>%
  filter(event_type == Example & quarter == "2021 Q3")

write_rds(my_2021_Q3, "data/rds/my_2021_Q3_SD_quarter_data_regions_sf.rds")

quarter_data <- as_Spatial(my_2021_Q3)
quarter_data_sp <- as(quarter_data, "SpatialPoints")
quarter_data_ppp <- as.ppp(st_coordinates(my_2021_Q3), st_bbox(my_2021_Q3))

quarter_data_ppp_jit <- rjitter(quarter_data_ppp, 
                             retry=TRUE, 
                             nsim=1, 
                             drop=TRUE)
```

```{r,fig.width=12, fig.height=12}
my_2021_Q3_SD_quarter_data_regions_ppp = quarter_data_ppp_jit[regions_owin]
quarter_data_regions_ppp.km <- rescale.ppp(my_2021_Q3_SD_quarter_data_regions_ppp, 50000, "km")

bw_scott <- bw.scott(quarter_data_regions_ppp.km)

plot(density(quarter_data_regions_ppp.km, 
             sigma=bw_scott/2, 
             edge=TRUE, 
             kernel="gaussian"), 
     main = "2021 Q3 - Strategic developments")
```

## Battles

```{r}
Example <- "Battles"
my_2021_Q3 <- acled_sf  %>%
  filter(event_type == Example & quarter == "2021 Q3")

write_rds(my_2021_Q3, "data/rds/my_2021_Q3_B_quarter_data_regions_sf.rds")

quarter_data <- as_Spatial(my_2021_Q3)
quarter_data_sp <- as(quarter_data, "SpatialPoints")
quarter_data_ppp <- as.ppp(st_coordinates(my_2021_Q3), st_bbox(my_2021_Q3))

quarter_data_ppp_jit <- rjitter(quarter_data_ppp, 
                             retry=TRUE, 
                             nsim=1, 
                             drop=TRUE)
```

```{r,fig.width=12, fig.height=12}
my_2021_Q3_B_quarter_data_regions_ppp = quarter_data_ppp_jit[regions_owin]
quarter_data_regions_ppp.km <- rescale.ppp(my_2021_Q3_B_quarter_data_regions_ppp, 50000, "km")

bw_scott <- bw.scott(quarter_data_regions_ppp.km)

plot(density(quarter_data_regions_ppp.km, 
             sigma=bw_scott/2, 
             edge=TRUE, 
             kernel="gaussian"), 
     main = "2021 Q3 - Battles")
```

## Violence against civilians

```{r}
Example <- "Violence against civilians"
my_2021_Q3 <- acled_sf  %>%
  filter(event_type == Example & quarter == "2021 Q3")

write_rds(my_2021_Q3, "data/rds/my_2021_Q3_VAC_quarter_data_regions_sf.rds")

quarter_data <- as_Spatial(my_2021_Q3)
quarter_data_sp <- as(quarter_data, "SpatialPoints")
quarter_data_ppp <- as.ppp(st_coordinates(my_2021_Q3), st_bbox(my_2021_Q3))

quarter_data_ppp_jit <- rjitter(quarter_data_ppp, 
                             retry=TRUE, 
                             nsim=1, 
                             drop=TRUE)
```

```{r,fig.width=12, fig.height=12}
my_2021_Q3_VAC_quarter_data_regions_ppp = quarter_data_ppp_jit[regions_owin]
quarter_data_regions_ppp.km <- rescale.ppp(my_2021_Q3_VAC_quarter_data_regions_ppp, 50000, "km")

bw_scott <- bw.scott(quarter_data_regions_ppp.km)

plot(density(quarter_data_regions_ppp.km, 
             sigma=bw_scott/2, 
             edge=TRUE, 
             kernel="gaussian"), 
     main = "2021 Q3 - Violence against civilians")
```
:::

#### **Quarter 4**

::: panel-tabset
## Explosions/Remote violence

```{r}
Example <- "Explosions/Remote violence"
my_2021_Q4 <- acled_sf  %>%
  filter(event_type == Example & quarter == "2021 Q4")

write_rds(my_2021_Q4, "data/rds/my_2021_Q4_ER_quarter_data_regions_sf.rds")

quarter_data <- as_Spatial(my_2021_Q4)
quarter_data_sp <- as(quarter_data, "SpatialPoints")
quarter_data_ppp <- as.ppp(st_coordinates(my_2021_Q4), st_bbox(my_2021_Q4))

quarter_data_ppp_jit <- rjitter(quarter_data_ppp, 
                             retry=TRUE, 
                             nsim=1, 
                             drop=TRUE)
```

```{r,fig.width=12, fig.height=12}
my_2021_Q4_ER_quarter_data_regions_ppp = quarter_data_ppp_jit[regions_owin]
quarter_data_regions_ppp.km <- rescale.ppp(my_2021_Q4_ER_quarter_data_regions_ppp, 50000, "km")

bw_scott <- bw.scott(quarter_data_regions_ppp.km)

plot(density(quarter_data_regions_ppp.km, 
             sigma=bw_scott/2, 
             edge=TRUE, 
             kernel="gaussian"), 
     main = "2021 Q4 - Explosion/Remote violence")
```

## Strategic developments

```{r}
Example <- "Strategic developments"
my_2021_Q4 <- acled_sf  %>%
  filter(event_type == Example & quarter == "2021 Q4")

write_rds(my_2021_Q4, "data/rds/my_2021_Q4_SD_quarter_data_regions_sf.rds")

quarter_data <- as_Spatial(my_2021_Q4)
quarter_data_sp <- as(quarter_data, "SpatialPoints")
quarter_data_ppp <- as.ppp(st_coordinates(my_2021_Q4), st_bbox(my_2021_Q4))

quarter_data_ppp_jit <- rjitter(quarter_data_ppp, 
                             retry=TRUE, 
                             nsim=1, 
                             drop=TRUE)
```

```{r,fig.width=12, fig.height=12}
my_2021_Q4_SD_quarter_data_regions_ppp = quarter_data_ppp_jit[regions_owin]
quarter_data_regions_ppp.km <- rescale.ppp(my_2021_Q4_SD_quarter_data_regions_ppp, 50000, "km")

bw_scott <- bw.scott(quarter_data_regions_ppp.km)

plot(density(quarter_data_regions_ppp.km, 
             sigma=bw_scott/2, 
             edge=TRUE, 
             kernel="gaussian"), 
     main = "2021 Q4 - Strategic developments")
```

## Battles

```{r}
Example <- "Battles"
my_2021_Q4 <- acled_sf  %>%
  filter(event_type == Example & quarter == "2021 Q4")

write_rds(my_2021_Q4, "data/rds/my_2021_Q4_B_quarter_data_regions_sf.rds")

quarter_data <- as_Spatial(my_2021_Q4)
quarter_data_sp <- as(quarter_data, "SpatialPoints")
quarter_data_ppp <- as.ppp(st_coordinates(my_2021_Q4), st_bbox(my_2021_Q4))

quarter_data_ppp_jit <- rjitter(quarter_data_ppp, 
                             retry=TRUE, 
                             nsim=1, 
                             drop=TRUE)
```

```{r,fig.width=12, fig.height=12}
my_2021_Q4_B_quarter_data_regions_ppp = quarter_data_ppp_jit[regions_owin]
quarter_data_regions_ppp.km <- rescale.ppp(my_2021_Q4_B_quarter_data_regions_ppp, 50000, "km")

bw_scott <- bw.scott(quarter_data_regions_ppp.km)

plot(density(quarter_data_regions_ppp.km, 
             sigma=bw_scott/2, 
             edge=TRUE, 
             kernel="gaussian"), 
     main = "2021 Q4 - Battles")
```

## Violence against civilians

```{r}
Example <- "Violence against civilians"
my_2021_Q4 <- acled_sf  %>%
  filter(event_type == Example & quarter == "2021 Q4")

write_rds(my_2021_Q4, "data/rds/my_2021_Q4_VAC_quarter_data_regions_sf.rds")

quarter_data <- as_Spatial(my_2021_Q4)
quarter_data_sp <- as(quarter_data, "SpatialPoints")
quarter_data_ppp <- as.ppp(st_coordinates(my_2021_Q4), st_bbox(my_2021_Q4))

quarter_data_ppp_jit <- rjitter(quarter_data_ppp, 
                             retry=TRUE, 
                             nsim=1, 
                             drop=TRUE)
```

```{r,fig.width=12, fig.height=12}
my_2021_Q4_VAC_quarter_data_regions_ppp = quarter_data_ppp_jit[regions_owin]
quarter_data_regions_ppp.km <- rescale.ppp(my_2021_Q4_VAC_quarter_data_regions_ppp, 50000, "km")

bw_scott <- bw.scott(quarter_data_regions_ppp.km)

plot(density(quarter_data_regions_ppp.km, 
             sigma=bw_scott/2, 
             edge=TRUE, 
             kernel="gaussian"), 
     main = "2021 Q4 - Violence against civilians")
```
:::

### **Year 2022**

#### **Quarter 1**

::: panel-tabset
## Explosions/Remote violence

```{r}
Example <- "Explosions/Remote violence"
my_2022_Q1 <- acled_sf  %>%
  filter(event_type == Example & quarter == "2022 Q1")

write_rds(my_2022_Q1, "data/rds/my_2022_Q1_ER_quarter_data_regions_sf.rds")

quarter_data <- as_Spatial(my_2022_Q1)
quarter_data_sp <- as(quarter_data, "SpatialPoints")
quarter_data_ppp <- as.ppp(st_coordinates(my_2022_Q1), st_bbox(my_2022_Q1))

quarter_data_ppp_jit <- rjitter(quarter_data_ppp, 
                             retry=TRUE, 
                             nsim=1, 
                             drop=TRUE)
```

```{r,fig.width=12, fig.height=12}
my_2022_Q1_ER_quarter_data_regions_ppp = quarter_data_ppp_jit[regions_owin]
quarter_data_regions_ppp.km <- rescale.ppp(my_2022_Q1_ER_quarter_data_regions_ppp, 50000, "km")

bw_scott <- bw.scott(quarter_data_regions_ppp.km)

plot(density(quarter_data_regions_ppp.km, 
             sigma=bw_scott/2, 
             edge=TRUE, 
             kernel="gaussian"), 
     main = "2022 Q1 - Explosion/Remote violence")
```

## Strategic developments

```{r}
Example <- "Strategic developments"
my_2022_Q1 <- acled_sf  %>%
  filter(event_type == Example & quarter == "2022 Q1")

write_rds(my_2022_Q1, "data/rds/my_2022_Q1_SD_quarter_data_regions_sf.rds")

quarter_data <- as_Spatial(my_2022_Q1)
quarter_data_sp <- as(quarter_data, "SpatialPoints")
quarter_data_ppp <- as.ppp(st_coordinates(my_2022_Q1), st_bbox(my_2022_Q1))

quarter_data_ppp_jit <- rjitter(quarter_data_ppp, 
                             retry=TRUE, 
                             nsim=1, 
                             drop=TRUE)
```

```{r,fig.width=12, fig.height=12}
my_2022_Q1_SD_quarter_data_regions_ppp = quarter_data_ppp_jit[regions_owin]
quarter_data_regions_ppp.km <- rescale.ppp(my_2022_Q1_SD_quarter_data_regions_ppp, 50000, "km")

bw_scott <- bw.scott(quarter_data_regions_ppp.km)

plot(density(quarter_data_regions_ppp.km, 
             sigma=bw_scott/2, 
             edge=TRUE, 
             kernel="gaussian"), 
     main = "2022 Q1 - Strategic developments")
```

## Battles

```{r}
Example <- "Battles"
my_2022_Q1 <- acled_sf  %>%
  filter(event_type == Example & quarter == "2022 Q1")

write_rds(my_2022_Q1, "data/rds/my_2022_Q1_B_quarter_data_regions_sf.rds")

quarter_data <- as_Spatial(my_2022_Q1)
quarter_data_sp <- as(quarter_data, "SpatialPoints")
quarter_data_ppp <- as.ppp(st_coordinates(my_2022_Q1), st_bbox(my_2022_Q1))

quarter_data_ppp_jit <- rjitter(quarter_data_ppp, 
                             retry=TRUE, 
                             nsim=1, 
                             drop=TRUE)
```

```{r,fig.width=12, fig.height=12}
my_2022_Q1_B_quarter_data_regions_ppp = quarter_data_ppp_jit[regions_owin]
quarter_data_regions_ppp.km <- rescale.ppp(my_2022_Q1_B_quarter_data_regions_ppp, 50000, "km")

bw_scott <- bw.scott(quarter_data_regions_ppp.km)

plot(density(quarter_data_regions_ppp.km, 
             sigma=bw_scott/2, 
             edge=TRUE, 
             kernel="gaussian"), 
     main = "2022 Q1 - Battles")
```

## Violence against civilians

```{r}
Example <- "Violence against civilians"
my_2022_Q1 <- acled_sf  %>%
  filter(event_type == Example & quarter == "2022 Q1")

write_rds(my_2022_Q1, "data/rds/my_2022_Q1_VAC_quarter_data_regions_sf.rds")

quarter_data <- as_Spatial(my_2022_Q1)
quarter_data_sp <- as(quarter_data, "SpatialPoints")
quarter_data_ppp <- as.ppp(st_coordinates(my_2022_Q1), st_bbox(my_2022_Q1))

quarter_data_ppp_jit <- rjitter(quarter_data_ppp, 
                             retry=TRUE, 
                             nsim=1, 
                             drop=TRUE)
```

```{r,fig.width=12, fig.height=12}
my_2022_Q1_VAC_quarter_data_regions_ppp = quarter_data_ppp_jit[regions_owin]
quarter_data_regions_ppp.km <- rescale.ppp(my_2022_Q1_VAC_quarter_data_regions_ppp, 50000, "km")

bw_scott <- bw.scott(quarter_data_regions_ppp.km)

plot(density(quarter_data_regions_ppp.km, 
             sigma=bw_scott/2, 
             edge=TRUE, 
             kernel="gaussian"), 
     main = "2022 Q1 -Violence against civilians")
```
:::

#### **Quarter 2**

::: panel-tabset
## Explosions/Remote violence

```{r}
Example <- "Explosions/Remote violence"
my_2022_Q2 <- acled_sf  %>%
  filter(event_type == Example & quarter == "2022 Q2")

write_rds(my_2022_Q2, "data/rds/my_2022_Q2_ER_quarter_data_regions_sf.rds")

quarter_data <- as_Spatial(my_2022_Q2)
quarter_data_sp <- as(quarter_data, "SpatialPoints")
quarter_data_ppp <- as.ppp(st_coordinates(my_2022_Q2), st_bbox(my_2022_Q2))

quarter_data_ppp_jit <- rjitter(quarter_data_ppp, 
                             retry=TRUE, 
                             nsim=1, 
                             drop=TRUE)
```

```{r,fig.width=12, fig.height=12}
my_2022_Q2_ER_quarter_data_regions_ppp = quarter_data_ppp_jit[regions_owin]
quarter_data_regions_ppp.km <- rescale.ppp(my_2022_Q2_ER_quarter_data_regions_ppp, 50000, "km")

bw_scott <- bw.scott(quarter_data_regions_ppp.km)

plot(density(quarter_data_regions_ppp.km, 
             sigma=bw_scott/2, 
             edge=TRUE, 
             kernel="gaussian"), 
     main = "2022 Q2 - Explosion/Remote violence")
```

## Strategic developments

```{r}
Example <- "Strategic developments"
my_2022_Q2 <- acled_sf  %>%
  filter(event_type == Example & quarter == "2022 Q2")

write_rds(my_2022_Q2, "data/rds/my_2022_Q2_SD_quarter_data_regions_sf.rds")

quarter_data <- as_Spatial(my_2022_Q2)
quarter_data_sp <- as(quarter_data, "SpatialPoints")
quarter_data_ppp <- as.ppp(st_coordinates(my_2022_Q2), st_bbox(my_2022_Q2))

quarter_data_ppp_jit <- rjitter(quarter_data_ppp, 
                             retry=TRUE, 
                             nsim=1, 
                             drop=TRUE)
```

```{r,fig.width=12, fig.height=12}
my_2022_Q2_SD_quarter_data_regions_ppp = quarter_data_ppp_jit[regions_owin]
quarter_data_regions_ppp.km <- rescale.ppp(my_2022_Q2_SD_quarter_data_regions_ppp, 50000, "km")

bw_scott <- bw.scott(quarter_data_regions_ppp.km)

plot(density(quarter_data_regions_ppp.km, 
             sigma=bw_scott/2, 
             edge=TRUE, 
             kernel="gaussian"), 
     main = "2022 Q2 - Strategic developments")
```

## Battles

```{r}
Example <- "Battles"
my_2022_Q2 <- acled_sf  %>%
  filter(event_type == Example & quarter == "2022 Q2")

write_rds(my_2022_Q2, "data/rds/my_2022_Q2_B_quarter_data_regions_sf.rds")

quarter_data <- as_Spatial(my_2022_Q2)
quarter_data_sp <- as(quarter_data, "SpatialPoints")
quarter_data_ppp <- as.ppp(st_coordinates(my_2022_Q2), st_bbox(my_2022_Q2))

quarter_data_ppp_jit <- rjitter(quarter_data_ppp, 
                             retry=TRUE, 
                             nsim=1, 
                             drop=TRUE)
```

```{r,fig.width=12, fig.height=12}
my_2022_Q2_B_quarter_data_regions_ppp = quarter_data_ppp_jit[regions_owin]
quarter_data_regions_ppp.km <- rescale.ppp(my_2022_Q2_B_quarter_data_regions_ppp, 50000, "km")

bw_scott <- bw.scott(quarter_data_regions_ppp.km)

plot(density(quarter_data_regions_ppp.km, 
             sigma=bw_scott/2, 
             edge=TRUE, 
             kernel="gaussian"), 
     main = "2022 Q2 - Battles")
```

## Violence against civilians

```{r}
Example <- "Violence against civilians"
my_2022_Q2 <- acled_sf  %>%
  filter(event_type == Example & quarter == "2022 Q2")

write_rds(my_2022_Q2, "data/rds/my_2022_Q2_VAC_quarter_data_regions_sf.rds")

quarter_data <- as_Spatial(my_2022_Q2)
quarter_data_sp <- as(quarter_data, "SpatialPoints")
quarter_data_ppp <- as.ppp(st_coordinates(my_2022_Q2), st_bbox(my_2022_Q2))

quarter_data_ppp_jit <- rjitter(quarter_data_ppp, 
                             retry=TRUE, 
                             nsim=1, 
                             drop=TRUE)
```

```{r,fig.width=12, fig.height=12}
my_2022_Q2_VAC_quarter_data_regions_ppp = quarter_data_ppp_jit[regions_owin]
quarter_data_regions_ppp.km <- rescale.ppp(my_2022_Q2_VAC_quarter_data_regions_ppp, 50000, "km")

bw_scott <- bw.scott(quarter_data_regions_ppp.km)

plot(density(quarter_data_regions_ppp.km, 
             sigma=bw_scott/2, 
             edge=TRUE, 
             kernel="gaussian"), 
     main = "2022 Q2 - Violence against civilians")
```
:::

#### **Quarter 3**

::: panel-tabset
## Explosions/Remote violence

```{r}
Example <- "Explosions/Remote violence"
my_2022_Q3 <- acled_sf  %>%
  filter(event_type == Example & quarter == "2022 Q3")

write_rds(my_2022_Q3, "data/rds/my_2022_Q3_ER_quarter_data_regions_sf.rds")

quarter_data <- as_Spatial(my_2022_Q3)
quarter_data_sp <- as(quarter_data, "SpatialPoints")
quarter_data_ppp <- as.ppp(st_coordinates(my_2022_Q3), st_bbox(my_2022_Q3))

quarter_data_ppp_jit <- rjitter(quarter_data_ppp, 
                             retry=TRUE, 
                             nsim=1, 
                             drop=TRUE)
```

```{r,fig.width=12, fig.height=12}
my_2022_Q3_ER_quarter_data_regions_ppp = quarter_data_ppp_jit[regions_owin]
quarter_data_regions_ppp.km <- rescale.ppp(my_2022_Q3_ER_quarter_data_regions_ppp, 50000, "km")

bw_scott <- bw.scott(quarter_data_regions_ppp.km)

plot(density(quarter_data_regions_ppp.km, 
             sigma=bw_scott/2, 
             edge=TRUE, 
             kernel="gaussian"), 
     main = "2022 Q3 - Explosion/Remote violence")
```

## Strategic developments

```{r}
Example <- "Strategic developments"
my_2022_Q3 <- acled_sf  %>%
  filter(event_type == Example & quarter == "2022 Q3")

write_rds(my_2022_Q3, "data/rds/my_2022_Q3_SD_quarter_data_regions_sf.rds")

quarter_data <- as_Spatial(my_2022_Q3)
quarter_data_sp <- as(quarter_data, "SpatialPoints")
quarter_data_ppp <- as.ppp(st_coordinates(my_2022_Q3), st_bbox(my_2022_Q3))

quarter_data_ppp_jit <- rjitter(quarter_data_ppp, 
                             retry=TRUE, 
                             nsim=1, 
                             drop=TRUE)
```

```{r,fig.width=12, fig.height=12}
my_2022_Q3_SD_quarter_data_regions_ppp = quarter_data_ppp_jit[regions_owin]
quarter_data_regions_ppp.km <- rescale.ppp(my_2022_Q3_SD_quarter_data_regions_ppp, 50000, "km")

bw_scott <- bw.scott(quarter_data_regions_ppp.km)

plot(density(quarter_data_regions_ppp.km, 
             sigma=bw_scott/2, 
             edge=TRUE, 
             kernel="gaussian"), 
     main = "2022 Q3 - Strategic developments")
```

## Battles

```{r}
Example <- "Battles"
my_2022_Q3 <- acled_sf  %>%
  filter(event_type == Example & quarter == "2022 Q3")

write_rds(my_2022_Q3, "data/rds/my_2022_Q3_B_quarter_data_regions_sf.rds")

quarter_data <- as_Spatial(my_2022_Q3)
quarter_data_sp <- as(quarter_data, "SpatialPoints")
quarter_data_ppp <- as.ppp(st_coordinates(my_2022_Q3), st_bbox(my_2022_Q3))

quarter_data_ppp_jit <- rjitter(quarter_data_ppp, 
                             retry=TRUE, 
                             nsim=1, 
                             drop=TRUE)
```

```{r,fig.width=12, fig.height=12}
my_2022_Q3_B_quarter_data_regions_ppp = quarter_data_ppp_jit[regions_owin]
quarter_data_regions_ppp.km <- rescale.ppp(my_2022_Q3_B_quarter_data_regions_ppp, 50000, "km")

bw_scott <- bw.scott(quarter_data_regions_ppp.km)

plot(density(quarter_data_regions_ppp.km, 
             sigma=bw_scott/2, 
             edge=TRUE, 
             kernel="gaussian"), 
     main = "2022 Q3 - Battles")
```

## Violence against civilians

```{r}
Example <- "Violence against civilians"
my_2022_Q3 <- acled_sf  %>%
  filter(event_type == Example & quarter == "2022 Q3")

write_rds(my_2022_Q3, "data/rds/my_2022_Q3_VAC_quarter_data_regions_sf.rds")

quarter_data <- as_Spatial(my_2022_Q3)
quarter_data_sp <- as(quarter_data, "SpatialPoints")
quarter_data_ppp <- as.ppp(st_coordinates(my_2022_Q3), st_bbox(my_2022_Q3))

quarter_data_ppp_jit <- rjitter(quarter_data_ppp, 
                             retry=TRUE, 
                             nsim=1, 
                             drop=TRUE)
```

```{r,fig.width=12, fig.height=12}
my_2022_Q3_VAC_quarter_data_regions_ppp = quarter_data_ppp_jit[regions_owin]
quarter_data_regions_ppp.km <- rescale.ppp(my_2022_Q3_VAC_quarter_data_regions_ppp, 50000, "km")

bw_scott <- bw.scott(quarter_data_regions_ppp.km)

plot(density(quarter_data_regions_ppp.km, 
             sigma=bw_scott/2, 
             edge=TRUE, 
             kernel="gaussian"), 
     main = "2022 Q3 - Violence against civilians")
```
:::

#### **Quarter 4**

::: panel-tabset
## Explosions/Remote violence

```{r}
Example <- "Explosions/Remote violence"
my_2022_Q4 <- acled_sf  %>%
  filter(event_type == Example & quarter == "2022 Q4")

write_rds(my_2022_Q4, "data/rds/my_2022_Q4_ER_quarter_data_regions_sf.rds")

quarter_data <- as_Spatial(my_2022_Q4)
quarter_data_sp <- as(quarter_data, "SpatialPoints")
quarter_data_ppp <- as.ppp(st_coordinates(my_2022_Q4), st_bbox(my_2022_Q4))

quarter_data_ppp_jit <- rjitter(quarter_data_ppp, 
                             retry=TRUE, 
                             nsim=1, 
                             drop=TRUE)
```

```{r,fig.width=12, fig.height=12}
my_2022_Q4_ER_quarter_data_regions_ppp = quarter_data_ppp_jit[regions_owin]
quarter_data_regions_ppp.km <- rescale.ppp(my_2022_Q4_ER_quarter_data_regions_ppp, 50000, "km")

bw_scott <- bw.scott(quarter_data_regions_ppp.km)

plot(density(quarter_data_regions_ppp.km, 
             sigma=bw_scott/2, 
             edge=TRUE, 
             kernel="gaussian"), 
     main = "2022 Q4 - Explosion/Remote violence")
```

## Strategic developments

```{r}
Example <- "Strategic developments"
my_2022_Q4 <- acled_sf  %>%
  filter(event_type == Example & quarter == "2022 Q4")

write_rds(my_2022_Q4, "data/rds/my_2022_Q4_SD_quarter_data_regions_sf.rds")

quarter_data <- as_Spatial(my_2022_Q4)
quarter_data_sp <- as(quarter_data, "SpatialPoints")
quarter_data_ppp <- as.ppp(st_coordinates(my_2022_Q4), st_bbox(my_2022_Q4))

quarter_data_ppp_jit <- rjitter(quarter_data_ppp, 
                             retry=TRUE, 
                             nsim=1, 
                             drop=TRUE)
```

```{r,fig.width=12, fig.height=12}
my_2022_Q4_SD_quarter_data_regions_ppp = quarter_data_ppp_jit[regions_owin]
quarter_data_regions_ppp.km <- rescale.ppp(my_2022_Q4_SD_quarter_data_regions_ppp, 50000, "km")

bw_scott <- bw.scott(quarter_data_regions_ppp.km)

plot(density(quarter_data_regions_ppp.km, 
             sigma=bw_scott/2, 
             edge=TRUE, 
             kernel="gaussian"), 
     main = "2022 Q4 - Strategic developments")
```

## Battles

```{r}
Example <- "Battles"
my_2022_Q4 <- acled_sf  %>%
  filter(event_type == Example & quarter == "2022 Q4")

write_rds(my_2022_Q4, "data/rds/my_2022_Q4_B_quarter_data_regions_sf.rds")

quarter_data <- as_Spatial(my_2022_Q4)
quarter_data_sp <- as(quarter_data, "SpatialPoints")
quarter_data_ppp <- as.ppp(st_coordinates(my_2022_Q4), st_bbox(my_2022_Q4))

quarter_data_ppp_jit <- rjitter(quarter_data_ppp, 
                             retry=TRUE, 
                             nsim=1, 
                             drop=TRUE)
```

```{r,fig.width=12, fig.height=12}
my_2022_Q4_B_quarter_data_regions_ppp = quarter_data_ppp_jit[regions_owin]
quarter_data_regions_ppp.km <- rescale.ppp(my_2022_Q4_B_quarter_data_regions_ppp, 50000, "km")

bw_scott <- bw.scott(quarter_data_regions_ppp.km)

plot(density(quarter_data_regions_ppp.km, 
             sigma=bw_scott/2, 
             edge=TRUE, 
             kernel="gaussian"), 
     main = "2022 Q4 - Battles")
```

## Violence against civilians

```{r}
Example <- "Violence against civilians"
my_2022_Q4 <- acled_sf  %>%
  filter(event_type == Example & quarter == "2022 Q4")

write_rds(my_2022_Q4, "data/rds/my_2022_Q4_VAC_quarter_data_regions_sf.rds")

quarter_data <- as_Spatial(my_2022_Q4)
quarter_data_sp <- as(quarter_data, "SpatialPoints")
quarter_data_ppp <- as.ppp(st_coordinates(my_2022_Q4), st_bbox(my_2022_Q4))

quarter_data_ppp_jit <- rjitter(quarter_data_ppp, 
                             retry=TRUE, 
                             nsim=1, 
                             drop=TRUE)
```

```{r,fig.width=12, fig.height=12}
my_2022_Q4_VAC_quarter_data_regions_ppp = quarter_data_ppp_jit[regions_owin]
quarter_data_regions_ppp.km <- rescale.ppp(my_2022_Q4_VAC_quarter_data_regions_ppp, 50000, "km")

bw_scott <- bw.scott(quarter_data_regions_ppp.km)

plot(density(quarter_data_regions_ppp.km, 
             sigma=bw_scott/2, 
             edge=TRUE, 
             kernel="gaussian"), 
     main = "2022 Q4 - Violence against civilians")
```
:::

### **Year 2023**

#### **Quarter 1**

::: panel-tabset
## Explosions/Remote violence

```{r}
Example <- "Explosions/Remote violence"
my_2023_Q1 <- acled_sf  %>%
  filter(event_type == Example & quarter == "2023 Q1")

write_rds(my_2023_Q1, "data/rds/my_2023_Q1_ER_quarter_data_regions_sf.rds")

quarter_data <- as_Spatial(my_2023_Q1)
quarter_data_sp <- as(quarter_data, "SpatialPoints")
quarter_data_ppp <- as.ppp(st_coordinates(my_2023_Q1), st_bbox(my_2023_Q1))

quarter_data_ppp_jit <- rjitter(quarter_data_ppp, 
                             retry=TRUE, 
                             nsim=1, 
                             drop=TRUE)
```

```{r,fig.width=12, fig.height=12}
my_2023_Q1_ER_quarter_data_regions_ppp = quarter_data_ppp_jit[regions_owin]
quarter_data_regions_ppp.km <- rescale.ppp(my_2023_Q1_ER_quarter_data_regions_ppp, 50000, "km")

bw_scott <- bw.scott(quarter_data_regions_ppp.km)

plot(density(quarter_data_regions_ppp.km, 
             sigma=bw_scott/2, 
             edge=TRUE, 
             kernel="gaussian"), 
     main = "2023 Q1 - Explosion/Remote violence")
```

## Strategic developments

```{r}
Example <- "Strategic developments"
my_2023_Q1 <- acled_sf  %>%
  filter(event_type == Example & quarter == "2023 Q1")

write_rds(my_2023_Q1, "data/rds/my_2023_Q1_SD_quarter_data_regions_sf.rds")

quarter_data <- as_Spatial(my_2023_Q1)
quarter_data_sp <- as(quarter_data, "SpatialPoints")
quarter_data_ppp <- as.ppp(st_coordinates(my_2023_Q1), st_bbox(my_2023_Q1))

quarter_data_ppp_jit <- rjitter(quarter_data_ppp, 
                             retry=TRUE, 
                             nsim=1, 
                             drop=TRUE)
```

```{r,fig.width=12, fig.height=12}
my_2023_Q1_SD_quarter_data_regions_ppp = quarter_data_ppp_jit[regions_owin]
quarter_data_regions_ppp.km <- rescale.ppp(my_2023_Q1_SD_quarter_data_regions_ppp, 50000, "km")

bw_scott <- bw.scott(quarter_data_regions_ppp.km)

plot(density(quarter_data_regions_ppp.km, 
             sigma=bw_scott/2, 
             edge=TRUE, 
             kernel="gaussian"), 
     main = "2023 Q1 - Strategic developments")
```

## Battles

```{r}
Example <- "Battles"
my_2023_Q1 <- acled_sf  %>%
  filter(event_type == Example & quarter == "2023 Q1")

write_rds(my_2023_Q1, "data/rds/my_2023_Q1_B_quarter_data_regions_sf.rds")

quarter_data <- as_Spatial(my_2023_Q1)
quarter_data_sp <- as(quarter_data, "SpatialPoints")
quarter_data_ppp <- as.ppp(st_coordinates(my_2023_Q1), st_bbox(my_2023_Q1))

quarter_data_ppp_jit <- rjitter(quarter_data_ppp, 
                             retry=TRUE, 
                             nsim=1, 
                             drop=TRUE)
```

```{r,fig.width=12, fig.height=12}
my_2023_Q1_B_quarter_data_regions_ppp = quarter_data_ppp_jit[regions_owin]
quarter_data_regions_ppp.km <- rescale.ppp(my_2023_Q1_B_quarter_data_regions_ppp, 50000, "km")

bw_scott <- bw.scott(quarter_data_regions_ppp.km)

plot(density(quarter_data_regions_ppp.km, 
             sigma=bw_scott/2, 
             edge=TRUE, 
             kernel="gaussian"), 
     main = "2023 Q1 - Battles")
```

## Violence against civilians

```{r}
Example <- "Violence against civilians"
my_2023_Q1 <- acled_sf  %>%
  filter(event_type == Example & quarter == "2023 Q1")

write_rds(my_2023_Q1, "data/rds/my_2023_Q1_VAC_quarter_data_regions_sf.rds")

quarter_data <- as_Spatial(my_2023_Q1)
quarter_data_sp <- as(quarter_data, "SpatialPoints")
quarter_data_ppp <- as.ppp(st_coordinates(my_2023_Q1), st_bbox(my_2023_Q1))

quarter_data_ppp_jit <- rjitter(quarter_data_ppp, 
                             retry=TRUE, 
                             nsim=1, 
                             drop=TRUE)
```

```{r,fig.width=12, fig.height=12}
my_2023_Q1_VAC_quarter_data_regions_ppp = quarter_data_ppp_jit[regions_owin]
quarter_data_regions_ppp.km <- rescale.ppp(my_2023_Q1_VAC_quarter_data_regions_ppp, 50000, "km")

bw_scott <- bw.scott(quarter_data_regions_ppp.km)

plot(density(quarter_data_regions_ppp.km, 
             sigma=bw_scott/2, 
             edge=TRUE, 
             kernel="gaussian"), 
     main = "2023 Q1 -Violence against civilians")
```
:::

#### **Quarter 2**

::: panel-tabset
## Explosions/Remote violence

```{r}
Example <- "Explosions/Remote violence"
my_2023_Q2 <- acled_sf  %>%
  filter(event_type == Example & quarter == "2023 Q2")

write_rds(my_2023_Q2, "data/rds/my_2023_Q2_ER_quarter_data_regions_sf.rds")

quarter_data <- as_Spatial(my_2023_Q2)
quarter_data_sp <- as(quarter_data, "SpatialPoints")
quarter_data_ppp <- as.ppp(st_coordinates(my_2023_Q2), st_bbox(my_2023_Q2))

quarter_data_ppp_jit <- rjitter(quarter_data_ppp, 
                             retry=TRUE, 
                             nsim=1, 
                             drop=TRUE)
```

```{r,fig.width=12, fig.height=12}
my_2023_Q2_ER_quarter_data_regions_ppp = quarter_data_ppp_jit[regions_owin]
quarter_data_regions_ppp.km <- rescale.ppp(my_2023_Q2_ER_quarter_data_regions_ppp, 50000, "km")

bw_scott <- bw.scott(quarter_data_regions_ppp.km)

plot(density(quarter_data_regions_ppp.km, 
             sigma=bw_scott/2, 
             edge=TRUE, 
             kernel="gaussian"), 
     main = "2023 Q2 - Explosion/Remote violence")
```

## Strategic developments

```{r}
Example <- "Strategic developments"
my_2023_Q2 <- acled_sf  %>%
  filter(event_type == Example & quarter == "2023 Q2")

write_rds(my_2023_Q2, "data/rds/my_2023_Q2_SD_quarter_data_regions_sf.rds")

quarter_data <- as_Spatial(my_2023_Q2)
quarter_data_sp <- as(quarter_data, "SpatialPoints")
quarter_data_ppp <- as.ppp(st_coordinates(my_2023_Q2), st_bbox(my_2023_Q2))

quarter_data_ppp_jit <- rjitter(quarter_data_ppp, 
                             retry=TRUE, 
                             nsim=1, 
                             drop=TRUE)
```

```{r,fig.width=12, fig.height=12}
my_2023_Q2_SD_quarter_data_regions_ppp = quarter_data_ppp_jit[regions_owin]
quarter_data_regions_ppp.km <- rescale.ppp(my_2023_Q2_SD_quarter_data_regions_ppp, 50000, "km")

bw_scott <- bw.scott(quarter_data_regions_ppp.km)

plot(density(quarter_data_regions_ppp.km, 
             sigma=bw_scott/2, 
             edge=TRUE, 
             kernel="gaussian"), 
     main = "2023 Q2 - Strategic developments")
```

## Battles

```{r}
Example <- "Battles"
my_2023_Q2 <- acled_sf  %>%
  filter(event_type == Example & quarter == "2023 Q2")

write_rds(my_2023_Q2, "data/rds/my_2023_Q2_B_quarter_data_regions_sf.rds")

quarter_data <- as_Spatial(my_2023_Q2)
quarter_data_sp <- as(quarter_data, "SpatialPoints")
quarter_data_ppp <- as.ppp(st_coordinates(my_2023_Q2), st_bbox(my_2023_Q2))

quarter_data_ppp_jit <- rjitter(quarter_data_ppp, 
                             retry=TRUE, 
                             nsim=1, 
                             drop=TRUE)
```

```{r,fig.width=12, fig.height=12}
my_2023_Q2_B_quarter_data_regions_ppp = quarter_data_ppp_jit[regions_owin]
quarter_data_regions_ppp.km <- rescale.ppp(my_2023_Q2_B_quarter_data_regions_ppp, 50000, "km")

bw_scott <- bw.scott(quarter_data_regions_ppp.km)

plot(density(quarter_data_regions_ppp.km, 
             sigma=bw_scott/2, 
             edge=TRUE, 
             kernel="gaussian"), 
     main = "2023 Q2 - Battles")
```

## Violence against civilians

```{r}
Example <- "Violence against civilians"
my_2023_Q2 <- acled_sf  %>%
  filter(event_type == Example & quarter == "2023 Q2")

write_rds(my_2023_Q2, "data/rds/my_2023_Q2_VAC_quarter_data_regions_sf.rds")

quarter_data <- as_Spatial(my_2023_Q2)
quarter_data_sp <- as(quarter_data, "SpatialPoints")
quarter_data_ppp <- as.ppp(st_coordinates(my_2023_Q2), st_bbox(my_2023_Q2))

quarter_data_ppp_jit <- rjitter(quarter_data_ppp, 
                             retry=TRUE, 
                             nsim=1, 
                             drop=TRUE)
```

```{r,fig.width=12, fig.height=12}
my_2023_Q2_VAC_quarter_data_regions_ppp = quarter_data_ppp_jit[regions_owin]
quarter_data_regions_ppp.km <- rescale.ppp(my_2023_Q2_VAC_quarter_data_regions_ppp, 50000, "km")

bw_scott <- bw.scott(quarter_data_regions_ppp.km)

plot(density(quarter_data_regions_ppp.km, 
             sigma=bw_scott/2, 
             edge=TRUE, 
             kernel="gaussian"), 
     main = "2023 Q2 - Violence against civilians")
```
:::

#### **Quarter 3**

::: panel-tabset
## Explosions/Remote violence

```{r}
Example <- "Explosions/Remote violence"
my_2023_Q3 <- acled_sf  %>%
  filter(event_type == Example & quarter == "2023 Q3")

write_rds(my_2023_Q3, "data/rds/my_2023_Q3_ER_quarter_data_regions_sf.rds")

quarter_data <- as_Spatial(my_2023_Q3)
quarter_data_sp <- as(quarter_data, "SpatialPoints")
quarter_data_ppp <- as.ppp(st_coordinates(my_2023_Q3), st_bbox(my_2023_Q3))

quarter_data_ppp_jit <- rjitter(quarter_data_ppp, 
                             retry=TRUE, 
                             nsim=1, 
                             drop=TRUE)
```

```{r,fig.width=12, fig.height=12}
my_2023_Q3_ER_quarter_data_regions_ppp = quarter_data_ppp_jit[regions_owin]
quarter_data_regions_ppp.km <- rescale.ppp(my_2023_Q3_ER_quarter_data_regions_ppp, 50000, "km")

bw_scott <- bw.scott(quarter_data_regions_ppp.km)

plot(density(quarter_data_regions_ppp.km, 
             sigma=bw_scott/2, 
             edge=TRUE, 
             kernel="gaussian"), 
     main = "2023 Q3 - Explosion/Remote violence")
```

## Strategic developments

```{r}
Example <- "Strategic developments"
my_2023_Q3 <- acled_sf  %>%
  filter(event_type == Example & quarter == "2023 Q3")

write_rds(my_2023_Q3, "data/rds/my_2023_Q3_SD_quarter_data_regions_sf.rds")

quarter_data <- as_Spatial(my_2023_Q3)
quarter_data_sp <- as(quarter_data, "SpatialPoints")
quarter_data_ppp <- as.ppp(st_coordinates(my_2023_Q3), st_bbox(my_2023_Q3))

quarter_data_ppp_jit <- rjitter(quarter_data_ppp, 
                             retry=TRUE, 
                             nsim=1, 
                             drop=TRUE)
```

```{r,fig.width=12, fig.height=12}
my_2023_Q3_SD_quarter_data_regions_ppp = quarter_data_ppp_jit[regions_owin]
quarter_data_regions_ppp.km <- rescale.ppp(my_2023_Q3_SD_quarter_data_regions_ppp, 50000, "km")

bw_scott <- bw.scott(quarter_data_regions_ppp.km)

plot(density(quarter_data_regions_ppp.km, 
             sigma=bw_scott/2, 
             edge=TRUE, 
             kernel="gaussian"), 
     main = "2023 Q3 - Strategic developments")
```

## Battles

```{r}
Example <- "Battles"
my_2023_Q3 <- acled_sf  %>%
  filter(event_type == Example & quarter == "2023 Q3")

write_rds(my_2023_Q3, "data/rds/my_2023_Q3_B_quarter_data_regions_sf.rds")

quarter_data <- as_Spatial(my_2023_Q3)
quarter_data_sp <- as(quarter_data, "SpatialPoints")
quarter_data_ppp <- as.ppp(st_coordinates(my_2023_Q3), st_bbox(my_2023_Q3))

quarter_data_ppp_jit <- rjitter(quarter_data_ppp, 
                             retry=TRUE, 
                             nsim=1, 
                             drop=TRUE)
```

```{r,fig.width=12, fig.height=12}
my_2023_Q3_B_quarter_data_regions_ppp = quarter_data_ppp_jit[regions_owin]
quarter_data_regions_ppp.km <- rescale.ppp(my_2023_Q3_B_quarter_data_regions_ppp, 50000, "km")

bw_scott <- bw.scott(quarter_data_regions_ppp.km)

plot(density(quarter_data_regions_ppp.km, 
             sigma=bw_scott/2, 
             edge=TRUE, 
             kernel="gaussian"), 
     main = "2023 Q3 - Battles")
```

## Violence against civilians

```{r}
Example <- "Violence against civilians"
my_2023_Q3 <- acled_sf  %>%
  filter(event_type == Example & quarter == "2023 Q3")

write_rds(my_2023_Q3, "data/rds/my_2023_Q3_VAC_quarter_data_regions_sf.rds")

quarter_data <- as_Spatial(my_2023_Q3)
quarter_data_sp <- as(quarter_data, "SpatialPoints")
quarter_data_ppp <- as.ppp(st_coordinates(my_2023_Q3), st_bbox(my_2023_Q3))

quarter_data_ppp_jit <- rjitter(quarter_data_ppp, 
                             retry=TRUE, 
                             nsim=1, 
                             drop=TRUE)
```

```{r,fig.width=12, fig.height=12}
my_2023_Q3_VAC_quarter_data_regions_ppp = quarter_data_ppp_jit[regions_owin]
quarter_data_regions_ppp.km <- rescale.ppp(my_2023_Q3_VAC_quarter_data_regions_ppp, 50000, "km")

bw_scott <- bw.scott(quarter_data_regions_ppp.km)

plot(density(quarter_data_regions_ppp.km, 
             sigma=bw_scott/2, 
             edge=TRUE, 
             kernel="gaussian"), 
     main = "2023 Q3 - Violence against civilians")
```
:::

#### **Quarter 4**

::: panel-tabset
## Explosions/Remote violence

```{r}
Example <- "Explosions/Remote violence"
my_2023_Q4 <- acled_sf  %>%
  filter(event_type == Example & quarter == "2023 Q4")

write_rds(my_2023_Q4, "data/rds/my_2023_Q4_ER_quarter_data_regions_sf.rds")

quarter_data <- as_Spatial(my_2023_Q4)
quarter_data_sp <- as(quarter_data, "SpatialPoints")
quarter_data_ppp <- as.ppp(st_coordinates(my_2023_Q4), st_bbox(my_2023_Q4))

quarter_data_ppp_jit <- rjitter(quarter_data_ppp, 
                             retry=TRUE, 
                             nsim=1, 
                             drop=TRUE)
```

```{r,fig.width=12, fig.height=12}
my_2023_Q4_ER_quarter_data_regions_ppp = quarter_data_ppp_jit[regions_owin]
quarter_data_regions_ppp.km <- rescale.ppp(my_2023_Q4_ER_quarter_data_regions_ppp, 50000, "km")

bw_scott <- bw.scott(quarter_data_regions_ppp.km)

plot(density(quarter_data_regions_ppp.km, 
             sigma=bw_scott/2, 
             edge=TRUE, 
             kernel="gaussian"), 
     main = "2023 Q4 - Explosion/Remote violence")
```

## Strategic developments

```{r}
Example <- "Strategic developments"
my_2023_Q4 <- acled_sf  %>%
  filter(event_type == Example & quarter == "2023 Q4")

write_rds(my_2023_Q4, "data/rds/my_2023_Q4_SD_quarter_data_regions_sf.rds")

quarter_data <- as_Spatial(my_2023_Q4)
quarter_data_sp <- as(quarter_data, "SpatialPoints")
quarter_data_ppp <- as.ppp(st_coordinates(my_2023_Q4), st_bbox(my_2023_Q4))

quarter_data_ppp_jit <- rjitter(quarter_data_ppp, 
                             retry=TRUE, 
                             nsim=1, 
                             drop=TRUE)
```

```{r,fig.width=12, fig.height=12}
my_2023_Q4_SD_quarter_data_regions_ppp = quarter_data_ppp_jit[regions_owin]
quarter_data_regions_ppp.km <- rescale.ppp(my_2023_Q4_SD_quarter_data_regions_ppp, 50000, "km")

bw_scott <- bw.scott(quarter_data_regions_ppp.km)

plot(density(quarter_data_regions_ppp.km, 
             sigma=bw_scott/2, 
             edge=TRUE, 
             kernel="gaussian"), 
     main = "2023 Q4 - Strategic developments")
```

## Battles

```{r}
Example <- "Battles"
my_2023_Q4 <- acled_sf  %>%
  filter(event_type == Example & quarter == "2023 Q4")

write_rds(my_2023_Q4, "data/rds/my_2023_Q4_B_quarter_data_regions_sf.rds")

quarter_data <- as_Spatial(my_2023_Q4)
quarter_data_sp <- as(quarter_data, "SpatialPoints")
quarter_data_ppp <- as.ppp(st_coordinates(my_2023_Q4), st_bbox(my_2023_Q4))

quarter_data_ppp_jit <- rjitter(quarter_data_ppp, 
                             retry=TRUE, 
                             nsim=1, 
                             drop=TRUE)
```

```{r,fig.width=12, fig.height=12}
my_2023_Q4_B_quarter_data_regions_ppp = quarter_data_ppp_jit[regions_owin]
quarter_data_regions_ppp.km <- rescale.ppp(my_2023_Q4_B_quarter_data_regions_ppp, 50000, "km")

bw_scott <- bw.scott(quarter_data_regions_ppp.km)

plot(density(quarter_data_regions_ppp.km, 
             sigma=bw_scott/2, 
             edge=TRUE, 
             kernel="gaussian"), 
     main = "2023 Q4 - Battles")
```

## Violence against civilians

```{r}
Example <- "Violence against civilians"
my_2023_Q4 <- acled_sf  %>%
  filter(event_type == Example & quarter == "2023 Q4")

write_rds(my_2023_Q4, "data/rds/my_2023_Q4_VAC_quarter_data_regions_sf.rds")

quarter_data <- as_Spatial(my_2023_Q4)
quarter_data_sp <- as(quarter_data, "SpatialPoints")
quarter_data_ppp <- as.ppp(st_coordinates(my_2023_Q4), st_bbox(my_2023_Q4))

quarter_data_ppp_jit <- rjitter(quarter_data_ppp, 
                             retry=TRUE, 
                             nsim=1, 
                             drop=TRUE)
```

```{r,fig.width=12, fig.height=12}
my_2023_Q4_VAC_quarter_data_regions_ppp = quarter_data_ppp_jit[regions_owin]
quarter_data_regions_ppp.km <- rescale.ppp(my_2023_Q4_VAC_quarter_data_regions_ppp, 50000, "km")

bw_scott <- bw.scott(quarter_data_regions_ppp.km)

plot(density(quarter_data_regions_ppp.km, 
             sigma=bw_scott/2, 
             edge=TRUE, 
             kernel="gaussian"), 
     main = "2023 Q4 - Violence against civilians")
```
:::

### **Year 2024**

#### **Quarter 1**

::: panel-tabset
## Explosions/Remote violence

```{r}
Example <- "Explosions/Remote violence"
my_2024_Q1 <- acled_sf  %>%
  filter(event_type == Example & quarter == "2024 Q1")

write_rds(my_2024_Q1, "data/rds/my_2024_Q1_ER_quarter_data_regions_sf.rds")

quarter_data <- as_Spatial(my_2024_Q1)
quarter_data_sp <- as(quarter_data, "SpatialPoints")
quarter_data_ppp <- as.ppp(st_coordinates(my_2024_Q1), st_bbox(my_2024_Q1))

quarter_data_ppp_jit <- rjitter(quarter_data_ppp, 
                             retry=TRUE, 
                             nsim=1, 
                             drop=TRUE)
```

```{r,fig.width=12, fig.height=12}
my_2024_Q1_ER_quarter_data_regions_ppp = quarter_data_ppp_jit[regions_owin]
quarter_data_regions_ppp.km <- rescale.ppp(my_2024_Q1_ER_quarter_data_regions_ppp, 50000, "km")

bw_scott <- bw.scott(quarter_data_regions_ppp.km)

plot(density(quarter_data_regions_ppp.km, 
             sigma=bw_scott/2, 
             edge=TRUE, 
             kernel="gaussian"), 
     main = "2024 Q1 - Explosion/Remote violence")
```

## Strategic developments

```{r}
Example <- "Strategic developments"
my_2024_Q1 <- acled_sf  %>%
  filter(event_type == Example & quarter == "2024 Q1")

write_rds(my_2024_Q1, "data/rds/my_2024_Q1_SD_quarter_data_regions_sf.rds")

quarter_data <- as_Spatial(my_2024_Q1)
quarter_data_sp <- as(quarter_data, "SpatialPoints")
quarter_data_ppp <- as.ppp(st_coordinates(my_2024_Q1), st_bbox(my_2024_Q1))

quarter_data_ppp_jit <- rjitter(quarter_data_ppp, 
                             retry=TRUE, 
                             nsim=1, 
                             drop=TRUE)
```

```{r,fig.width=12, fig.height=12}
my_2024_Q1_SD_quarter_data_regions_ppp = quarter_data_ppp_jit[regions_owin]
quarter_data_regions_ppp.km <- rescale.ppp(my_2024_Q1_SD_quarter_data_regions_ppp, 50000, "km")

bw_scott <- bw.scott(quarter_data_regions_ppp.km)

plot(density(quarter_data_regions_ppp.km, 
             sigma=bw_scott/2, 
             edge=TRUE, 
             kernel="gaussian"), 
     main = "2024 Q1 - Strategic developments")
```

## Battles

```{r}
Example <- "Battles"
my_2024_Q1 <- acled_sf  %>%
  filter(event_type == Example & quarter == "2024 Q1")

write_rds(my_2024_Q1, "data/rds/my_2024_Q1_B_quarter_data_regions_sf.rds")

quarter_data <- as_Spatial(my_2024_Q1)
quarter_data_sp <- as(quarter_data, "SpatialPoints")
quarter_data_ppp <- as.ppp(st_coordinates(my_2024_Q1), st_bbox(my_2024_Q1))

quarter_data_ppp_jit <- rjitter(quarter_data_ppp, 
                             retry=TRUE, 
                             nsim=1, 
                             drop=TRUE)
```

```{r,fig.width=12, fig.height=12}
my_2024_Q1_B_quarter_data_regions_ppp = quarter_data_ppp_jit[regions_owin]
quarter_data_regions_ppp.km <- rescale.ppp(my_2024_Q1_B_quarter_data_regions_ppp, 50000, "km")

bw_scott <- bw.scott(quarter_data_regions_ppp.km)

plot(density(quarter_data_regions_ppp.km, 
             sigma=bw_scott/2, 
             edge=TRUE, 
             kernel="gaussian"), 
     main = "2024 Q1 - Battles")
```

## Violence against civilians

```{r}
Example <- "Violence against civilians"
my_2024_Q1 <- acled_sf  %>%
  filter(event_type == Example & quarter == "2024 Q1")

write_rds(my_2024_Q1, "data/rds/my_2024_Q1_VAC_quarter_data_regions_sf.rds")

quarter_data <- as_Spatial(my_2024_Q1)
quarter_data_sp <- as(quarter_data, "SpatialPoints")
quarter_data_ppp <- as.ppp(st_coordinates(my_2024_Q1), st_bbox(my_2024_Q1))

quarter_data_ppp_jit <- rjitter(quarter_data_ppp, 
                             retry=TRUE, 
                             nsim=1, 
                             drop=TRUE)
```

```{r,fig.width=12, fig.height=12}
my_2024_Q1_VAC_quarter_data_regions_ppp = quarter_data_ppp_jit[regions_owin]
quarter_data_regions_ppp.km <- rescale.ppp(my_2024_Q1_VAC_quarter_data_regions_ppp, 50000, "km")

bw_scott <- bw.scott(quarter_data_regions_ppp.km)

plot(density(quarter_data_regions_ppp.km, 
             sigma=bw_scott/2, 
             edge=TRUE, 
             kernel="gaussian"), 
     main = "2024 Q1 -Violence against civilians")
```
:::

#### **Quarter 2**

::: panel-tabset
## Explosions/Remote violence

```{r}
Example <- "Explosions/Remote violence"
my_2024_Q2 <- acled_sf  %>%
  filter(event_type == Example & quarter == "2024 Q2")

write_rds(my_2024_Q2, "data/rds/my_2024_Q2_ER_quarter_data_regions_sf.rds")

quarter_data <- as_Spatial(my_2024_Q2)
quarter_data_sp <- as(quarter_data, "SpatialPoints")
quarter_data_ppp <- as.ppp(st_coordinates(my_2024_Q2), st_bbox(my_2024_Q2))

quarter_data_ppp_jit <- rjitter(quarter_data_ppp, 
                             retry=TRUE, 
                             nsim=1, 
                             drop=TRUE)
```

```{r,fig.width=12, fig.height=12}
my_2024_Q2_ER_quarter_data_regions_ppp = quarter_data_ppp_jit[regions_owin]
quarter_data_regions_ppp.km <- rescale.ppp(my_2024_Q2_ER_quarter_data_regions_ppp, 50000, "km")

bw_scott <- bw.scott(quarter_data_regions_ppp.km)

plot(density(quarter_data_regions_ppp.km, 
             sigma=bw_scott/2, 
             edge=TRUE, 
             kernel="gaussian"), 
     main = "2024 Q2 - Explosion/Remote violence")
```

## Strategic developments

```{r}
Example <- "Strategic developments"
my_2024_Q2 <- acled_sf  %>%
  filter(event_type == Example & quarter == "2024 Q2")

write_rds(my_2024_Q2, "data/rds/my_2024_Q2_SD_quarter_data_regions_sf.rds")

quarter_data <- as_Spatial(my_2024_Q2)
quarter_data_sp <- as(quarter_data, "SpatialPoints")
quarter_data_ppp <- as.ppp(st_coordinates(my_2024_Q2), st_bbox(my_2024_Q2))

quarter_data_ppp_jit <- rjitter(quarter_data_ppp, 
                             retry=TRUE, 
                             nsim=1, 
                             drop=TRUE)
```

```{r,fig.width=12, fig.height=12}
my_2024_Q2_SD_quarter_data_regions_ppp = quarter_data_ppp_jit[regions_owin]
quarter_data_regions_ppp.km <- rescale.ppp(my_2024_Q2_SD_quarter_data_regions_ppp, 50000, "km")

bw_scott <- bw.scott(quarter_data_regions_ppp.km)

plot(density(quarter_data_regions_ppp.km, 
             sigma=bw_scott/2, 
             edge=TRUE, 
             kernel="gaussian"), 
     main = "2024 Q2 - Strategic developments")
```

## Battles

```{r}
Example <- "Battles"
my_2024_Q2 <- acled_sf  %>%
  filter(event_type == Example & quarter == "2024 Q2")

write_rds(my_2024_Q2, "data/rds/my_2024_Q2_B_quarter_data_regions_sf.rds")

quarter_data <- as_Spatial(my_2024_Q2)
quarter_data_sp <- as(quarter_data, "SpatialPoints")
quarter_data_ppp <- as.ppp(st_coordinates(my_2024_Q2), st_bbox(my_2024_Q2))

quarter_data_ppp_jit <- rjitter(quarter_data_ppp, 
                             retry=TRUE, 
                             nsim=1, 
                             drop=TRUE)
```

```{r,fig.width=12, fig.height=12}
my_2024_Q2_B_quarter_data_regions_ppp = quarter_data_ppp_jit[regions_owin]
quarter_data_regions_ppp.km <- rescale.ppp(my_2024_Q2_B_quarter_data_regions_ppp, 50000, "km")

bw_scott <- bw.scott(quarter_data_regions_ppp.km)

plot(density(quarter_data_regions_ppp.km, 
             sigma=bw_scott/2, 
             edge=TRUE, 
             kernel="gaussian"), 
     main = "2024 Q2 - Battles")
```

## Violence against civilians

```{r}
Example <- "Violence against civilians"
my_2024_Q2 <- acled_sf  %>%
  filter(event_type == Example & quarter == "2024 Q2")

write_rds(my_2024_Q2, "data/rds/my_2024_Q2_VAC_quarter_data_regions_sf.rds")

quarter_data <- as_Spatial(my_2024_Q2)
quarter_data_sp <- as(quarter_data, "SpatialPoints")
quarter_data_ppp <- as.ppp(st_coordinates(my_2024_Q2), st_bbox(my_2024_Q2))

quarter_data_ppp_jit <- rjitter(quarter_data_ppp, 
                             retry=TRUE, 
                             nsim=1, 
                             drop=TRUE)
```

```{r,fig.width=12, fig.height=12}
my_2024_Q2_VAC_quarter_data_regions_ppp = quarter_data_ppp_jit[regions_owin]
quarter_data_regions_ppp.km <- rescale.ppp(my_2024_Q2_VAC_quarter_data_regions_ppp, 50000, "km")

bw_scott <- bw.scott(quarter_data_regions_ppp.km)

plot(density(quarter_data_regions_ppp.km, 
             sigma=bw_scott/2, 
             edge=TRUE, 
             kernel="gaussian"), 
     main = "2024 Q2 - Violence against civilians")
```
:::

## **1.6 2nd-Order Spatial Point Patterns Analysis**

### **1.6.1 Overview**

To perform a Second-order Spatial Point Patterns Analysis, we utilize the G, F, K, and L functions of the `spatstat` package in R. Each of these functions analyzes different aspects of spatial point patterns. Given the nature of the dataset, it is crucial to choose an analysis that best captures the complexity of spatial distributions for conflict events. Each of the spatial functions (G, F, K, and L) has its strengths, but here’s how they align with conflict data analysis, with a particular focus on the G-function:

1.  **G-Function (Nearest Neighbor Distribution)**:

    -   **Detecting local clustering**: The G-function focuses on the distribution of nearest neighbors, making it particularly useful for detecting local clustering of events. In the civil war context, where conflict events often cluster in specific regions or around key areas of interest (e.g., cities, roads, military bases), the G-function can quickly and efficiently help identify **hotspots** of violence. Its simplicity and computational efficiency make it an excellent choice for analyzing localized patterns of violence, especially when time and resources are limited.

2.  **F-Function (Empty Space Function)**:

    -   **Detecting global regularity**: The F-function measures the distance from random locations to the nearest event. While it can offer insights into the global spread of events, this function is less relevant for conflict analysis because it emphasizes regularity over clustering, which is not typical in conflict zones. Conflict events are rarely evenly spaced, making the F-function less suited for this kind of data.

3.  **K-Function (Ripley’s K-Function)**:

    -   **Multi-scale clustering**: The K-function is valuable for analyzing clustering at different spatial scales, especially in hierarchical conflict scenarios where regional and local clusters coexist. However, the K-function's multi-scale nature comes with a higher computational cost, making it less practical for when large datasets are involved. While informative, its complexity and runtime can be a drawback.

4.  **L-Function (Transformed K-Function)**:

    -   **Simplifying K-function results**: The L-function is a linearized version of the K-function and offers more intuitive interpretations of clustering versus dispersion. However, like the K-function, it involves significant computation time, and its added complexity may not always justify its use, especially when the G-function already provides key insights into local clustering.

Given the nature of the civil war event data, where localized patterns and hotspots of violence are of primary concern, the **G-function** emerges as the most suitable tool for analysis. Its ability to efficiently detect **local clustering** while being computationally lightweight makes it a clear choice. While both **K-function** and **L-functions** offer multi-scale insights, they come at the cost of significant computation time, which may not be necessary for this analysis.

The **G-function** provides a focused and practical approach to understanding the spatial distribution of conflict events, making it the **preferred choice** in this context.

::: {.callout-tip title="Note"}
Due to the non-deterministic nature of running each simulation, the `set.seed()` function is employed to ensure the reproducibility of the simulation results. This is especially important for lower values of `nsim`, as it helps mitigate the random variability inherent in smaller sample sizes. By using a fixed seed, the analysis produces consistent outcomes across repeated runs, allowing for reliable comparisons and interpretations.

This approach enables us to assess whether the observed spatial point patterns significantly deviate from randomness. By simulating random point processes and comparing them to the observed data, we can identify potential clustering or dispersion patterns. These insights are critical in understanding the underlying structure of armed conflict events over time, helping to reveal whether the events are influenced by specific geographic or temporal factors or if they occur more randomly.

The results of this analysis contribute to a deeper understanding of the spatial-temporal dynamics of armed conflict, such as hotspots of violence, escalation patterns, and event diffusion across regions. This information is invaluable for conflict analysis, policy-making, and intervention planning.
:::

### Explosions/Remote violence overview

```{r, fig.width=12, fig.height=12}
set.seed(123)

# Create a list of all the ER quarter datasets
er_datasets <- list(
  my_2021_Q1_ER_quarter_data_regions_ppp,
  my_2021_Q2_ER_quarter_data_regions_ppp,
  my_2021_Q3_ER_quarter_data_regions_ppp,
  my_2021_Q4_ER_quarter_data_regions_ppp,
  my_2022_Q1_ER_quarter_data_regions_ppp,
  my_2022_Q2_ER_quarter_data_regions_ppp,
  my_2022_Q3_ER_quarter_data_regions_ppp,
  my_2022_Q4_ER_quarter_data_regions_ppp,
  my_2023_Q1_ER_quarter_data_regions_ppp,
  my_2023_Q2_ER_quarter_data_regions_ppp,
  my_2023_Q3_ER_quarter_data_regions_ppp,
  my_2023_Q4_ER_quarter_data_regions_ppp,
  my_2024_Q1_ER_quarter_data_regions_ppp,
  my_2024_Q2_ER_quarter_data_regions_ppp
)

# Corresponding year and quarter labels for the plots
er_labels <- c(
  "2021 Q1", "2021 Q2", "2021 Q3", "2021 Q4",
  "2022 Q1", "2022 Q2", "2022 Q3", "2022 Q4",
  "2023 Q1", "2023 Q2", "2023 Q3", "2023 Q4",
  "2024 Q1", "2024 Q2"
)

# Set up the plotting area
par(mar = c(2,0,2,0))
par(mfrow=c(4,4))

# Loop through each dataset and create the KDE plots
for (i in seq_along(er_datasets)) {
    G_CK.csr <- envelope(er_datasets[[i]], Gest, nsim = 50, correction="all", parallel = parallel::detectCores()
    )
  plot(G_CK.csr, xlim=c(0,10000), main= er_labels[[i]])
}
```

### Strategic developments overview

```{r, fig.width=12, fig.height=12}
set.seed(124)

# Create a list of all the ER quarter datasets
er_datasets <- list(
  my_2021_Q1_SD_quarter_data_regions_ppp,
  my_2021_Q2_SD_quarter_data_regions_ppp,
  my_2021_Q3_SD_quarter_data_regions_ppp,
  my_2021_Q4_SD_quarter_data_regions_ppp,
  my_2022_Q1_SD_quarter_data_regions_ppp,
  my_2022_Q2_SD_quarter_data_regions_ppp,
  my_2022_Q3_SD_quarter_data_regions_ppp,
  my_2022_Q4_SD_quarter_data_regions_ppp,
  my_2023_Q1_SD_quarter_data_regions_ppp,
  my_2023_Q2_SD_quarter_data_regions_ppp,
  my_2023_Q3_SD_quarter_data_regions_ppp,
  my_2023_Q4_SD_quarter_data_regions_ppp,
  my_2024_Q1_SD_quarter_data_regions_ppp,
  my_2024_Q2_SD_quarter_data_regions_ppp
)

# Corresponding year and quarter labels for the plots
er_labels <- c(
  "2021 Q1", "2021 Q2", "2021 Q3", "2021 Q4",
  "2022 Q1", "2022 Q2", "2022 Q3", "2022 Q4",
  "2023 Q1", "2023 Q2", "2023 Q3", "2023 Q4",
  "2024 Q1", "2024 Q2"
)

# Set up the plotting area
par(mar = c(2,1,2,1))
par(mfrow=c(4,4))

# Loop through each dataset and create the KDE plots
for (i in seq_along(er_datasets)) {
    G_CK.csr <- envelope(er_datasets[[i]], Gest, nsim = 50, parallel = parallel::detectCores())
  plot(G_CK.csr, xlim=c(0,10000), main= er_labels[[i]])
}
```

### Battles overview

```{r, fig.width=12, fig.height=12}
set.seed(125)

# Create a list of all the ER quarter datasets
er_datasets <- list(
  my_2021_Q1_B_quarter_data_regions_ppp,
  my_2021_Q2_B_quarter_data_regions_ppp,
  my_2021_Q3_B_quarter_data_regions_ppp,
  my_2021_Q4_B_quarter_data_regions_ppp,
  my_2022_Q1_B_quarter_data_regions_ppp,
  my_2022_Q2_B_quarter_data_regions_ppp,
  my_2022_Q3_B_quarter_data_regions_ppp,
  my_2022_Q4_B_quarter_data_regions_ppp,
  my_2023_Q1_B_quarter_data_regions_ppp,
  my_2023_Q2_B_quarter_data_regions_ppp,
  my_2023_Q3_B_quarter_data_regions_ppp,
  my_2023_Q4_B_quarter_data_regions_ppp,
  my_2024_Q1_B_quarter_data_regions_ppp,
  my_2024_Q2_B_quarter_data_regions_ppp
)

# Corresponding year and quarter labels for the plots
er_labels <- c(
  "2021 Q1", "2021 Q2", "2021 Q3", "2021 Q4",
  "2022 Q1", "2022 Q2", "2022 Q3", "2022 Q4",
  "2023 Q1", "2023 Q2", "2023 Q3", "2023 Q4",
  "2024 Q1", "2024 Q2"
)

# Set up the plotting area
par(mar = c(2,1,2,1))
par(mfrow=c(4,4))

# Loop through each dataset and create the KDE plots
for (i in seq_along(er_datasets)) {
    G_CK.csr <- envelope(er_datasets[[i]], Gest, nsim = 50, parallel = parallel::detectCores())
  plot(G_CK.csr, xlim=c(0,10000), main= er_labels[[i]])
}
```

### Violence against civilians overview

```{r, fig.width=12, fig.height=12}
set.seed(126)

# Create a list of all the ER quarter datasets
er_datasets <- list(
  my_2021_Q1_VAC_quarter_data_regions_ppp,
  my_2021_Q2_VAC_quarter_data_regions_ppp,
  my_2021_Q3_VAC_quarter_data_regions_ppp,
  my_2021_Q4_VAC_quarter_data_regions_ppp,
  my_2022_Q1_VAC_quarter_data_regions_ppp,
  my_2022_Q2_VAC_quarter_data_regions_ppp,
  my_2022_Q3_VAC_quarter_data_regions_ppp,
  my_2022_Q4_VAC_quarter_data_regions_ppp,
  my_2023_Q1_VAC_quarter_data_regions_ppp,
  my_2023_Q2_VAC_quarter_data_regions_ppp,
  my_2023_Q3_VAC_quarter_data_regions_ppp,
  my_2023_Q4_VAC_quarter_data_regions_ppp,
  my_2024_Q1_VAC_quarter_data_regions_ppp,
  my_2024_Q2_VAC_quarter_data_regions_ppp
)

# Corresponding year and quarter labels for the plots
er_labels <- c(
  "2021 Q1", "2021 Q2", "2021 Q3", "2021 Q4",
  "2022 Q1", "2022 Q2", "2022 Q3", "2022 Q4",
  "2023 Q1", "2023 Q2", "2023 Q3", "2023 Q4",
  "2024 Q1", "2024 Q2"
)

# Set up the plotting area
par(mar = c(2,1,2,1))
par(mfrow=c(4,4))

# Loop through each dataset and create the KDE plots
for (i in seq_along(er_datasets)) {
    G_CK.csr <- envelope(er_datasets[[i]], Gest, nsim = 50, parallel = parallel::detectCores())
  plot(G_CK.csr, xlim=c(0,10000), main= er_labels[[i]])
}
```

::: {.callout-tip title="Note"}
**Quarter-wise analysis for all event types:**

-   **2021 Q1**: There is a strong deviation from the CSR, where the empirical G-function lies well above the envelope. This suggests clustering, particularly over the distances considered.

-   **2021 Q2 to 2024 Q2**: Most quarters show a more stable pattern with the empirical G-function generally falling within the simulation envelope or only slightly above it at different distances. This suggests that there is no significant deviation from CSR, implying randomness in the spatial arrangement of points during most of these quarters. In some cases, the curve slightly rises above the envelope, which could indicate mild clustering.

**General Trend:** Across the quarters, the empirical G-function mostly lies within the CSR envelope, indicating a spatial point pattern that does not strongly deviate from randomness. The early quarters show more clustering, but later quarters become more consistent with random spatial distribution.
:::

## **1.7 Determining Spatio-Temporal KDE Layer**

### **1.7.1 Visualising geographic distribution of events by month**

We would first prepare the `acled_sf` object. The `q` column is derived from the `event_date` field using the `quarter()` function, which extracts the quarter (Q1, Q2, Q3, or Q4) from each date. This new column helps in grouping events by the quarter of the year, which is crucial for spatio-temporal analysis.

```{r}
temporal_acled_sf <- acled_sf %>%
  mutate(q = quarter(event_date))

write_rds(temporal_acled_sf, "data/rds/temporal_acled_sf.rds")
```

```{r}
tm_shape(regions_sf)+
  tm_polygons() +
tm_shape(temporal_acled_sf) +
  tm_dots() +
tm_facets(by="quarter", 
            free.coords=FALSE, 
            drop.units = TRUE)
```

### **1.7.2 Deriving Quarterly Spatio-Temporal KDE Layers**

In this section, we will be generating Quarterly Spatio-Temporal KDE (Kernel Density Estimation) layers for conflict events. KDE is a powerful technique for estimating the probability density function of a random variable—in this case, spatial point events such as conflicts.

The goal of spatio-temporal KDE is to analyze how the intensity of conflict events evolves both spatially and temporally. Instead of simply plotting the points, KDE smooths the data to show areas of higher and lower event intensity, giving a more nuanced view of conflict pattern

::: Key Steps in this Section: 1. **Quarter-Based Data Aggregation:** The conflict data will be divided into quarters (e.g., Q1 to Q4), allowing us to analyze conflict intensity in each three-month period.

2.  **Spatial Density Calculation:** The KDE method will be applied to the spatial points in each quarter, resulting in a density surface that highlights areas of high conflict concentration. This is more informative than a simple point map, as it reveals underlying patterns that might not be obvious from the raw data.

3.  **Temporal Change Analysis:** By deriving KDE layers for each quarter, you will visualize how conflict intensity shifts over time. This allows you to examine whether certain regions experience persistent conflict or if the hotspots move across the country as the year progresses.

4.  **Visualizing KDE Layers:** Each KDE layer will be visualized on a map, either as a standalone plot or as part of a sequence (e.g., an animated GIF), showing how the density changes quarterly. This provides a dynamic view of the conflict landscape.

:::

#### **1.7.2.1 Explosions/Remote violence**

```{r}
Example <- "Explosions/Remote violence"
acled_quarters_2021_ppp <- as.ppp(temporal_acled_sf %>%
  filter(year == 2021 & event_type == Example) %>%
  select(q))
acled_quarters_2022_ppp <- as.ppp(temporal_acled_sf %>%
  filter(year == 2022 & event_type == Example) %>%
  select(q))
acled_quarters_2023_ppp <- as.ppp(temporal_acled_sf %>%
  filter(year == 2023 & event_type == Example) %>%
  select(q))
acled_quarters_2024_ppp <- as.ppp(temporal_acled_sf %>%
  filter(year == 2024 & event_type == Example) %>%
  select(q))
```

::: panel-tabset
## **Year 2021**

```{r, fig.width=12, fig.height=12}
acled_spatio_ppp_owin <- acled_quarters_2021_ppp[regions_owin]
st_kde <- spattemp.density(acled_spatio_ppp_owin)

tims <- c(1, 3, 2, 4)
par(mfcol=c(2,2))
for(i in tims){ 
  plot(st_kde, i, 
       override.par=FALSE, 
       fix.range=TRUE, 
       main=paste("KDE at 2021 Q",i))
}
```

```{r}
for(i in tims){
  png(filename = paste0("data/rds/kde_plots/ER/kde_2021_ER", i, ".png"), width = 800, height = 600)
  
  plot(st_kde, i, 
       override.par=FALSE, 
       fix.range=TRUE, 
       main=paste("KDE at 2021 Q",i))
  dev.off()
}
```

## **Year 2022**

```{r, fig.width=12, fig.height=12}
acled_spatio_ppp_owin <- acled_quarters_2022_ppp[regions_owin]
st_kde <- spattemp.density(acled_spatio_ppp_owin)

tims <- c(1, 3, 2, 4)
par(mfcol=c(2,2))
for(i in tims){ 
  plot(st_kde, i, 
       override.par=FALSE, 
       fix.range=TRUE, 
       main=paste("KDE at 2022 Q",i))
}
```

```{r}
for(i in tims){
  png(filename = paste0("data/rds/kde_plots/ER/kde_2022_ER", i, ".png"), width = 800, height = 600)
  
  plot(st_kde, i, 
       override.par=FALSE, 
       fix.range=TRUE, 
       main=paste("KDE at 2022 Q",i))
  dev.off()
}
```

## **Year 2023**

```{r, fig.width=12, fig.height=12}
acled_spatio_ppp_owin <- acled_quarters_2023_ppp[regions_owin]
st_kde <- spattemp.density(acled_spatio_ppp_owin)

tims <- c(1, 3, 2, 4)
par(mfcol=c(2,2))
for(i in tims){ 
  plot(st_kde, i, 
       override.par=FALSE, 
       fix.range=TRUE, 
       main=paste("KDE at 2023 Q",i))
}
```

```{r}
for(i in tims){
  png(filename = paste0("data/rds/kde_plots/ER/kde_2023_ER", i, ".png"), width = 800, height = 600)
  
  plot(st_kde, i, 
       override.par=FALSE, 
       fix.range=TRUE, 
       main=paste("KDE at 2023 Q",i))
  dev.off()
}
```

## **Year 2024**

```{r, fig.width=12, fig.height=6}
acled_spatio_ppp_owin <- acled_quarters_2024_ppp[regions_owin]
st_kde <- spattemp.density(acled_spatio_ppp_owin)

tims <- c(1, 2)
par(mfrow=c(1,2))
for(i in tims){ 
  plot(st_kde, i, 
       override.par=FALSE, 
       fix.range=TRUE, 
       main=paste("KDE at 2024 Q",i))
}
```

```{r}
for(i in tims){
  png(filename = paste0("data/rds/kde_plots/ER/kde_2024_ER", i, ".png"), width = 800, height = 600)
  
  plot(st_kde, i, 
       override.par=FALSE, 
       fix.range=TRUE, 
       main=paste("KDE at 2024 Q",i))
  dev.off()
}
```
:::

```{r}
kde_images <- list.files("data/rds/kde_plots/ER/", full.names = TRUE, pattern = ".png")
image_read(kde_images) %>%
  image_animate(fps = 2)
```

#### **1.7.2.2 Strategic developments**

```{r}
Example <- "Strategic developments"
acled_quarters_2021_ppp <- as.ppp(temporal_acled_sf %>%
  filter(year == 2021 & event_type == Example) %>%
  select(q))
acled_quarters_2022_ppp <- as.ppp(temporal_acled_sf %>%
  filter(year == 2022 & event_type == Example) %>%
  select(q))
acled_quarters_2023_ppp <- as.ppp(temporal_acled_sf %>%
  filter(year == 2023 & event_type == Example) %>%
  select(q))
acled_quarters_2024_ppp <- as.ppp(temporal_acled_sf %>%
  filter(year == 2024 & event_type == Example) %>%
  select(q))
```

::: panel-tabset
## **Year 2021**

```{r, fig.width=12, fig.height=12}
acled_spatio_ppp_owin <- acled_quarters_2021_ppp[regions_owin]
st_kde <- spattemp.density(acled_spatio_ppp_owin)

tims <- c(1, 3, 2, 4)
par(mfcol=c(2,2))
for(i in tims){ 
  plot(st_kde, i, 
       override.par=FALSE, 
       fix.range=TRUE, 
       main=paste("KDE at 2021 Q",i))
}
```

```{r}
for(i in tims){
  png(filename = paste0("data/rds/kde_plots/SD/kde_2021_SD", i, ".png"), width = 800, height = 600)
  
  plot(st_kde, i, 
       override.par=FALSE, 
       fix.range=TRUE, 
       main=paste("KDE at 2021 Q",i))
  dev.off()
}
```

## **Year 2022**

```{r, fig.width=12, fig.height=12}
acled_spatio_ppp_owin <- acled_quarters_2022_ppp[regions_owin]
st_kde <- spattemp.density(acled_spatio_ppp_owin)

tims <- c(1, 3, 2, 4)
par(mfcol=c(2,2))
for(i in tims){ 
  plot(st_kde, i, 
       override.par=FALSE, 
       fix.range=TRUE, 
       main=paste("KDE at 2022 Q",i))
}
```

```{r}
for(i in tims){
  png(filename = paste0("data/rds/kde_plots/SD/kde_2022_SD", i, ".png"), width = 800, height = 600)
  
  plot(st_kde, i, 
       override.par=FALSE, 
       fix.range=TRUE, 
       main=paste("KDE at 2022 Q",i))
  dev.off()
}
```

## **Year 2023**

```{r, fig.width=12, fig.height=12}
acled_spatio_ppp_owin <- acled_quarters_2023_ppp[regions_owin]
st_kde <- spattemp.density(acled_spatio_ppp_owin)

tims <- c(1, 3, 2, 4)
par(mfcol=c(2,2))
for(i in tims){ 
  plot(st_kde, i, 
       override.par=FALSE, 
       fix.range=TRUE, 
       main=paste("KDE at 2023 Q",i))
}
```

```{r}
for(i in tims){
  png(filename = paste0("data/rds/kde_plots/SD/kde_2023_SD", i, ".png"), width = 800, height = 600)
  
  plot(st_kde, i, 
       override.par=FALSE, 
       fix.range=TRUE, 
       main=paste("KDE at 2023 Q",i))
  dev.off()
}
```

## **Year 2024**

```{r, fig.width=12, fig.height=6}
acled_spatio_ppp_owin <- acled_quarters_2024_ppp[regions_owin]
st_kde <- spattemp.density(acled_spatio_ppp_owin)

tims <- c(1, 2)
par(mfrow=c(1,2))
for(i in tims){ 
  plot(st_kde, i, 
       override.par=FALSE, 
       fix.range=TRUE, 
       main=paste("KDE at 2024 Q",i))
}
```

```{r}
for(i in tims){
  png(filename = paste0("data/rds/kde_plots/SD/kde_2024_SD", i, ".png"), width = 800, height = 600)
  
  plot(st_kde, i, 
       override.par=FALSE, 
       fix.range=TRUE, 
       main=paste("KDE at 2024 Q",i))
  dev.off()
}
```
:::

```{r}
kde_images <- list.files("data/rds/kde_plots/SD/", full.names = TRUE, pattern = ".png")
image_read(kde_images) %>%
  image_animate(fps = 2)
```

#### **1.7.2.3 Battles**

```{r}
Example <- "Battles"
acled_quarters_2021_ppp <- as.ppp(temporal_acled_sf %>%
  filter(year == 2021 & event_type == Example) %>%
  select(q))
acled_quarters_2022_ppp <- as.ppp(temporal_acled_sf %>%
  filter(year == 2022 & event_type == Example) %>%
  select(q))
acled_quarters_2023_ppp <- as.ppp(temporal_acled_sf %>%
  filter(year == 2023 & event_type == Example) %>%
  select(q))
acled_quarters_2024_ppp <- as.ppp(temporal_acled_sf %>%
  filter(year == 2024 & event_type == Example) %>%
  select(q))
```

::: panel-tabset
## **Year 2021**

```{r, fig.width=12, fig.height=12}
acled_spatio_ppp_owin <- acled_quarters_2021_ppp[regions_owin]
st_kde <- spattemp.density(acled_spatio_ppp_owin)

tims <- c(1, 3, 2, 4)
par(mfcol=c(2,2))
for(i in tims){ 
  plot(st_kde, i, 
       override.par=FALSE, 
       fix.range=TRUE, 
       main=paste("KDE at 2021 Q",i))
}
```

```{r}
for(i in tims){
  png(filename = paste0("data/rds/kde_plots/B/kde_2021_B", i, ".png"), width = 800, height = 600)
  
  plot(st_kde, i, 
       override.par=FALSE, 
       fix.range=TRUE, 
       main=paste("KDE at 2021 Q",i))
  dev.off()
}
```

## **Year 2022**

```{r, fig.width=12, fig.height=12}
acled_spatio_ppp_owin <- acled_quarters_2022_ppp[regions_owin]
st_kde <- spattemp.density(acled_spatio_ppp_owin)

tims <- c(1, 3, 2, 4)
par(mfcol=c(2,2))
for(i in tims){ 
  plot(st_kde, i, 
       override.par=FALSE, 
       fix.range=TRUE, 
       main=paste("KDE at 2022 Q",i))
}
```

```{r}
for(i in tims){
  png(filename = paste0("data/rds/kde_plots/B/kde_2022_B", i, ".png"), width = 800, height = 600)
  
  plot(st_kde, i, 
       override.par=FALSE, 
       fix.range=TRUE, 
       main=paste("KDE at 2022 Q",i))
  dev.off()
}
```

## **Year 2023**

```{r, fig.width=12, fig.height=12}
acled_spatio_ppp_owin <- acled_quarters_2023_ppp[regions_owin]
st_kde <- spattemp.density(acled_spatio_ppp_owin)

tims <- c(1, 3, 2, 4)
par(mfcol=c(2,2))
for(i in tims){ 
  plot(st_kde, i, 
       override.par=FALSE, 
       fix.range=TRUE, 
       main=paste("KDE at 2023 Q",i))
}
```

```{r}
for(i in tims){
  png(filename = paste0("data/rds/kde_plots/B/kde_2023_B", i, ".png"), width = 800, height = 600)
  
  plot(st_kde, i, 
       override.par=FALSE, 
       fix.range=TRUE, 
       main=paste("KDE at 2023 Q",i))
  dev.off()
}
```

## **Year 2024**

```{r, fig.width=12, fig.height=6}
acled_spatio_ppp_owin <- acled_quarters_2024_ppp[regions_owin]
st_kde <- spattemp.density(acled_spatio_ppp_owin)

tims <- c(1, 2)
par(mfrow=c(1,2))
for(i in tims){ 
  plot(st_kde, i, 
       override.par=FALSE, 
       fix.range=TRUE, 
       main=paste("KDE at 2024 Q",i))
}
```

```{r}
for(i in tims){
  png(filename = paste0("data/rds/kde_plots/B/kde_2024_B", i, ".png"), width = 800, height = 600)
  
  plot(st_kde, i, 
       override.par=FALSE, 
       fix.range=TRUE, 
       main=paste("KDE at 2024 Q",i))
  dev.off()
}
```
:::

```{r}
kde_images <- list.files("data/rds/kde_plots/B/", full.names = TRUE, pattern = ".png")
image_read(kde_images) %>%
  image_animate(fps = 2)
```

#### **1.7.2.4 Violence against civilians**

```{r}
Example <- "Violence against civilians"
acled_quarters_2021_ppp <- as.ppp(temporal_acled_sf %>%
  filter(year == 2021 & event_type == Example) %>%
  select(q))
acled_quarters_2022_ppp <- as.ppp(temporal_acled_sf %>%
  filter(year == 2022 & event_type == Example) %>%
  select(q))
acled_quarters_2023_ppp <- as.ppp(temporal_acled_sf %>%
  filter(year == 2023 & event_type == Example) %>%
  select(q))
acled_quarters_2024_ppp <- as.ppp(temporal_acled_sf %>%
  filter(year == 2024 & event_type == Example) %>%
  select(q))
```

::: panel-tabset
## **Year 2021**

```{r, fig.width=12, fig.height=12}
acled_spatio_ppp_owin <- acled_quarters_2021_ppp[regions_owin]
st_kde <- spattemp.density(acled_spatio_ppp_owin)

tims <- c(1, 3, 2, 4)
par(mfcol=c(2,2))
for(i in tims){ 
  plot(st_kde, i, 
       override.par=FALSE, 
       fix.range=TRUE, 
       main=paste("KDE at 2021 Q",i))
}
```

```{r}
for(i in tims){
  png(filename = paste0("data/rds/kde_plots/VAC/kde_2021_VAC", i, ".png"), width = 800, height = 600)
  
  plot(st_kde, i, 
       override.par=FALSE, 
       fix.range=TRUE, 
       main=paste("KDE at 2021 Q",i))
  dev.off()
}
```

## **Year 2022**

```{r, fig.width=12, fig.height=12}
acled_spatio_ppp_owin <- acled_quarters_2022_ppp[regions_owin]
st_kde <- spattemp.density(acled_spatio_ppp_owin)

tims <- c(1, 3, 2, 4)
par(mfcol=c(2,2))
for(i in tims){ 
  plot(st_kde, i, 
       override.par=FALSE, 
       fix.range=TRUE, 
       main=paste("KDE at 2022 Q",i))
}
```

```{r}
for(i in tims){
  png(filename = paste0("data/rds/kde_plots/VAC/kde_2022_VAC", i, ".png"), width = 800, height = 600)
  
  plot(st_kde, i, 
       override.par=FALSE, 
       fix.range=TRUE, 
       main=paste("KDE at 2022 Q",i))
  dev.off()
}
```

## **Year 2023**

```{r, fig.width=12, fig.height=12}
acled_spatio_ppp_owin <- acled_quarters_2023_ppp[regions_owin]
st_kde <- spattemp.density(acled_spatio_ppp_owin)

tims <- c(1, 3, 2, 4)
par(mfcol=c(2,2))
for(i in tims){ 
  plot(st_kde, i, 
       override.par=FALSE, 
       fix.range=TRUE, 
       main=paste("KDE at 2023 Q",i))
}
```

```{r}
for(i in tims){
  png(filename = paste0("data/rds/kde_plots/VAC/kde_2023_VAC", i, ".png"), width = 800, height = 600)
  
  plot(st_kde, i, 
       override.par=FALSE, 
       fix.range=TRUE, 
       main=paste("KDE at 2023 Q",i))
  dev.off()
}
```

## **Year 2024**

```{r, fig.width=12, fig.height=6}
acled_spatio_ppp_owin <- acled_quarters_2024_ppp[regions_owin]
st_kde <- spattemp.density(acled_spatio_ppp_owin)

tims <- c(1, 2)
par(mfrow=c(1,2))
for(i in tims){ 
  plot(st_kde, i, 
       override.par=FALSE, 
       fix.range=TRUE, 
       main=paste("KDE at 2024 Q",i))
}
```

```{r}
for(i in tims){
  png(filename = paste0("data/rds/kde_plots/VAC/kde_2024_VAC", i, ".png"), width = 800, height = 600)
  
  plot(st_kde, i, 
       override.par=FALSE, 
       fix.range=TRUE, 
       main=paste("KDE at 2024 Q",i))
  dev.off()
}
```
:::

```{r}
kde_images <- list.files("data/rds/kde_plots/VAC/", full.names = TRUE, pattern = ".png")
image_read(kde_images) %>%
  image_animate(fps = 2)
```

## **1.8 2nd-Order Spatio-Temporal Point Patterns Analysis**

Given that we are analyzing **armed conflict data** across different quarters (from 2021 to 2024) and likely observing variation in event density over space and time, **inhomogeneous point patterns** are the more appropriate model.

As such we have opted to use the `Kinhom` function for 2nd-order analysis.

::: {.callout-tip title="Note"}
It can be noted that `set.seed()` is not utilised for the following set of simulations. This is due to to `nsim` is set to a sufficiently large value, and that provides a large enough sample of randomized patterns to accurately assess the distribution of the test statistic under the null hypothesis.

When the number of simulations is high, the variability in the results caused by random differences between simulations is reduced, making the outcome more stable and less sensitive to randomness. This minimizes the risk of random fluctuations significantly influencing the final result.
:::

### **1.8.1 Explosions/Remote violence**

::: panel-tabset
```{r}
Example <- "Explosions/Remote violence"
acled_quarters_2021_ppp <- as.ppp(temporal_acled_sf %>%
  filter(year == 2021 & event_type == Example) %>%
  select(q))
acled_quarters_2022_ppp <- as.ppp(temporal_acled_sf %>%
  filter(year == 2022 & event_type == Example) %>%
  select(q))
acled_quarters_2023_ppp <- as.ppp(temporal_acled_sf %>%
  filter(year == 2023 & event_type == Example) %>%
  select(q))
acled_quarters_2024_ppp <- as.ppp(temporal_acled_sf %>%
  filter(year == 2024 & event_type == Example) %>%
  select(q))
```

## **2021**

```{r}
# Assuming `acled_spatio_ppp_owin` is your spatio-temporal point pattern object:
acled_spatio_ppp_owin <- acled_quarters_2021_ppp[regions_owin]
K_st <- Kinhom(acled_spatio_ppp_owin, correction="border")

# Plot the result for visual inspection
plot(K_st, main = "Spatio-temporal K-function", legend=TRUE)
```

```{r}
# Perform the CSR test with 99 simulations
K_ck.csr <- envelope(acled_spatio_ppp_owin, Kinhom, nsim=99, correction="border", parallel = parallel::detectCores())

# Plot the envelope with the observed K-function
plot(K_ck.csr, main="Spatio-temporal K-function Envelope", legend=TRUE)
```

## **2022**

```{r}
# Assuming `acled_spatio_ppp_owin` is your spatio-temporal point pattern object:
acled_spatio_ppp_owin <- acled_quarters_2022_ppp[regions_owin]
K_st <- Kinhom(acled_spatio_ppp_owin, correction="border")

# Plot the result for visual inspection
plot(K_st, main = "Spatio-temporal K-function", legend=TRUE)
```

```{r}
# Perform the CSR test with 99 simulations
K_ck.csr <- envelope(acled_spatio_ppp_owin, Kinhom, nsim=99, correction="border", parallel = parallel::detectCores())

# Plot the envelope with the observed K-function
plot(K_ck.csr, main="Spatio-temporal K-function Envelope", legend=TRUE)
```

## **2023**

```{r}
# Assuming `acled_spatio_ppp_owin` is your spatio-temporal point pattern object:
acled_spatio_ppp_owin <- acled_quarters_2023_ppp[regions_owin]
K_st <- Kinhom(acled_spatio_ppp_owin, correction="border")

# Plot the result for visual inspection
plot(K_st, main = "Spatio-temporal K-function", legend=TRUE)
```

```{r}
# Perform the CSR test with 99 simulations
K_ck.csr <- envelope(acled_spatio_ppp_owin, Kinhom, nsim=99, correction="border", parallel = parallel::detectCores())

# Plot the envelope with the observed K-function
plot(K_ck.csr, main="Spatio-temporal K-function Envelope", legend=TRUE)
```

## **2024**

```{r}
# Assuming `acled_spatio_ppp_owin` is your spatio-temporal point pattern object:
acled_spatio_ppp_owin <- acled_quarters_2024_ppp[regions_owin]
K_st <- Kinhom(acled_spatio_ppp_owin, correction="border")

# Plot the result for visual inspection
plot(K_st, main = "Spatio-temporal K-function", legend=TRUE)
```

```{r}
# Perform the CSR test with 99 simulations
K_ck.csr <- envelope(acled_spatio_ppp_owin, Kinhom, nsim=99, correction="border", parallel = parallel::detectCores())
```

```{r}
# Plot the envelope with the observed K-function
plot(K_ck.csr, main="Spatio-temporal K-function Envelope", legend=TRUE)
```
:::

### **1.8.2 Strategic developments**

::: panel-tabset
```{r}
Example <- "Strategic developments"
acled_quarters_2021_ppp <- as.ppp(temporal_acled_sf %>%
  filter(year == 2021 & event_type == Example) %>%
  select(q))
acled_quarters_2022_ppp <- as.ppp(temporal_acled_sf %>%
  filter(year == 2022 & event_type == Example) %>%
  select(q))
acled_quarters_2023_ppp <- as.ppp(temporal_acled_sf %>%
  filter(year == 2023 & event_type == Example) %>%
  select(q))
acled_quarters_2024_ppp <- as.ppp(temporal_acled_sf %>%
  filter(year == 2024 & event_type == Example) %>%
  select(q))
```

## **2021**

```{r}
# Assuming `acled_spatio_ppp_owin` is your spatio-temporal point pattern object:
acled_spatio_ppp_owin <- acled_quarters_2021_ppp[regions_owin]
K_st <- Kinhom(acled_spatio_ppp_owin, correction="border")

# Plot the result for visual inspection
plot(K_st, main = "Spatio-temporal K-function", legend=TRUE)
```

```{r}
# Perform the CSR test with 99 simulations
K_ck.csr <- envelope(acled_spatio_ppp_owin, Kinhom, nsim=99, correction="border", parallel = parallel::detectCores())

# Plot the envelope with the observed K-function
plot(K_ck.csr, main="Spatio-temporal K-function Envelope", legend=TRUE)
```

## **2022**

```{r}
# Assuming `acled_spatio_ppp_owin` is your spatio-temporal point pattern object:
acled_spatio_ppp_owin <- acled_quarters_2022_ppp[regions_owin]
K_st <- Kinhom(acled_spatio_ppp_owin, correction="border")

# Plot the result for visual inspection
plot(K_st, main = "Spatio-temporal K-function", legend=TRUE)
```

```{r}
# Perform the CSR test with 99 simulations
K_ck.csr <- envelope(acled_spatio_ppp_owin, Kinhom, nsim=99, correction="border", parallel = parallel::detectCores())

# Plot the envelope with the observed K-function
plot(K_ck.csr, main="Spatio-temporal K-function Envelope", legend=TRUE)
```

## **2023**

```{r}
# Assuming `acled_spatio_ppp_owin` is your spatio-temporal point pattern object:
acled_spatio_ppp_owin <- acled_quarters_2023_ppp[regions_owin]
K_st <- Kinhom(acled_spatio_ppp_owin, correction="border")

# Plot the result for visual inspection
plot(K_st, main = "Spatio-temporal K-function", legend=TRUE)
```

```{r}
# Perform the CSR test with 99 simulations
K_ck.csr <- envelope(acled_spatio_ppp_owin, Kinhom, nsim=99, correction="border", parallel = parallel::detectCores())

# Plot the envelope with the observed K-function
plot(K_ck.csr, main="Spatio-temporal K-function Envelope", legend=TRUE)
```

## **2024**

```{r}
# Assuming `acled_spatio_ppp_owin` is your spatio-temporal point pattern object:
acled_spatio_ppp_owin <- acled_quarters_2024_ppp[regions_owin]
K_st <- Kinhom(acled_spatio_ppp_owin, correction="border")

# Plot the result for visual inspection
plot(K_st, main = "Spatio-temporal K-function", legend=TRUE)
```

```{r}
# Perform the CSR test with 99 simulations
K_ck.csr <- envelope(acled_spatio_ppp_owin, Kinhom, nsim=99, correction="border", parallel = parallel::detectCores())
```

```{r}
# Plot the envelope with the observed K-function
plot(K_ck.csr, main="Spatio-temporal K-function Envelope", legend=TRUE)
```
:::

### **1.8.3 Battles**

::: panel-tabset
```{r}
Example <- "Battles"
acled_quarters_2021_ppp <- as.ppp(temporal_acled_sf %>%
  filter(year == 2021 & event_type == Example) %>%
  select(q))
acled_quarters_2022_ppp <- as.ppp(temporal_acled_sf %>%
  filter(year == 2022 & event_type == Example) %>%
  select(q))
acled_quarters_2023_ppp <- as.ppp(temporal_acled_sf %>%
  filter(year == 2023 & event_type == Example) %>%
  select(q))
acled_quarters_2024_ppp <- as.ppp(temporal_acled_sf %>%
  filter(year == 2024 & event_type == Example) %>%
  select(q))
```

## **2021**

```{r}
# Assuming `acled_spatio_ppp_owin` is your spatio-temporal point pattern object:
acled_spatio_ppp_owin <- acled_quarters_2021_ppp[regions_owin]
K_st <- Kinhom(acled_spatio_ppp_owin, correction="border")

# Plot the result for visual inspection
plot(K_st, main = "Spatio-temporal K-function", legend=TRUE)
```

```{r}
# Perform the CSR test with 99 simulations
K_ck.csr <- envelope(acled_spatio_ppp_owin, Kinhom, nsim=99, correction="border", parallel = parallel::detectCores())

# Plot the envelope with the observed K-function
plot(K_ck.csr, main="Spatio-temporal K-function Envelope", legend=TRUE)
```

## **2022**

```{r}
# Assuming `acled_spatio_ppp_owin` is your spatio-temporal point pattern object:
acled_spatio_ppp_owin <- acled_quarters_2022_ppp[regions_owin]
K_st <- Kinhom(acled_spatio_ppp_owin, correction="border")

# Plot the result for visual inspection
plot(K_st, main = "Spatio-temporal K-function", legend=TRUE)
```

```{r}
# Perform the CSR test with 99 simulations
K_ck.csr <- envelope(acled_spatio_ppp_owin, Kinhom, nsim=99, correction="border", parallel = parallel::detectCores())

# Plot the envelope with the observed K-function
plot(K_ck.csr, main="Spatio-temporal K-function Envelope", legend=TRUE)
```

## **2023**

```{r}
# Assuming `acled_spatio_ppp_owin` is your spatio-temporal point pattern object:
acled_spatio_ppp_owin <- acled_quarters_2023_ppp[regions_owin]
K_st <- Kinhom(acled_spatio_ppp_owin, correction="border")

# Plot the result for visual inspection
plot(K_st, main = "Spatio-temporal K-function", legend=TRUE)
```

```{r}
# Perform the CSR test with 99 simulations
K_ck.csr <- envelope(acled_spatio_ppp_owin, Kinhom, nsim=99, correction="border", parallel = parallel::detectCores())

# Plot the envelope with the observed K-function
plot(K_ck.csr, main="Spatio-temporal K-function Envelope", legend=TRUE)
```

## **2024**

```{r}
# Assuming `acled_spatio_ppp_owin` is your spatio-temporal point pattern object:
acled_spatio_ppp_owin <- acled_quarters_2024_ppp[regions_owin]
K_st <- Kinhom(acled_spatio_ppp_owin, correction="border")

# Plot the result for visual inspection
plot(K_st, main = "Spatio-temporal K-function", legend=TRUE)
```

```{r}
# Perform the CSR test with 99 simulations
K_ck.csr <- envelope(acled_spatio_ppp_owin, Kinhom, nsim=50, correction="border", parallel = parallel::detectCores())
```

```{r}
# Plot the envelope with the observed K-function
plot(K_ck.csr, main="Spatio-temporal K-function Envelope", legend=TRUE)
```
:::

### **1.8.3 Violence against civilians**

::: panel-tabset
```{r}
Example <- "Violence against civilians"
acled_quarters_2021_ppp <- as.ppp(temporal_acled_sf %>%
  filter(year == 2021 & event_type == Example) %>%
  select(q))
acled_quarters_2022_ppp <- as.ppp(temporal_acled_sf %>%
  filter(year == 2022 & event_type == Example) %>%
  select(q))
acled_quarters_2023_ppp <- as.ppp(temporal_acled_sf %>%
  filter(year == 2023 & event_type == Example) %>%
  select(q))
acled_quarters_2024_ppp <- as.ppp(temporal_acled_sf %>%
  filter(year == 2024 & event_type == Example) %>%
  select(q))
```

## **2021**

```{r}
# Assuming `acled_spatio_ppp_owin` is your spatio-temporal point pattern object:
acled_spatio_ppp_owin <- acled_quarters_2021_ppp[regions_owin]
K_st <- Kinhom(acled_spatio_ppp_owin, correction="border")

# Plot the result for visual inspection
plot(K_st, main = "Spatio-temporal K-function", legend=TRUE)
```

```{r}
# Perform the CSR test with 99 simulations
K_ck.csr <- envelope(acled_spatio_ppp_owin, Kinhom, nsim=99, correction="border", parallel = parallel::detectCores())

# Plot the envelope with the observed K-function
plot(K_ck.csr, main="Spatio-temporal K-function Envelope", legend=TRUE)
```

## **2022**

```{r}
# Assuming `acled_spatio_ppp_owin` is your spatio-temporal point pattern object:
acled_spatio_ppp_owin <- acled_quarters_2022_ppp[regions_owin]
K_st <- Kinhom(acled_spatio_ppp_owin, correction="border")

# Plot the result for visual inspection
plot(K_st, main = "Spatio-temporal K-function", legend=TRUE)
```

```{r}
# Perform the CSR test with 99 simulations
K_ck.csr <- envelope(acled_spatio_ppp_owin, Kinhom, nsim=99, correction="border", parallel = parallel::detectCores())

# Plot the envelope with the observed K-function
plot(K_ck.csr, main="Spatio-temporal K-function Envelope", legend=TRUE)
```

## **2023**

```{r}
# Assuming `acled_spatio_ppp_owin` is your spatio-temporal point pattern object:
acled_spatio_ppp_owin <- acled_quarters_2023_ppp[regions_owin]
K_st <- Kinhom(acled_spatio_ppp_owin, correction="border")

# Plot the result for visual inspection
plot(K_st, main = "Spatio-temporal K-function", legend=TRUE)
```

```{r}
# Perform the CSR test with 99 simulations
K_ck.csr <- envelope(acled_spatio_ppp_owin, Kinhom, nsim=99, correction="border", parallel = parallel::detectCores())

# Plot the envelope with the observed K-function
plot(K_ck.csr, main="Spatio-temporal K-function Envelope", legend=TRUE)
```

## **2024**

```{r}
# Assuming `acled_spatio_ppp_owin` is your spatio-temporal point pattern object:
acled_spatio_ppp_owin <- acled_quarters_2024_ppp[regions_owin]
K_st <- Kinhom(acled_spatio_ppp_owin, correction="border")

# Plot the result for visual inspection
plot(K_st, main = "Spatio-temporal K-function", legend=TRUE)
```

```{r}
# Perform the CSR test with 99 simulations
K_ck.csr <- envelope(acled_spatio_ppp_owin, Kinhom, nsim=99, correction="border", parallel = parallel::detectCores())
```

```{r}
# Plot the envelope with the observed K-function
plot(K_ck.csr, main="Spatio-temporal K-function Envelope", legend=TRUE)
```
:::

::: {.callout-tip title="Note"}
**Interpretation:** 1. Large Distance Scales: - The x-axis stretches to large distances, and while there is visible divergence between the observed and theoretical K-function, this may reflect clustering at large spatial scales. However, in real-world spatial analyses, large scales may not capture important localized clustering that occurs over smaller distances.

2.  Envelope Overlap:

-   While the black observed curve rises above the simulation envelope, the overall broadness of the envelope may obscure fine distinctions. A closer look at smaller scales or at specific distances would provide a more refined understanding of clustering in specific areas and time periods, particularly for regions like Chin or Mandalay in the context of the Burmese civil war.

3.  Potential Scale Sensitivity:

-   Spatio-temporal processes often show different behaviors at different spatial or temporal scales. While this graph suggests some clustering, it's possible that examining specific distance ranges more closely (e.g., shorter spatial ranges or focusing on specific temporal windows) could reveal more localized patterns of interaction that are not easily discernible in this large-scale plot.
:::

In conclusion, the general consensus of the plots provides some indication of **spatio-temporal clustering**, but to gain meaningful insights, a closer, more focused analysis over smaller spatial and temporal distances is required to uncover patterns of conflict that may be masked at these larger scales.

### **1.8.4 Looking Closer**

Visually, we observed that the regions of **Chin**, **Sagaing**, **Mandalay**, and **Magway** have the highest occurrences of event types such as **Explosions/Remote violence**, **Strategic developments**, **Battles**, and **Violence against Civilians**. To better understand the spatial and temporal distribution and clustering of these events, we will perform a **second-order spatio-temporal point pattern analysis**. This will help assess the degree of interaction or clustering of events across space and time within these key regions.

#### **1.8.4.1 Importing the relevant regions into R**

```{r}
chin_sf <- st_read(dsn = "data/chin", 
                layer = "mmr_chn_polbnda_adm4_mimu_250k")
chin_sf <- st_transform(chin_sf, crs = 32647)
```

```{r}
chin_owin <- as.owin(chin_sf)
```

```{r}
magway_sf <- st_read(dsn = "data/sagaing", 
                layer = "mmr_mgy_polbnda_adm4_wfp_mimu_250k_1")
magway_sf <- st_transform(magway_sf, crs = 32647)
```

```{r}
magway_owin <- as.owin(magway_sf)
```

```{r}
mandalay_sf <- st_read(dsn = "data/mandalay", 
                layer = "mmr_mdy_polbnda_adm4_mimu_250k")
mandalay_sf <- st_transform(mandalay_sf, crs = 32647)
```

```{r}
mandalay_owin <- as.owin(mandalay_sf)
```

```{r}
sagaing_sf <- st_read(dsn = "data/magway", 
                layer = "mmr_sag_polbnda_adm4_250k_mimu_1")
sagaing_sf <- st_transform(sagaing_sf, crs = 32647)
```

```{r}
sagaing_owin <- as.owin(sagaing_sf)
```

```{r}
temporal_acled_sf <- read_rds("data/rds/temporal_acled_sf.rds")
```

#### **1.8.4.2 Chin Region**

```{r}
# Perform spatial intersection to keep only the points within Chin region
chin_acled_sf <- temporal_acled_sf %>% filter(admin1 == "Chin")

# Plot the Chin region and filtered points
tm_shape(chin_sf) +
  tm_polygons() +
  tm_shape(chin_acled_sf) +
  tm_dots(size = 0.3) +
  tm_facets(by = "quarter", 
            free.coords = FALSE, 
            drop.units = TRUE) + 
  tm_layout(main.title = "Region and Boundaries of Chin",
          main.title.position = "center",
          main.title.size = 1,
          legend.outside = TRUE,
          frame = TRUE)

write_rds(chin_acled_sf, "data/rds/chin_acled_sf.rds")
```

##### **1.8.4.2.1 Explosions/Remote violence**

```{r}
Example <- "Explosions/Remote violence"
chin_acled_quarters_2021_ppp <- as.ppp(chin_acled_sf %>%
  filter(year == 2021 & event_type == Example) %>%
  select(q))
chin_acled_quarters_2022_ppp <- as.ppp(chin_acled_sf %>%
  filter(year == 2022 & event_type == Example) %>%
  select(q))
chin_acled_quarters_2023_ppp <- as.ppp(chin_acled_sf %>%
  filter(year == 2023 & event_type == Example) %>%
  select(q))
chin_acled_quarters_2024_ppp <- as.ppp(chin_acled_sf %>%
  filter(year == 2024 & event_type == Example) %>%
  select(q))
```

::: panel-tabset
## **2021**

```{r}
# Assuming `acled_spatio_ppp_owin` is your spatio-temporal point pattern object:
acled_spatio_ppp_owin <- chin_acled_quarters_2021_ppp[chin_owin]
K_st <- Kinhom(acled_spatio_ppp_owin, correction="border")

# Plot the result for visual inspection
plot(K_st, main = "Spatio-temporal K-function", legend=TRUE)
```

```{r}
# Perform the CSR test with 99 simulations
K_ck.csr <- envelope(acled_spatio_ppp_owin, Kinhom, nsim=99, correction="border", parallel = parallel::detectCores())

# Plot the envelope with the observed K-function
plot(K_ck.csr, main="Spatio-temporal K-function Envelope", legend=TRUE)
```

## **2022**

```{r}
# Assuming `acled_spatio_ppp_owin` is your spatio-temporal point pattern object:
acled_spatio_ppp_owin <- chin_acled_quarters_2022_ppp[chin_owin]
K_st <- Kinhom(acled_spatio_ppp_owin, correction="border")

# Plot the result for visual inspection
plot(K_st, main = "Spatio-temporal K-function", legend=TRUE)
```

```{r}
# Perform the CSR test with 99 simulations
K_ck.csr <- envelope(acled_spatio_ppp_owin, Kinhom, nsim=99, correction="border", parallel = parallel::detectCores())

# Plot the envelope with the observed K-function
plot(K_ck.csr, main="Spatio-temporal K-function Envelope", legend=TRUE)
```

## **2023**

```{r}
# Assuming `acled_spatio_ppp_owin` is your spatio-temporal point pattern object:
acled_spatio_ppp_owin <- chin_acled_quarters_2023_ppp[chin_owin]
K_st <- Kinhom(acled_spatio_ppp_owin, correction="border")

# Plot the result for visual inspection
plot(K_st, main = "Spatio-temporal K-function", legend=TRUE)
```

```{r}
# Perform the CSR test with 99 simulations
K_ck.csr <- envelope(acled_spatio_ppp_owin, Kinhom, nsim=99, correction="border", parallel = parallel::detectCores())

# Plot the envelope with the observed K-function
plot(K_ck.csr, main="Spatio-temporal K-function Envelope", legend=TRUE)
```

## **2024**

```{r}
# Assuming `acled_spatio_ppp_owin` is your spatio-temporal point pattern object:
acled_spatio_ppp_owin <- chin_acled_quarters_2024_ppp[chin_owin]
K_st <- Kinhom(acled_spatio_ppp_owin, correction="border")

# Plot the result for visual inspection
plot(K_st, main = "Spatio-temporal K-function", legend=TRUE)
```

```{r}
# Perform the CSR test with 99 simulations
K_ck.csr <- envelope(acled_spatio_ppp_owin, Kinhom, nsim=99, correction="border", parallel = parallel::detectCores())

# Plot the envelope with the observed K-function
plot(K_ck.csr, main="Spatio-temporal K-function Envelope", legend=TRUE)
```
:::

##### **1.8.4.2.2 Strategic developments**

```{r}
Example <- "Strategic developments"
chin_acled_quarters_2021_ppp <- as.ppp(chin_acled_sf %>%
  filter(year == 2021 & event_type == Example) %>%
  select(q))
chin_acled_quarters_2022_ppp <- as.ppp(chin_acled_sf %>%
  filter(year == 2022 & event_type == Example) %>%
  select(q))
chin_acled_quarters_2023_ppp <- as.ppp(chin_acled_sf %>%
  filter(year == 2023 & event_type == Example) %>%
  select(q))
chin_acled_quarters_2024_ppp <- as.ppp(chin_acled_sf %>%
  filter(year == 2024 & event_type == Example) %>%
  select(q))
```

::: panel-tabset
## **2021**

```{r}
# Assuming `acled_spatio_ppp_owin` is your spatio-temporal point pattern object:
acled_spatio_ppp_owin <- chin_acled_quarters_2021_ppp[chin_owin]
K_st <- Kinhom(acled_spatio_ppp_owin, correction="border")

# Plot the result for visual inspection
plot(K_st, main = "Spatio-temporal K-function", legend=TRUE)
```

```{r}
# Perform the CSR test with 99 simulations
K_ck.csr <- envelope(acled_spatio_ppp_owin, Kinhom, nsim=99, correction="border", parallel = parallel::detectCores())

# Plot the envelope with the observed K-function
plot(K_ck.csr, main="Spatio-temporal K-function Envelope", legend=TRUE)
```

## **2022**

```{r}
# Assuming `acled_spatio_ppp_owin` is your spatio-temporal point pattern object:
acled_spatio_ppp_owin <- chin_acled_quarters_2022_ppp[chin_owin]
K_st <- Kinhom(acled_spatio_ppp_owin, correction="border")

# Plot the result for visual inspection
plot(K_st, main = "Spatio-temporal K-function", legend=TRUE)
```

```{r}
# Perform the CSR test with 99 simulations
K_ck.csr <- envelope(acled_spatio_ppp_owin, Kinhom, nsim=99, correction="border", parallel = parallel::detectCores())

# Plot the envelope with the observed K-function
plot(K_ck.csr, main="Spatio-temporal K-function Envelope", legend=TRUE)
```

## **2023**

```{r}
# Assuming `acled_spatio_ppp_owin` is your spatio-temporal point pattern object:
acled_spatio_ppp_owin <- chin_acled_quarters_2023_ppp[chin_owin]
K_st <- Kinhom(acled_spatio_ppp_owin, correction="border")

# Plot the result for visual inspection
plot(K_st, main = "Spatio-temporal K-function", legend=TRUE)
```

```{r}
# Perform the CSR test with 99 simulations
K_ck.csr <- envelope(acled_spatio_ppp_owin, Kinhom, nsim=99, correction="border", parallel = parallel::detectCores())

# Plot the envelope with the observed K-function
plot(K_ck.csr, main="Spatio-temporal K-function Envelope", legend=TRUE)
```

## **2024**

```{r}
# Assuming `acled_spatio_ppp_owin` is your spatio-temporal point pattern object:
acled_spatio_ppp_owin <- chin_acled_quarters_2024_ppp[chin_owin]
K_st <- Kinhom(acled_spatio_ppp_owin, correction="border")

# Plot the result for visual inspection
plot(K_st, main = "Spatio-temporal K-function", legend=TRUE)
```

```{r}
# Perform the CSR test with 99 simulations
K_ck.csr <- envelope(acled_spatio_ppp_owin, Kinhom, nsim=99, correction="border", parallel = parallel::detectCores())

# Plot the envelope with the observed K-function
plot(K_ck.csr, main="Spatio-temporal K-function Envelope", legend=TRUE)
```
:::

##### **1.8.4.2.3 Battles**

```{r}
Example <- "Battles"
chin_acled_quarters_2021_ppp <- as.ppp(chin_acled_sf %>%
  filter(year == 2021 & event_type == Example) %>%
  select(q))
chin_acled_quarters_2022_ppp <- as.ppp(chin_acled_sf %>%
  filter(year == 2022 & event_type == Example) %>%
  select(q))
chin_acled_quarters_2023_ppp <- as.ppp(chin_acled_sf %>%
  filter(year == 2023 & event_type == Example) %>%
  select(q))
chin_acled_quarters_2024_ppp <- as.ppp(chin_acled_sf %>%
  filter(year == 2024 & event_type == Example) %>%
  select(q))
```

::: panel-tabset
## **2021**

```{r}
# Assuming `acled_spatio_ppp_owin` is your spatio-temporal point pattern object:
acled_spatio_ppp_owin <- chin_acled_quarters_2021_ppp[chin_owin]
K_st <- Kinhom(acled_spatio_ppp_owin, correction="border")

# Plot the result for visual inspection
plot(K_st, main = "Spatio-temporal K-function", legend=TRUE)
```

```{r}
# Perform the CSR test with 99 simulations
K_ck.csr <- envelope(acled_spatio_ppp_owin, Kinhom, nsim=99, correction="border", parallel = parallel::detectCores())

# Plot the envelope with the observed K-function
plot(K_ck.csr, main="Spatio-temporal K-function Envelope", legend=TRUE)
```

## **2022**

```{r}
# Assuming `acled_spatio_ppp_owin` is your spatio-temporal point pattern object:
acled_spatio_ppp_owin <- chin_acled_quarters_2022_ppp[chin_owin]
K_st <- Kinhom(acled_spatio_ppp_owin, correction="border")

# Plot the result for visual inspection
plot(K_st, main = "Spatio-temporal K-function", legend=TRUE)
```

```{r}
# Perform the CSR test with 99 simulations
K_ck.csr <- envelope(acled_spatio_ppp_owin, Kinhom, nsim=99, correction="border", parallel = parallel::detectCores())

# Plot the envelope with the observed K-function
plot(K_ck.csr, main="Spatio-temporal K-function Envelope", legend=TRUE)
```

## **2023**

```{r}
# Assuming `acled_spatio_ppp_owin` is your spatio-temporal point pattern object:
acled_spatio_ppp_owin <- chin_acled_quarters_2023_ppp[chin_owin]
K_st <- Kinhom(acled_spatio_ppp_owin, correction="border")

# Plot the result for visual inspection
plot(K_st, main = "Spatio-temporal K-function", legend=TRUE)
```

```{r}
# Perform the CSR test with 99 simulations
K_ck.csr <- envelope(acled_spatio_ppp_owin, Kinhom, nsim=99, correction="border", parallel = parallel::detectCores())

# Plot the envelope with the observed K-function
plot(K_ck.csr, main="Spatio-temporal K-function Envelope", legend=TRUE)
```

## **2024**

```{r}
# Assuming `acled_spatio_ppp_owin` is your spatio-temporal point pattern object:
acled_spatio_ppp_owin <- chin_acled_quarters_2024_ppp[chin_owin]
K_st <- Kinhom(acled_spatio_ppp_owin, correction="border")

# Plot the result for visual inspection
plot(K_st, main = "Spatio-temporal K-function", legend=TRUE)
```

```{r}
# Perform the CSR test with 99 simulations
K_ck.csr <- envelope(acled_spatio_ppp_owin, Kinhom, nsim=99, correction="border", parallel = parallel::detectCores())

# Plot the envelope with the observed K-function
plot(K_ck.csr, main="Spatio-temporal K-function Envelope", legend=TRUE)
```
:::

##### **1.8.4.2.4 Violence against civilians**

```{r}
Example <- "Violence against civilians"
acled_quarters_2021_ppp <- as.ppp(temporal_acled_sf %>%
  filter(year == 2021 & event_type == Example) %>%
  select(q))
acled_quarters_2022_ppp <- as.ppp(temporal_acled_sf %>%
  filter(year == 2022 & event_type == Example) %>%
  select(q))
acled_quarters_2023_ppp <- as.ppp(temporal_acled_sf %>%
  filter(year == 2023 & event_type == Example) %>%
  select(q))
acled_quarters_2024_ppp <- as.ppp(temporal_acled_sf %>%
  filter(year == 2024 & event_type == Example) %>%
  select(q))
```

::: panel-tabset
## **2021**

```{r}
# Assuming `acled_spatio_ppp_owin` is your spatio-temporal point pattern object:
acled_spatio_ppp_owin <- chin_acled_quarters_2021_ppp[chin_owin]
K_st <- Kinhom(acled_spatio_ppp_owin, correction="border")

# Plot the result for visual inspection
plot(K_st, main = "Spatio-temporal K-function", legend=TRUE)
```

```{r}
# Perform the CSR test with 99 simulations
K_ck.csr <- envelope(acled_spatio_ppp_owin, Kinhom, nsim=99, correction="border", parallel = parallel::detectCores())

# Plot the envelope with the observed K-function
plot(K_ck.csr, main="Spatio-temporal K-function Envelope", legend=TRUE)
```

## **2022**

```{r}
# Assuming `acled_spatio_ppp_owin` is your spatio-temporal point pattern object:
acled_spatio_ppp_owin <- chin_acled_quarters_2022_ppp[chin_owin]
K_st <- Kinhom(acled_spatio_ppp_owin, correction="border")

# Plot the result for visual inspection
plot(K_st, main = "Spatio-temporal K-function", legend=TRUE)
```

```{r}
# Perform the CSR test with 99 simulations
K_ck.csr <- envelope(acled_spatio_ppp_owin, Kinhom, nsim=99, correction="border", parallel = parallel::detectCores())

# Plot the envelope with the observed K-function
plot(K_ck.csr, main="Spatio-temporal K-function Envelope", legend=TRUE)
```

## **2023**

```{r}
# Assuming `acled_spatio_ppp_owin` is your spatio-temporal point pattern object:
acled_spatio_ppp_owin <- chin_acled_quarters_2023_ppp[chin_owin]
K_st <- Kinhom(acled_spatio_ppp_owin, correction="border")

# Plot the result for visual inspection
plot(K_st, main = "Spatio-temporal K-function", legend=TRUE)
```

```{r}
# Perform the CSR test with 99 simulations
K_ck.csr <- envelope(acled_spatio_ppp_owin, Kinhom, nsim=99, correction="border", parallel = parallel::detectCores())

# Plot the envelope with the observed K-function
plot(K_ck.csr, main="Spatio-temporal K-function Envelope", legend=TRUE)
```

## **2024**

```{r}
# Assuming `acled_spatio_ppp_owin` is your spatio-temporal point pattern object:
acled_spatio_ppp_owin <- chin_acled_quarters_2024_ppp[chin_owin]
K_st <- Kinhom(acled_spatio_ppp_owin, correction="border")

# Plot the result for visual inspection
plot(K_st, main = "Spatio-temporal K-function", legend=TRUE)
```

```{r}
# Perform the CSR test with 99 simulations
K_ck.csr <- envelope(acled_spatio_ppp_owin, Kinhom, nsim=99, correction="border", parallel = parallel::detectCores())

# Plot the envelope with the observed K-function
plot(K_ck.csr, main="Spatio-temporal K-function Envelope", legend=TRUE)
```
:::

#### **1.8.4.3 Sagaing Region**

```{r}
sagaing_acled_sf <- temporal_acled_sf %>% filter(admin1 == "Sagaing")
tm_shape(sagaing_sf)+
  tm_polygons() +
  tm_shape(sagaing_acled_sf) +
  tm_dots(size=0.1) +
  tm_facets(by="quarter", 
            free.coords=FALSE, 
            drop.units = TRUE) + 
  tm_layout(main.title = "Region and Boundaries of Sagaing",
          main.title.position = "center",
          main.title.size = 1,
          legend.outside = TRUE,
          frame = TRUE)

write_rds(sagaing_acled_sf, "data/rds/sagaing_acled_sf.rds")
```

##### **1.8.4.3.1 Explosions/Remote violence**

```{r}
Example <- "Explosions/Remote violence"
sagaing_acled_quarters_2021_ppp <- as.ppp(sagaing_acled_sf %>%
  filter(year == 2021 & event_type == Example) %>%
  select(q))
sagaing_acled_quarters_2022_ppp <- as.ppp(sagaing_acled_sf %>%
  filter(year == 2022 & event_type == Example) %>%
  select(q))
sagaing_acled_quarters_2023_ppp <- as.ppp(sagaing_acled_sf %>%
  filter(year == 2023 & event_type == Example) %>%
  select(q))
sagaing_acled_quarters_2024_ppp <- as.ppp(sagaing_acled_sf %>%
  filter(year == 2024 & event_type == Example) %>%
  select(q))
```

::: panel-tabset
## **2021**

```{r}
# Assuming `acled_spatio_ppp_owin` is your spatio-temporal point pattern object:
acled_spatio_ppp_owin <- sagaing_acled_quarters_2021_ppp[sagaing_owin]
K_st <- Kinhom(acled_spatio_ppp_owin, correction="border")

# Plot the result for visual inspection
plot(K_st, main = "Spatio-temporal K-function", legend=TRUE)
```

```{r}
# Perform the CSR test with 99 simulations
K_ck.csr <- envelope(acled_spatio_ppp_owin, Kinhom, nsim=99, correction="border", parallel = parallel::detectCores())

# Plot the envelope with the observed K-function
plot(K_ck.csr, main="Spatio-temporal K-function Envelope", legend=TRUE)
```

## **2022**

```{r}
# Assuming `acled_spatio_ppp_owin` is your spatio-temporal point pattern object:
acled_spatio_ppp_owin <- sagaing_acled_quarters_2022_ppp[sagaing_owin]
K_st <- Kinhom(acled_spatio_ppp_owin, correction="border")

# Plot the result for visual inspection
plot(K_st, main = "Spatio-temporal K-function", legend=TRUE)
```

```{r}
# Perform the CSR test with 99 simulations
K_ck.csr <- envelope(acled_spatio_ppp_owin, Kinhom, nsim=99, correction="border", parallel = parallel::detectCores())

# Plot the envelope with the observed K-function
plot(K_ck.csr, main="Spatio-temporal K-function Envelope", legend=TRUE)
```

## **2023**

```{r}
# Assuming `acled_spatio_ppp_owin` is your spatio-temporal point pattern object:
acled_spatio_ppp_owin <- sagaing_acled_quarters_2023_ppp[sagaing_owin]
K_st <- Kinhom(acled_spatio_ppp_owin, correction="border")

# Plot the result for visual inspection
plot(K_st, main = "Spatio-temporal K-function", legend=TRUE)
```

```{r}
# Perform the CSR test with 99 simulations
K_ck.csr <- envelope(acled_spatio_ppp_owin, Kinhom, nsim=99, correction="border", parallel = parallel::detectCores())

# Plot the envelope with the observed K-function
plot(K_ck.csr, main="Spatio-temporal K-function Envelope", legend=TRUE)
```

## **2024**

```{r}
# Assuming `acled_spatio_ppp_owin` is your spatio-temporal point pattern object:
acled_spatio_ppp_owin <- sagaing_acled_quarters_2024_ppp[sagaing_owin]
K_st <- Kinhom(acled_spatio_ppp_owin, correction="border")

# Plot the result for visual inspection
plot(K_st, main = "Spatio-temporal K-function", legend=TRUE)
```

```{r}
# Perform the CSR test with 99 simulations
K_ck.csr <- envelope(acled_spatio_ppp_owin, Kinhom, nsim=99, correction="border", parallel = parallel::detectCores())

# Plot the envelope with the observed K-function
plot(K_ck.csr, main="Spatio-temporal K-function Envelope", legend=TRUE)
```
:::

##### **1.8.4.3.2 Strategic developments**

```{r}
Example <- "Strategic developments"
sagaing_acled_quarters_2021_ppp <- as.ppp(sagaing_acled_sf %>%
  filter(year == 2021 & event_type == Example) %>%
  select(q))
sagaing_acled_quarters_2022_ppp <- as.ppp(sagaing_acled_sf %>%
  filter(year == 2022 & event_type == Example) %>%
  select(q))
sagaing_acled_quarters_2023_ppp <- as.ppp(sagaing_acled_sf %>%
  filter(year == 2023 & event_type == Example) %>%
  select(q))
sagaing_acled_quarters_2024_ppp <- as.ppp(sagaing_acled_sf %>%
  filter(year == 2024 & event_type == Example) %>%
  select(q))
```

::: panel-tabset
## **2021**

```{r}
# Assuming `acled_spatio_ppp_owin` is your spatio-temporal point pattern object:
acled_spatio_ppp_owin <- sagaing_acled_quarters_2021_ppp[sagaing_owin]
K_st <- Kinhom(acled_spatio_ppp_owin, correction="border")

# Plot the result for visual inspection
plot(K_st, main = "Spatio-temporal K-function", legend=TRUE)
```

```{r}
# Perform the CSR test with 99 simulations
K_ck.csr <- envelope(acled_spatio_ppp_owin, Kinhom, nsim=99, correction="border", parallel = parallel::detectCores())

# Plot the envelope with the observed K-function
plot(K_ck.csr, main="Spatio-temporal K-function Envelope", legend=TRUE)
```

## **2022**

```{r}
# Assuming `acled_spatio_ppp_owin` is your spatio-temporal point pattern object:
acled_spatio_ppp_owin <- sagaing_acled_quarters_2022_ppp[sagaing_owin]
K_st <- Kinhom(acled_spatio_ppp_owin, correction="border")

# Plot the result for visual inspection
plot(K_st, main = "Spatio-temporal K-function", legend=TRUE)
```

```{r}
# Perform the CSR test with 99 simulations
K_ck.csr <- envelope(acled_spatio_ppp_owin, Kinhom, nsim=99, correction="border", parallel = parallel::detectCores())

# Plot the envelope with the observed K-function
plot(K_ck.csr, main="Spatio-temporal K-function Envelope", legend=TRUE)
```

## **2023**

```{r}
# Assuming `acled_spatio_ppp_owin` is your spatio-temporal point pattern object:
acled_spatio_ppp_owin <- sagaing_acled_quarters_2023_ppp[sagaing_owin]
K_st <- Kinhom(acled_spatio_ppp_owin, correction="border")

# Plot the result for visual inspection
plot(K_st, main = "Spatio-temporal K-function", legend=TRUE)
```

```{r}
# Perform the CSR test with 99 simulations
K_ck.csr <- envelope(acled_spatio_ppp_owin, Kinhom, nsim=99, correction="border", parallel = parallel::detectCores())

# Plot the envelope with the observed K-function
plot(K_ck.csr, main="Spatio-temporal K-function Envelope", legend=TRUE)
```

## **2024**

```{r}
# Assuming `acled_spatio_ppp_owin` is your spatio-temporal point pattern object:
acled_spatio_ppp_owin <- sagaing_acled_quarters_2024_ppp[sagaing_owin]
K_st <- Kinhom(acled_spatio_ppp_owin, correction="border")

# Plot the result for visual inspection
plot(K_st, main = "Spatio-temporal K-function", legend=TRUE)
```

```{r}
# Perform the CSR test with 99 simulations
K_ck.csr <- envelope(acled_spatio_ppp_owin, Kinhom, nsim=99, correction="border", parallel = parallel::detectCores())

# Plot the envelope with the observed K-function
plot(K_ck.csr, main="Spatio-temporal K-function Envelope", legend=TRUE)
```
:::

##### **1.8.4.3.3 Battles**

```{r}
Example <- "Battles"
sagaing_acled_quarters_2021_ppp <- as.ppp(sagaing_acled_sf %>%
  filter(year == 2021 & event_type == Example) %>%
  select(q))
sagaing_acled_quarters_2022_ppp <- as.ppp(sagaing_acled_sf %>%
  filter(year == 2022 & event_type == Example) %>%
  select(q))
sagaing_acled_quarters_2023_ppp <- as.ppp(sagaing_acled_sf %>%
  filter(year == 2023 & event_type == Example) %>%
  select(q))
sagaing_acled_quarters_2024_ppp <- as.ppp(sagaing_acled_sf %>%
  filter(year == 2024 & event_type == Example) %>%
  select(q))
```

::: panel-tabset
## **2021**

```{r}
# Assuming `acled_spatio_ppp_owin` is your spatio-temporal point pattern object:
acled_spatio_ppp_owin <- sagaing_acled_quarters_2021_ppp[sagaing_owin]
K_st <- Kinhom(acled_spatio_ppp_owin, correction="border")

# Plot the result for visual inspection
plot(K_st, main = "Spatio-temporal K-function", legend=TRUE)
```

```{r}
# Perform the CSR test with 99 simulations
K_ck.csr <- envelope(acled_spatio_ppp_owin, Kinhom, nsim=99, correction="border", parallel = parallel::detectCores())

# Plot the envelope with the observed K-function
plot(K_ck.csr, main="Spatio-temporal K-function Envelope", legend=TRUE)
```

## **2022**

```{r}
# Assuming `acled_spatio_ppp_owin` is your spatio-temporal point pattern object:
acled_spatio_ppp_owin <- sagaing_acled_quarters_2022_ppp[sagaing_owin]
K_st <- Kinhom(acled_spatio_ppp_owin, correction="border")

# Plot the result for visual inspection
plot(K_st, main = "Spatio-temporal K-function", legend=TRUE)
```

```{r}
# Perform the CSR test with 99 simulations
K_ck.csr <- envelope(acled_spatio_ppp_owin, Kinhom, nsim=99, correction="border", parallel = parallel::detectCores())

# Plot the envelope with the observed K-function
plot(K_ck.csr, main="Spatio-temporal K-function Envelope", legend=TRUE)
```

## **2023**

```{r}
# Assuming `acled_spatio_ppp_owin` is your spatio-temporal point pattern object:
acled_spatio_ppp_owin <- sagaing_acled_quarters_2023_ppp[sagaing_owin]
K_st <- Kinhom(acled_spatio_ppp_owin, correction="border")

# Plot the result for visual inspection
plot(K_st, main = "Spatio-temporal K-function", legend=TRUE)
```

```{r}
# Perform the CSR test with 99 simulations
K_ck.csr <- envelope(acled_spatio_ppp_owin, Kinhom, nsim=99, correction="border", parallel = parallel::detectCores())

# Plot the envelope with the observed K-function
plot(K_ck.csr, main="Spatio-temporal K-function Envelope", legend=TRUE)
```

## **2024**

```{r}
# Assuming `acled_spatio_ppp_owin` is your spatio-temporal point pattern object:
acled_spatio_ppp_owin <- sagaing_acled_quarters_2024_ppp[sagaing_owin]
K_st <- Kinhom(acled_spatio_ppp_owin, correction="border")

# Plot the result for visual inspection
plot(K_st, main = "Spatio-temporal K-function", legend=TRUE)
```

```{r}
# Perform the CSR test with 99 simulations
K_ck.csr <- envelope(acled_spatio_ppp_owin, Kinhom, nsim=99, correction="border", parallel = parallel::detectCores())

# Plot the envelope with the observed K-function
plot(K_ck.csr, main="Spatio-temporal K-function Envelope", legend=TRUE)
```
:::

##### **1.8.4.3.4 Violence against civilians**

```{r}
Example <- "Violence against civilians"
acled_quarters_2021_ppp <- as.ppp(temporal_acled_sf %>%
  filter(year == 2021 & event_type == Example) %>%
  select(q))
acled_quarters_2022_ppp <- as.ppp(temporal_acled_sf %>%
  filter(year == 2022 & event_type == Example) %>%
  select(q))
acled_quarters_2023_ppp <- as.ppp(temporal_acled_sf %>%
  filter(year == 2023 & event_type == Example) %>%
  select(q))
acled_quarters_2024_ppp <- as.ppp(temporal_acled_sf %>%
  filter(year == 2024 & event_type == Example) %>%
  select(q))
```

::: panel-tabset
## **2021**

```{r}
# Assuming `acled_spatio_ppp_owin` is your spatio-temporal point pattern object:
acled_spatio_ppp_owin <- sagaing_acled_quarters_2021_ppp[sagaing_owin]
K_st <- Kinhom(acled_spatio_ppp_owin, correction="border")

# Plot the result for visual inspection
plot(K_st, main = "Spatio-temporal K-function", legend=TRUE)
```

```{r}
# Perform the CSR test with 99 simulations
K_ck.csr <- envelope(acled_spatio_ppp_owin, Kinhom, nsim=99, correction="border", parallel = parallel::detectCores())

# Plot the envelope with the observed K-function
plot(K_ck.csr, main="Spatio-temporal K-function Envelope", legend=TRUE)
```

## **2022**

```{r}
# Assuming `acled_spatio_ppp_owin` is your spatio-temporal point pattern object:
acled_spatio_ppp_owin <- sagaing_acled_quarters_2022_ppp[sagaing_owin]
K_st <- Kinhom(acled_spatio_ppp_owin, correction="border")

# Plot the result for visual inspection
plot(K_st, main = "Spatio-temporal K-function", legend=TRUE)
```

```{r}
# Perform the CSR test with 99 simulations
K_ck.csr <- envelope(acled_spatio_ppp_owin, Kinhom, nsim=99, correction="border", parallel = parallel::detectCores())

# Plot the envelope with the observed K-function
plot(K_ck.csr, main="Spatio-temporal K-function Envelope", legend=TRUE)
```

## **2023**

```{r}
# Assuming `acled_spatio_ppp_owin` is your spatio-temporal point pattern object:
acled_spatio_ppp_owin <- sagaing_acled_quarters_2023_ppp[sagaing_owin]
K_st <- Kinhom(acled_spatio_ppp_owin, correction="border")

# Plot the result for visual inspection
plot(K_st, main = "Spatio-temporal K-function", legend=TRUE)
```

```{r}
# Perform the CSR test with 99 simulations
K_ck.csr <- envelope(acled_spatio_ppp_owin, Kinhom, nsim=99, correction="border", parallel = parallel::detectCores())

# Plot the envelope with the observed K-function
plot(K_ck.csr, main="Spatio-temporal K-function Envelope", legend=TRUE)
```

## **2024**

```{r}
# Assuming `acled_spatio_ppp_owin` is your spatio-temporal point pattern object:
acled_spatio_ppp_owin <- sagaing_acled_quarters_2024_ppp[sagaing_owin]
K_st <- Kinhom(acled_spatio_ppp_owin, correction="border")

# Plot the result for visual inspection
plot(K_st, main = "Spatio-temporal K-function", legend=TRUE)
```

```{r}
# Perform the CSR test with 99 simulations
K_ck.csr <- envelope(acled_spatio_ppp_owin, Kinhom, nsim=99, correction="border", parallel = parallel::detectCores())

# Plot the envelope with the observed K-function
plot(K_ck.csr, main="Spatio-temporal K-function Envelope", legend=TRUE)
```
:::

#### **1.8.4.4 Mandalay Region**

```{r}
mandalay_acled_sf <- temporal_acled_sf %>% filter(admin1 == "Mandalay")
tm_shape(mandalay_sf)+
  tm_polygons() +
  tm_shape(mandalay_acled_sf) +
  tm_dots(size=0.1) +
  tm_facets(by="quarter", 
            free.coords=FALSE, 
            drop.units = TRUE) + 
  tm_layout(main.title = "Region and Boundaries of Mandalay",
          main.title.position = "center",
          main.title.size = 1,
          legend.outside = TRUE,
          frame = TRUE)

write_rds(mandalay_acled_sf, "data/rds/mandalay_acled_sf.rds")
```

##### **1.8.4.4.1 Explosions/Remote violence**

```{r}
Example <- "Explosions/Remote violence"
mandalay_acled_quarters_2021_ppp <- as.ppp(mandalay_acled_sf %>%
  filter(year == 2021 & event_type == Example) %>%
  select(q))
mandalay_acled_quarters_2022_ppp <- as.ppp(mandalay_acled_sf %>%
  filter(year == 2022 & event_type == Example) %>%
  select(q))
mandalay_acled_quarters_2023_ppp <- as.ppp(mandalay_acled_sf %>%
  filter(year == 2023 & event_type == Example) %>%
  select(q))
mandalay_acled_quarters_2024_ppp <- as.ppp(mandalay_acled_sf %>%
  filter(year == 2024 & event_type == Example) %>%
  select(q))
```

::: panel-tabset
## **2021**

```{r}
# Assuming `acled_spatio_ppp_owin` is your spatio-temporal point pattern object:
acled_spatio_ppp_owin <- mandalay_acled_quarters_2021_ppp[mandalay_owin]
K_st <- Kinhom(acled_spatio_ppp_owin, correction="border")

# Plot the result for visual inspection
plot(K_st, main = "Spatio-temporal K-function", legend=TRUE)
```

```{r}
# Perform the CSR test with 99 simulations
K_ck.csr <- envelope(acled_spatio_ppp_owin, Kinhom, nsim=99, correction="border", parallel = parallel::detectCores())

# Plot the envelope with the observed K-function
plot(K_ck.csr, main="Spatio-temporal K-function Envelope", legend=TRUE)
```

## **2022**

```{r}
# Assuming `acled_spatio_ppp_owin` is your spatio-temporal point pattern object:
acled_spatio_ppp_owin <- mandalay_acled_quarters_2022_ppp[mandalay_owin]
K_st <- Kinhom(acled_spatio_ppp_owin, correction="border")

# Plot the result for visual inspection
plot(K_st, main = "Spatio-temporal K-function", legend=TRUE)
```

```{r}
# Perform the CSR test with 99 simulations
K_ck.csr <- envelope(acled_spatio_ppp_owin, Kinhom, nsim=99, correction="border", parallel = parallel::detectCores())

# Plot the envelope with the observed K-function
plot(K_ck.csr, main="Spatio-temporal K-function Envelope", legend=TRUE)
```

## **2023**

```{r}
# Assuming `acled_spatio_ppp_owin` is your spatio-temporal point pattern object:
acled_spatio_ppp_owin <- mandalay_acled_quarters_2023_ppp[mandalay_owin]
K_st <- Kinhom(acled_spatio_ppp_owin, correction="border")

# Plot the result for visual inspection
plot(K_st, main = "Spatio-temporal K-function", legend=TRUE)
```

```{r}
# Perform the CSR test with 99 simulations
K_ck.csr <- envelope(acled_spatio_ppp_owin, Kinhom, nsim=99, correction="border", parallel = parallel::detectCores())

# Plot the envelope with the observed K-function
plot(K_ck.csr, main="Spatio-temporal K-function Envelope", legend=TRUE)
```

## **2024**

```{r}
# Assuming `acled_spatio_ppp_owin` is your spatio-temporal point pattern object:
acled_spatio_ppp_owin <- mandalay_acled_quarters_2024_ppp[mandalay_owin]
K_st <- Kinhom(acled_spatio_ppp_owin, correction="border")

# Plot the result for visual inspection
plot(K_st, main = "Spatio-temporal K-function", legend=TRUE)
```

```{r}
# Perform the CSR test with 99 simulations
K_ck.csr <- envelope(acled_spatio_ppp_owin, Kinhom, nsim=99, correction="border", parallel = parallel::detectCores())

# Plot the envelope with the observed K-function
plot(K_ck.csr, main="Spatio-temporal K-function Envelope", legend=TRUE)
```
:::

##### **1.8.4.4.2 Strategic developments**

```{r}
Example <- "Strategic developments"
mandalay_acled_quarters_2021_ppp <- as.ppp(mandalay_acled_sf %>%
  filter(year == 2021 & event_type == Example) %>%
  select(q))
mandalay_acled_quarters_2022_ppp <- as.ppp(mandalay_acled_sf %>%
  filter(year == 2022 & event_type == Example) %>%
  select(q))
mandalay_acled_quarters_2023_ppp <- as.ppp(mandalay_acled_sf %>%
  filter(year == 2023 & event_type == Example) %>%
  select(q))
mandalay_acled_quarters_2024_ppp <- as.ppp(mandalay_acled_sf %>%
  filter(year == 2024 & event_type == Example) %>%
  select(q))
```

::: panel-tabset
## **2021**

```{r}
# Assuming `acled_spatio_ppp_owin` is your spatio-temporal point pattern object:
acled_spatio_ppp_owin <- mandalay_acled_quarters_2021_ppp[mandalay_owin]
K_st <- Kinhom(acled_spatio_ppp_owin, correction="border")

# Plot the result for visual inspection
plot(K_st, main = "Spatio-temporal K-function", legend=TRUE)
```

```{r}
# Perform the CSR test with 99 simulations
K_ck.csr <- envelope(acled_spatio_ppp_owin, Kinhom, nsim=99, correction="border", parallel = parallel::detectCores())

# Plot the envelope with the observed K-function
plot(K_ck.csr, main="Spatio-temporal K-function Envelope", legend=TRUE)
```

## **2022**

```{r}
# Assuming `acled_spatio_ppp_owin` is your spatio-temporal point pattern object:
acled_spatio_ppp_owin <- mandalay_acled_quarters_2022_ppp[mandalay_owin]
K_st <- Kinhom(acled_spatio_ppp_owin, correction="border")

# Plot the result for visual inspection
plot(K_st, main = "Spatio-temporal K-function", legend=TRUE)
```

```{r}
# Perform the CSR test with 99 simulations
K_ck.csr <- envelope(acled_spatio_ppp_owin, Kinhom, nsim=99, correction="border", parallel = parallel::detectCores())

# Plot the envelope with the observed K-function
plot(K_ck.csr, main="Spatio-temporal K-function Envelope", legend=TRUE)
```

## **2023**

```{r}
# Assuming `acled_spatio_ppp_owin` is your spatio-temporal point pattern object:
acled_spatio_ppp_owin <- mandalay_acled_quarters_2023_ppp[mandalay_owin]
K_st <- Kinhom(acled_spatio_ppp_owin, correction="border")

# Plot the result for visual inspection
plot(K_st, main = "Spatio-temporal K-function", legend=TRUE)
```

```{r}
# Perform the CSR test with 99 simulations
K_ck.csr <- envelope(acled_spatio_ppp_owin, Kinhom, nsim=99, correction="border", parallel = parallel::detectCores())

# Plot the envelope with the observed K-function
plot(K_ck.csr, main="Spatio-temporal K-function Envelope", legend=TRUE)
```

## **2024**

```{r}
# Assuming `acled_spatio_ppp_owin` is your spatio-temporal point pattern object:
acled_spatio_ppp_owin <- mandalay_acled_quarters_2024_ppp[mandalay_owin]
K_st <- Kinhom(acled_spatio_ppp_owin, correction="border")

# Plot the result for visual inspection
plot(K_st, main = "Spatio-temporal K-function", legend=TRUE)
```

```{r}
# Perform the CSR test with 99 simulations
K_ck.csr <- envelope(acled_spatio_ppp_owin, Kinhom, nsim=99, correction="border", parallel = parallel::detectCores())

# Plot the envelope with the observed K-function
plot(K_ck.csr, main="Spatio-temporal K-function Envelope", legend=TRUE)
```
:::

##### **1.8.4.4.3 Battles**

```{r}
Example <- "Battles"
mandalay_acled_quarters_2021_ppp <- as.ppp(mandalay_acled_sf %>%
  filter(year == 2021 & event_type == Example) %>%
  select(q))
mandalay_acled_quarters_2022_ppp <- as.ppp(mandalay_acled_sf %>%
  filter(year == 2022 & event_type == Example) %>%
  select(q))
mandalay_acled_quarters_2023_ppp <- as.ppp(mandalay_acled_sf %>%
  filter(year == 2023 & event_type == Example) %>%
  select(q))
mandalay_acled_quarters_2024_ppp <- as.ppp(mandalay_acled_sf %>%
  filter(year == 2024 & event_type == Example) %>%
  select(q))
```

::: panel-tabset
## **2021**

```{r}
# Assuming `acled_spatio_ppp_owin` is your spatio-temporal point pattern object:
acled_spatio_ppp_owin <- mandalay_acled_quarters_2021_ppp[mandalay_owin]
K_st <- Kinhom(acled_spatio_ppp_owin, correction="border")

# Plot the result for visual inspection
plot(K_st, main = "Spatio-temporal K-function", legend=TRUE)
```

```{r}
# Perform the CSR test with 99 simulations
K_ck.csr <- envelope(acled_spatio_ppp_owin, Kinhom, nsim=99, correction="border", parallel = parallel::detectCores())

# Plot the envelope with the observed K-function
plot(K_ck.csr, main="Spatio-temporal K-function Envelope", legend=TRUE)
```

## **2022**

```{r}
# Assuming `acled_spatio_ppp_owin` is your spatio-temporal point pattern object:
acled_spatio_ppp_owin <- mandalay_acled_quarters_2022_ppp[mandalay_owin]
K_st <- Kinhom(acled_spatio_ppp_owin, correction="border")

# Plot the result for visual inspection
plot(K_st, main = "Spatio-temporal K-function", legend=TRUE)
```

```{r}
# Perform the CSR test with 99 simulations
K_ck.csr <- envelope(acled_spatio_ppp_owin, Kinhom, nsim=99, correction="border", parallel = parallel::detectCores())

# Plot the envelope with the observed K-function
plot(K_ck.csr, main="Spatio-temporal K-function Envelope", legend=TRUE)
```

## **2023**

```{r}
# Assuming `acled_spatio_ppp_owin` is your spatio-temporal point pattern object:
acled_spatio_ppp_owin <- mandalay_acled_quarters_2023_ppp[mandalay_owin]
K_st <- Kinhom(acled_spatio_ppp_owin, correction="border")

# Plot the result for visual inspection
plot(K_st, main = "Spatio-temporal K-function", legend=TRUE)
```

```{r}
# Perform the CSR test with 99 simulations
K_ck.csr <- envelope(acled_spatio_ppp_owin, Kinhom, nsim=99, correction="border", parallel = parallel::detectCores())

# Plot the envelope with the observed K-function
plot(K_ck.csr, main="Spatio-temporal K-function Envelope", legend=TRUE)
```

## **2024**

```{r}
# Assuming `acled_spatio_ppp_owin` is your spatio-temporal point pattern object:
acled_spatio_ppp_owin <- mandalay_acled_quarters_2024_ppp[mandalay_owin]
K_st <- Kinhom(acled_spatio_ppp_owin, correction="border")

# Plot the result for visual inspection
plot(K_st, main = "Spatio-temporal K-function", legend=TRUE)
```

```{r}
# Perform the CSR test with 99 simulations
K_ck.csr <- envelope(acled_spatio_ppp_owin, Kinhom, nsim=99, correction="border", parallel = parallel::detectCores())

# Plot the envelope with the observed K-function
plot(K_ck.csr, main="Spatio-temporal K-function Envelope", legend=TRUE)
```
:::

##### **1.8.4.4.4 Violence against civilians**

```{r}
Example <- "Violence against civilians"
acled_quarters_2021_ppp <- as.ppp(temporal_acled_sf %>%
  filter(year == 2021 & event_type == Example) %>%
  select(q))
acled_quarters_2022_ppp <- as.ppp(temporal_acled_sf %>%
  filter(year == 2022 & event_type == Example) %>%
  select(q))
acled_quarters_2023_ppp <- as.ppp(temporal_acled_sf %>%
  filter(year == 2023 & event_type == Example) %>%
  select(q))
acled_quarters_2024_ppp <- as.ppp(temporal_acled_sf %>%
  filter(year == 2024 & event_type == Example) %>%
  select(q))
```

::: panel-tabset
## **2021**

```{r}
# Assuming `acled_spatio_ppp_owin` is your spatio-temporal point pattern object:
acled_spatio_ppp_owin <- mandalay_acled_quarters_2021_ppp[mandalay_owin]
K_st <- Kinhom(acled_spatio_ppp_owin, correction="border")

# Plot the result for visual inspection
plot(K_st, main = "Spatio-temporal K-function", legend=TRUE)
```

```{r}
# Perform the CSR test with 99 simulations
K_ck.csr <- envelope(acled_spatio_ppp_owin, Kinhom, nsim=99, correction="border", parallel = parallel::detectCores())

# Plot the envelope with the observed K-function
plot(K_ck.csr, main="Spatio-temporal K-function Envelope", legend=TRUE)
```

## **2022**

```{r}
# Assuming `acled_spatio_ppp_owin` is your spatio-temporal point pattern object:
acled_spatio_ppp_owin <- mandalay_acled_quarters_2022_ppp[mandalay_owin]
K_st <- Kinhom(acled_spatio_ppp_owin, correction="border")

# Plot the result for visual inspection
plot(K_st, main = "Spatio-temporal K-function", legend=TRUE)
```

```{r}
# Perform the CSR test with 99 simulations
K_ck.csr <- envelope(acled_spatio_ppp_owin, Kinhom, nsim=99, correction="border", parallel = parallel::detectCores())

# Plot the envelope with the observed K-function
plot(K_ck.csr, main="Spatio-temporal K-function Envelope", legend=TRUE)
```

## **2023**

```{r}
# Assuming `acled_spatio_ppp_owin` is your spatio-temporal point pattern object:
acled_spatio_ppp_owin <- mandalay_acled_quarters_2023_ppp[mandalay_owin]
K_st <- Kinhom(acled_spatio_ppp_owin, correction="border")

# Plot the result for visual inspection
plot(K_st, main = "Spatio-temporal K-function", legend=TRUE)
```

```{r}
# Perform the CSR test with 99 simulations
K_ck.csr <- envelope(acled_spatio_ppp_owin, Kinhom, nsim=99, correction="border", parallel = parallel::detectCores())

# Plot the envelope with the observed K-function
plot(K_ck.csr, main="Spatio-temporal K-function Envelope", legend=TRUE)
```

## **2024**

```{r}
# Assuming `acled_spatio_ppp_owin` is your spatio-temporal point pattern object:
acled_spatio_ppp_owin <- mandalay_acled_quarters_2024_ppp[mandalay_owin]
K_st <- Kinhom(acled_spatio_ppp_owin, correction="border")

# Plot the result for visual inspection
plot(K_st, main = "Spatio-temporal K-function", legend=TRUE)
```

```{r}
# Perform the CSR test with 99 simulations
K_ck.csr <- envelope(acled_spatio_ppp_owin, Kinhom, nsim=99, correction="border", parallel = parallel::detectCores())

# Plot the envelope with the observed K-function
plot(K_ck.csr, main="Spatio-temporal K-function Envelope", legend=TRUE)
```
:::

#### **1.8.4.4 Magway Region**

```{r}
magway_acled_sf <- temporal_acled_sf %>% filter(admin1 == "Magway")
tm_shape(magway_sf)+
  tm_polygons() +
  tm_shape(magway_acled_sf) +
  tm_dots(size=0.1) +
  tm_facets(by="quarter", 
            free.coords=FALSE, 
            drop.units = TRUE) + 
  tm_layout(main.title = "Region and Boundaries of Magway",
          main.title.position = "center",
          main.title.size = 1,
          legend.outside = TRUE,
          frame = TRUE)

write_rds(magway_acled_sf, "data/rds/magway_acled_sf.rds")
```

##### **1.8.4.2.1 Explosions/Remote violence**

```{r}
Example <- "Explosions/Remote violence"
magway_acled_quarters_2021_ppp <- as.ppp(magway_acled_sf %>%
  filter(year == 2021 & event_type == Example) %>%
  select(q))
magway_acled_quarters_2022_ppp <- as.ppp(magway_acled_sf %>%
  filter(year == 2022 & event_type == Example) %>%
  select(q))
magway_acled_quarters_2023_ppp <- as.ppp(magway_acled_sf %>%
  filter(year == 2023 & event_type == Example) %>%
  select(q))
magway_acled_quarters_2024_ppp <- as.ppp(magway_acled_sf %>%
  filter(year == 2024 & event_type == Example) %>%
  select(q))
```

::: panel-tabset
## **2021**

```{r}
# Assuming `acled_spatio_ppp_owin` is your spatio-temporal point pattern object:
acled_spatio_ppp_owin <- magway_acled_quarters_2021_ppp[magway_owin]
K_st <- Kinhom(acled_spatio_ppp_owin, correction="border")

# Plot the result for visual inspection
plot(K_st, main = "Spatio-temporal K-function", legend=TRUE)
```

```{r}
# Perform the CSR test with 99 simulations
K_ck.csr <- envelope(acled_spatio_ppp_owin, Kinhom, nsim=99, correction="border", parallel = parallel::detectCores())

# Plot the envelope with the observed K-function
plot(K_ck.csr, main="Spatio-temporal K-function Envelope", legend=TRUE)
```

## **2022**

```{r}
# Assuming `acled_spatio_ppp_owin` is your spatio-temporal point pattern object:
acled_spatio_ppp_owin <- magway_acled_quarters_2022_ppp[magway_owin]
K_st <- Kinhom(acled_spatio_ppp_owin, correction="border")

# Plot the result for visual inspection
plot(K_st, main = "Spatio-temporal K-function", legend=TRUE)
```

```{r}
# Perform the CSR test with 99 simulations
K_ck.csr <- envelope(acled_spatio_ppp_owin, Kinhom, nsim=99, correction="border", parallel = parallel::detectCores())

# Plot the envelope with the observed K-function
plot(K_ck.csr, main="Spatio-temporal K-function Envelope", legend=TRUE)
```

## **2023**

```{r}
# Assuming `acled_spatio_ppp_owin` is your spatio-temporal point pattern object:
acled_spatio_ppp_owin <- magway_acled_quarters_2023_ppp[magway_owin]
K_st <- Kinhom(acled_spatio_ppp_owin, correction="border")

# Plot the result for visual inspection
plot(K_st, main = "Spatio-temporal K-function", legend=TRUE)
```

```{r}
# Perform the CSR test with 99 simulations
K_ck.csr <- envelope(acled_spatio_ppp_owin, Kinhom, nsim=99, correction="border", parallel = parallel::detectCores())

# Plot the envelope with the observed K-function
plot(K_ck.csr, main="Spatio-temporal K-function Envelope", legend=TRUE)
```

## **2024**

```{r}
# Assuming `acled_spatio_ppp_owin` is your spatio-temporal point pattern object:
acled_spatio_ppp_owin <- magway_acled_quarters_2024_ppp[magway_owin]
K_st <- Kinhom(acled_spatio_ppp_owin, correction="border")

# Plot the result for visual inspection
plot(K_st, main = "Spatio-temporal K-function", legend=TRUE)
```

```{r}
# Perform the CSR test with 99 simulations
K_ck.csr <- envelope(acled_spatio_ppp_owin, Kinhom, nsim=99, correction="border", parallel = parallel::detectCores())

# Plot the envelope with the observed K-function
plot(K_ck.csr, main="Spatio-temporal K-function Envelope", legend=TRUE)
```
:::

##### **1.8.4.2.2 Strategic developments**

```{r}
Example <- "Strategic developments"
magway_acled_quarters_2021_ppp <- as.ppp(magway_acled_sf %>%
  filter(year == 2021 & event_type == Example) %>%
  select(q))
magway_acled_quarters_2022_ppp <- as.ppp(magway_acled_sf %>%
  filter(year == 2022 & event_type == Example) %>%
  select(q))
magway_acled_quarters_2023_ppp <- as.ppp(magway_acled_sf %>%
  filter(year == 2023 & event_type == Example) %>%
  select(q))
magway_acled_quarters_2024_ppp <- as.ppp(magway_acled_sf %>%
  filter(year == 2024 & event_type == Example) %>%
  select(q))
```

::: panel-tabset
## **2021**

```{r}
# Assuming `acled_spatio_ppp_owin` is your spatio-temporal point pattern object:
acled_spatio_ppp_owin <- magway_acled_quarters_2021_ppp[magway_owin]
K_st <- Kinhom(acled_spatio_ppp_owin, correction="border")

# Plot the result for visual inspection
plot(K_st, main = "Spatio-temporal K-function", legend=TRUE)
```

```{r}
# Perform the CSR test with 99 simulations
K_ck.csr <- envelope(acled_spatio_ppp_owin, Kinhom, nsim=99, correction="border", parallel = parallel::detectCores())

# Plot the envelope with the observed K-function
plot(K_ck.csr, main="Spatio-temporal K-function Envelope", legend=TRUE)
```

## **2022**

```{r}
# Assuming `acled_spatio_ppp_owin` is your spatio-temporal point pattern object:
acled_spatio_ppp_owin <- magway_acled_quarters_2022_ppp[magway_owin]
K_st <- Kinhom(acled_spatio_ppp_owin, correction="border")

# Plot the result for visual inspection
plot(K_st, main = "Spatio-temporal K-function", legend=TRUE)
```

```{r}
# Perform the CSR test with 99 simulations
K_ck.csr <- envelope(acled_spatio_ppp_owin, Kinhom, nsim=99, correction="border", parallel = parallel::detectCores())

# Plot the envelope with the observed K-function
plot(K_ck.csr, main="Spatio-temporal K-function Envelope", legend=TRUE)
```

## **2023**

```{r}
# Assuming `acled_spatio_ppp_owin` is your spatio-temporal point pattern object:
acled_spatio_ppp_owin <- magway_acled_quarters_2023_ppp[magway_owin]
K_st <- Kinhom(acled_spatio_ppp_owin, correction="border")

# Plot the result for visual inspection
plot(K_st, main = "Spatio-temporal K-function", legend=TRUE)
```

```{r}
# Perform the CSR test with 99 simulations
K_ck.csr <- envelope(acled_spatio_ppp_owin, Kinhom, nsim=99, correction="border", parallel = parallel::detectCores())

# Plot the envelope with the observed K-function
plot(K_ck.csr, main="Spatio-temporal K-function Envelope", legend=TRUE)
```

## **2024**

```{r}
# Assuming `acled_spatio_ppp_owin` is your spatio-temporal point pattern object:
acled_spatio_ppp_owin <- magway_acled_quarters_2024_ppp[magway_owin]
K_st <- Kinhom(acled_spatio_ppp_owin, correction="border")

# Plot the result for visual inspection
plot(K_st, main = "Spatio-temporal K-function", legend=TRUE)
```

```{r}
# Perform the CSR test with 99 simulations
K_ck.csr <- envelope(acled_spatio_ppp_owin, Kinhom, nsim=99, correction="border", parallel = parallel::detectCores())

# Plot the envelope with the observed K-function
plot(K_ck.csr, main="Spatio-temporal K-function Envelope", legend=TRUE)
```
:::

##### **1.8.4.2.3 Battles**

```{r}
Example <- "Battles"
magway_acled_quarters_2021_ppp <- as.ppp(magway_acled_sf %>%
  filter(year == 2021 & event_type == Example) %>%
  select(q))
magway_acled_quarters_2022_ppp <- as.ppp(magway_acled_sf %>%
  filter(year == 2022 & event_type == Example) %>%
  select(q))
magway_acled_quarters_2023_ppp <- as.ppp(magway_acled_sf %>%
  filter(year == 2023 & event_type == Example) %>%
  select(q))
magway_acled_quarters_2024_ppp <- as.ppp(magway_acled_sf %>%
  filter(year == 2024 & event_type == Example) %>%
  select(q))
```

::: panel-tabset
## **2021**

```{r}
# Assuming `acled_spatio_ppp_owin` is your spatio-temporal point pattern object:
acled_spatio_ppp_owin <- magway_acled_quarters_2021_ppp[magway_owin]
K_st <- Kinhom(acled_spatio_ppp_owin, correction="border")

# Plot the result for visual inspection
plot(K_st, main = "Spatio-temporal K-function", legend=TRUE)
```

```{r}
# Perform the CSR test with 99 simulations
K_ck.csr <- envelope(acled_spatio_ppp_owin, Kinhom, nsim=99, correction="border", parallel = parallel::detectCores())

# Plot the envelope with the observed K-function
plot(K_ck.csr, main="Spatio-temporal K-function Envelope", legend=TRUE)
```

## **2022**

```{r}
# Assuming `acled_spatio_ppp_owin` is your spatio-temporal point pattern object:
acled_spatio_ppp_owin <- magway_acled_quarters_2022_ppp[magway_owin]
K_st <- Kinhom(acled_spatio_ppp_owin, correction="border")

# Plot the result for visual inspection
plot(K_st, main = "Spatio-temporal K-function", legend=TRUE)
```

```{r}
# Perform the CSR test with 99 simulations
K_ck.csr <- envelope(acled_spatio_ppp_owin, Kinhom, nsim=99, correction="border", parallel = parallel::detectCores())

# Plot the envelope with the observed K-function
plot(K_ck.csr, main="Spatio-temporal K-function Envelope", legend=TRUE)
```

## **2023**

```{r}
# Assuming `acled_spatio_ppp_owin` is your spatio-temporal point pattern object:
acled_spatio_ppp_owin <- magway_acled_quarters_2023_ppp[magway_owin]
K_st <- Kinhom(acled_spatio_ppp_owin, correction="border")

# Plot the result for visual inspection
plot(K_st, main = "Spatio-temporal K-function", legend=TRUE)
```

```{r}
# Perform the CSR test with 99 simulations
K_ck.csr <- envelope(acled_spatio_ppp_owin, Kinhom, nsim=99, correction="border", parallel = parallel::detectCores())

# Plot the envelope with the observed K-function
plot(K_ck.csr, main="Spatio-temporal K-function Envelope", legend=TRUE)
```

## **2024**

```{r}
# Assuming `acled_spatio_ppp_owin` is your spatio-temporal point pattern object:
acled_spatio_ppp_owin <- magway_acled_quarters_2024_ppp[magway_owin]
K_st <- Kinhom(acled_spatio_ppp_owin, correction="border")

# Plot the result for visual inspection
plot(K_st, main = "Spatio-temporal K-function", legend=TRUE)
```

```{r}
# Perform the CSR test with 99 simulations
K_ck.csr <- envelope(acled_spatio_ppp_owin, Kinhom, nsim=99, correction="border", parallel = parallel::detectCores())

# Plot the envelope with the observed K-function
plot(K_ck.csr, main="Spatio-temporal K-function Envelope", legend=TRUE)
```
:::

##### **1.8.4.2.4 Violence against civilians**

```{r}
Example <- "Violence against civilians"
acled_quarters_2021_ppp <- as.ppp(temporal_acled_sf %>%
  filter(year == 2021 & event_type == Example) %>%
  select(q))
acled_quarters_2022_ppp <- as.ppp(temporal_acled_sf %>%
  filter(year == 2022 & event_type == Example) %>%
  select(q))
acled_quarters_2023_ppp <- as.ppp(temporal_acled_sf %>%
  filter(year == 2023 & event_type == Example) %>%
  select(q))
acled_quarters_2024_ppp <- as.ppp(temporal_acled_sf %>%
  filter(year == 2024 & event_type == Example) %>%
  select(q))
```

::: panel-tabset
## **2021**

```{r}
# Assuming `acled_spatio_ppp_owin` is your spatio-temporal point pattern object:
acled_spatio_ppp_owin <- magway_acled_quarters_2021_ppp[magway_owin]
K_st <- Kinhom(acled_spatio_ppp_owin, correction="border")

# Plot the result for visual inspection
plot(K_st, main = "Spatio-temporal K-function", legend=TRUE)
```

```{r}
# Perform the CSR test with 99 simulations
K_ck.csr <- envelope(acled_spatio_ppp_owin, Kinhom, nsim=99, correction="border", parallel = parallel::detectCores())

# Plot the envelope with the observed K-function
plot(K_ck.csr, main="Spatio-temporal K-function Envelope", legend=TRUE)
```

## **2022**

```{r}
# Assuming `acled_spatio_ppp_owin` is your spatio-temporal point pattern object:
acled_spatio_ppp_owin <- magway_acled_quarters_2022_ppp[magway_owin]
K_st <- Kinhom(acled_spatio_ppp_owin, correction="border")

# Plot the result for visual inspection
plot(K_st, main = "Spatio-temporal K-function", legend=TRUE)
```

```{r}
# Perform the CSR test with 99 simulations
K_ck.csr <- envelope(acled_spatio_ppp_owin, Kinhom, nsim=99, correction="border", parallel = parallel::detectCores())

# Plot the envelope with the observed K-function
plot(K_ck.csr, main="Spatio-temporal K-function Envelope", legend=TRUE)
```

## **2023**

```{r}
# Assuming `acled_spatio_ppp_owin` is your spatio-temporal point pattern object:
acled_spatio_ppp_owin <- magway_acled_quarters_2023_ppp[magway_owin]
K_st <- Kinhom(acled_spatio_ppp_owin, correction="border")

# Plot the result for visual inspection
plot(K_st, main = "Spatio-temporal K-function", legend=TRUE)
```

```{r}
# Perform the CSR test with 99 simulations
K_ck.csr <- envelope(acled_spatio_ppp_owin, Kinhom, nsim=99, correction="border", parallel = parallel::detectCores())

# Plot the envelope with the observed K-function
plot(K_ck.csr, main="Spatio-temporal K-function Envelope", legend=TRUE)
```

## **2024**

```{r}
# Assuming `acled_spatio_ppp_owin` is your spatio-temporal point pattern object:
acled_spatio_ppp_owin <- magway_acled_quarters_2024_ppp[magway_owin]
K_st <- Kinhom(acled_spatio_ppp_owin, correction="border")

# Plot the result for visual inspection
plot(K_st, main = "Spatio-temporal K-function", legend=TRUE)
```

```{r}
# Perform the CSR test with 99 simulations
K_ck.csr <- envelope(acled_spatio_ppp_owin, Kinhom, nsim=99, correction="border", parallel = parallel::detectCores())

# Plot the envelope with the observed K-function
plot(K_ck.csr, main="Spatio-temporal K-function Envelope", legend=TRUE)
```
:::

::: {.callout-tip title="Note"}
**Interpretation:**

-   In general, the **observed K-function** (black line) starts within the envelope but begins to deviate upward as the spatial distance increases, crossing beyond the envelope at larger distances.

-   This suggests that possible \*\*spatio-temporal clustering*)* is occurring at larger distances beyond the theoretical expectations under complete randomness.

-   The envelope allows for a statistical comparison: if the observed K-function exceeds the envelope, it implies **significant clustering** at those distances.
:::

This plot suggests that the observed pattern of events is not completely random and that **significant clustering** occurs at larger spatial distances and time intervals, which can reveal important insights about the underlying structure of the event occurrences.

Thus, these clusterings could suggests the following:

1.  **Non-Random Targeting and Temporal Patterns:**

-   The non-random nature of the observed patterns implies that **conflict actors may be targeting specific regions repeatedly** over certain periods, driven by strategic or political goals.
-   This could point to **strategically significant areas** like important roads, military installations, or regions with ethnic minorities being hotspots of repeated violence.

2.  **Localized Hotspots of Conflict:**

-   The clustering pattern at larger distances implies that violent events, such as battles or civilian attacks, are **concentrated in certain regions** rather than being evenly spread across the country.
-   Regions like **Chin, [Sagaing](https://www.irrawaddy.com/opinion/analysis/how-sagaing-is-at-forefront-of-revolution-against-myanmars-junta.html), Magway, and [Mandalay](https://www.bbc.com/news/world-asia-56386348)**, which have been reported as [**key areas of conflict**](https://reliefweb.int/report/myanmar/human-rights-situation-weekly-update-september-1-7-2024-enmy), experience recurring waves of violence concentrated in specific localities, due strategic importance, military operations, or political importance.

## **1.9 Conclusion**

The war in Myanmar has involved numerous armed groups, including pro-democracy forces and ethnic militias, battling against the military junta. The situation remains highly volatile, with frequent battles occurring across various regions, including Chin, Sagaing, Magway, and Mandalay. The conflict exhibits a cyclical nature, with periods of relative calm punctuated by intense fighting, particularly during dry seasons.

Myanmar's political future remains uncertain, with the ongoing struggle between resistance forces and the military junta casting doubt over the country's ability to maintain unity and stability.

**References** - BBC News. (2021). 'Mandalay was a massacre': Security forces fire at protests. Retrieved from https://www.bbc.com/news/world-asia-56386348

-   Thit, N. (2022). How Sagaing Is at Forefront of Revolution Against Myanmar's Junta. Retrieved from https://www.irrawaddy.com/opinion/analysis/how-sagaing-is-at-forefront-of-revolution-against-myanmars-junta.html

-   ND-Burma (2024). Human Rights Violations took place in States and Regions from Aug 22 to 31, 2024. Retrieved from https://reliefweb.int/report/myanmar/human-rights-situation-weekly-update-aug-22-31-2024-enmy

-   ND-Burma (2024). Human Rights Violations took place in States and Regions from Aug 15 to 21, 2024. Retrieved from https://reliefweb.int/report/myanmar/human-rights-situation-weekly-update-aug-15-21-2024-enmy

-   ND-Burma (2024). Human Rights Violations took place in States and Regions from Sep 1 to 7, 2024. Retrieved from https://reliefweb.int/report/myanmar/human-rights-situation-weekly-update-september-1-7-2024-enmy
